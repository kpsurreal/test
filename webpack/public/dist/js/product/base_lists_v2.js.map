{"version":3,"sources":["product/base_lists_v2.js"],"names":["JS_base_lists","prefix","str_page_title","FD","orgInfo","theme","page_title","Vue","el","data","account_list","filter","org_info","accountsInfo","product_list","option_list","changeSeleteId","isdrag","computed","selected_account_arr","_this","arr","group","forEach","e","web_checked","push","id","child_product","child_group","ele","product","selected_top_group_arr","selected_top_base_arr","watch","getAccountList","methods","customRefreshAfterModified","getAllData","flag","clear_cache","getProductList","getOptionList","searchSelected","type","obj","group_id","product_id","undefined","getSearchList","$","ajax","url","success","code","msg","lists","error","startLoading","data_url","clearLoading","web_hide_child","showChildren","omsAlert","numeralNumber","arg","num","str","i","numeral","format"],"mappings":"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","file":"base_lists_v2.js","sourcesContent":["/**\n * author: liuzeyafzy\n * 账户管理页面\n */\n\nfunction JS_base_lists(prefix){\n  let str_page_title = '';\n  if (FD.orgInfo.theme == 3) {\n    str_page_title = '账户管理';\n  }else{\n    str_page_title = '基金列表';\n  }\n  let page_title = new Vue({\n    el: '#page_title',\n    data:{\n      str_page_title: str_page_title\n    }\n  });\n  let account_list = new Vue({\n    el: '#account_list',\n    data: {\n      // selected_account_arr: [],\n      filter: 'running',\n      prefix: prefix,\n      org_info: FD.orgInfo,\n      accountsInfo: {},\n      product_list: [],\n      option_list: [],\n      changeSeleteId: '',\n      isdrag:true,\n    },\n    computed: {\n      selected_account_arr: function(){\n        let _this = this;\n        let arr = [];\n        this.accountsInfo.group && this.accountsInfo.group.forEach(function(e){\n          if (e.web_checked) {\n            arr.push(e.id)\n          }\n          e.child_product.forEach(function(el){\n            if (el.web_checked) {\n              arr.push(el.id);\n            }\n          });\n          e.child_group.forEach(function(el){\n            if (el.web_checked) {\n              arr.push(el.id)\n            }\n            el.child_product.forEach(function(ele){\n              if (ele.web_checked) {\n                arr.push(ele.id);\n              }\n            })\n          })\n        });\n\n        this.accountsInfo.product && this.accountsInfo.product.forEach(function(e){\n          if (e.web_checked) {\n            arr.push(e.id);\n          }\n          e.child_product.forEach(function(el){\n            if (el.web_checked) {\n              arr.push(el.id)\n            }\n          })\n        })\n\n        return arr;\n      },\n      selected_top_group_arr: function(){\n        let _this = this;\n        let arr = [];\n        this.accountsInfo.group && this.accountsInfo.group.forEach(function(e){\n          if (e.web_checked) {\n            arr.push(e.id)\n          }\n        });\n        return arr;\n      },\n      selected_top_base_arr: function(){\n        let _this = this;\n        let arr = [];\n        this.accountsInfo.product && this.accountsInfo.product.forEach(function(e){\n          if (e.web_checked) {\n            arr.push(e.id)\n          }\n        });\n        return arr;\n      },\n    },\n    watch: {\n      changeSeleteId: function () {\n        var _this = this;\n        this.getAccountList(this.changeSeleteId);\n      },\n      filter: function(){\n        this.getAccountList(this.changeSeleteId);\n      }\n    },\n    methods: {\n      customRefreshAfterModified: function(){\n        this.getAllData(true);\n      },\n      getAllData: function(flag){\n        if (true == flag) {\n          this.getAccountList({\n            clear_cache: 1\n          });\n        }else{\n          this.getAccountList();\n        }\n        this.getProductList();\n        this.getOptionList();\n      },\n      searchSelected: function(){\n        let _this = this;\n        let id = '';\n        let type = '';\n        this.product_list.forEach(function(e){\n          if (e.id == _this.changeSeleteId) {\n            id = e.id;\n            type = e.type;\n          }\n        });\n        let obj = {};\n        if (type == 'group') {\n          obj.group_id = id;\n        }else if(type == 'product'){\n          obj.product_id = id;\n        }else{\n          obj = undefined;\n        }\n        this.getAccountList(obj);\n      },\n      getSearchList: function(){\n\n      },\n      getOptionList: function(){\n        var _this = this;\n        $.ajax({\n          url: '/bms-pub/product/get_product_group?only_top=0',\n          type: 'GET',\n          success: function ({code, msg, data}) {\n            if (0 == code) {\n              data.lists && data.lists.forEach(function(e){\n                e.type = 'group';\n              })\n              _this.option_list = data.lists;\n              data.product && data.product.forEach(function (e) {\n                e.type = 'product';\n                _this.option_list.push(e)\n              })\n            }\n          },\n          error: function () {\n\n          }\n        })\n      },\n      getProductList: function () {\n        var _this = this;\n        $.ajax({\n          url: '/bms-pub/product/get_product_group',\n          type: 'GET',\n          success: function ({code, msg, data}) {\n            if (0 == code) {\n              data.lists && data.lists.forEach(function(e){\n                e.type = 'group';\n              })\n              _this.product_list = data.lists;\n              data.product && data.product.forEach(function (e) {\n                e.type = 'product';\n                _this.product_list.push(e)\n              })\n              return _this.product_list;\n            }\n          },\n          error: function () {\n\n          }\n        })\n      },\n      getAccountList: function(obj){\n        let _this = this;\n        if (obj == undefined) {\n          obj = {}\n        }\n        $.startLoading('正在查询');\n\n        let data_url = '';\n        if (3 == this.org_info.theme) {\n          data_url = '/omsv2/product/get_base_product';\n        } else {\n          data_url = '/bms-pub/product/get_group_product';\n        }\n        $.ajax({\n          url: data_url,\n          type: 'get',\n          data: obj,\n          success: function({code, msg, data}){\n            $.clearLoading();\n            // accountsInfo 包含base(底层账户)和group(产品组),产品组还可以包含一级产品组，而底层账户只能包含产品child_product\n            if (0 == code) {\n              // 初始化默认不选中\n              data.product.forEach(function(e){\n                e.web_hide_child = true;\n                e.web_checked = false;\n                e.showChildren = true;\n                // console.log(e.child_product)\n                // e.child_product.forEach(function(el){\n                //   el.web_checked = false;\n                // })\n              });\n              if (3 != _this.org_info.theme) {\n                data.group.forEach(function(e){\n                  e.web_hide_child = true;\n                  e.web_checked = false;\n                  e.child_product.forEach(function(el){\n                    el.web_hide_child = true;\n                    el.web_checked = false;\n                  })\n                  e.child_group && e.child_group.forEach(function(el){\n                    el.web_hide_child = true;\n                    el.web_checked = false;\n                    el.child_product.forEach(function(ele){\n                      ele.web_checked = false;\n                    })\n                  })\n                })\n              }\n              _this.accountsInfo = data;\n            }else{\n              $.omsAlert(msg);\n            }\n          },\n          error: function(){\n            $.clearLoading();\n            $.omsAlert('网络异常，请重试')\n          }\n        })\n      },\n      numeralNumber: function numeralNumber(arg, num) {\n        if (undefined != num) {\n          var str = '0.';\n          for (var i = num - 1; i >= 0; i--) {\n            str += '0';\n          }\n          return numeral(arg).format('0,' + str);\n        }\n        return numeral(arg).format('0,0.00');\n      }\n    }\n  });\n  account_list.getAllData();\n}\n"]}