{"version":3,"sources":["product/position_setting.js"],"names":["JS_position_setting","prefix","selectize","managerArr","initProductHeader","productMenu","Vue","el","data","active","permission","FD","disabled","fee_mode","methods","goto","e","li","$","currentTarget","hasClass","location","href","attr","product_id","positionInfo","focusFlag","stockList","stock_input","stock_name","remark","edit_type","stock_id","volume","price","getStockList","_this","str","window","REQUEST_PREFIX","getJSON","done","res","code","always","removeClass","selectOneStock","id","name","substring","doSubmit","startLoading","ajax","type","url","success","msg","clearLoading","omsAlert","error","failNotice","doCancel"],"mappings":"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","file":"position_setting.js","sourcesContent":["/**\n * author: liuzeyafzy\n * 人员分配页面\n */\nfunction JS_position_setting(prefix){\n  let selectize = {};\n  let managerArr = [];\n\n  initProductHeader(prefix);\n\n  // FD.org_info\n  let productMenu = new Vue({\n    el: '#productMenu',\n    data: {\n      active: 'position_setting',\n      permission: FD.permission,\n      disabled: (FD.fee_mode == 1) ? 'fee_setting' : ''\n    },\n    methods: {\n      goto: function goto(e) {\n        var li = $(e.currentTarget);\n        if (!li.hasClass('active') && !li.hasClass('disabled')) {\n          location.href = prefix + '/product/' + li.attr('data-str') + '?product_id=' + FD.product_id;\n        }\n      }\n    }\n  });\n\n  let positionInfo = new Vue({\n    el: '#positionInfo',\n    data: {\n      focusFlag: false,\n      stockList: [],\n      stock_input: '',\n      stock_name: '',\n      remark: '',\n\n\n      edit_type: '1',\n      stock_id: '',\n      volume: '',\n      price: '',\n      product_id: FD.product_id\n    },\n    methods: {\n      getStockList: function(){\n        let _this = this;\n        var str = (window.REQUEST_PREFIX||'')+'/oms/helper/code_genius?stock_code=' + this.stock_input;\n        $.getJSON(str).done(function(res){\n          if(res.code==0 || res.code==1123124){\n            _this.stockList = res.data;\n            // var html = '';\n            // res.data.forEach(function(e){\n            //   html += '<li data-id=\"' + e.stock_id +'\" data-name=\"'+ e.stock_name +'\">' + e.stock_id + ' &nbsp; ' + e.stock_name + '</li>';\n            // });\n            // $('.custom-stock-suggest').html(html).slideDown(300);\n\n            // // 当只有一个符合条件时，默认选中该项。\n            // if(1 == res.code.length){\n            //   selectOneStock($('.custom-stock-suggest>li'));\n            // }\n          }else{\n            // $.omsAlert('获取建议证券列表失败！',false,300);\n          }\n        }).always(function(){\n          $('.stock-input').removeClass('loading');\n        });\n      },\n      selectOneStock: function(id, name){\n        let _this = this;\n        // this.inputStockCode = id;\n        this.stock_name = name;\n        this.stock_input = id.substring(0, 6);\n        this.stock_id = id;\n        this.stockList = [];\n      },\n      doSubmit: function(){\n        $.startLoading('正在保存...');\n        $.ajax({\n          type: 'post',\n          url: prefix + '/portfolio/edit-position',\n          data: {\n            stock_id: this.stock_id,\n            edit_type: this.edit_type,\n            volume: this.volume,\n            price: this.price,\n            product_id: this.product_id\n          },\n          success: function({code, msg, data}){\n            if (0 == code) {\n              $.clearLoading();\n              $.omsAlert('修改成功');\n            }else{\n              $.clearLoading();\n              $.omsAlert(msg);\n            }\n          },\n          error: function(){\n            $.clearLoading();\n            $.failNotice('网络异常，请重试');\n          }\n        });\n      },\n      doCancel: function(){\n        location.href = prefix + '/product/base_lists';\n      }\n    }\n  })\n\n}\n"]}