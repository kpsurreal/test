{"version":3,"sources":["oms/multi/batchdeal.js"],"names":["vm_multi","user_id","$","pullValue","window","stock_list","list_data","direction","total_cash","total_max_cash","product","last_loading_timestamp","Date","valueOf","position_stocks","market","on","event","new_product","multiViewUpdate","getStockList","deal_method","position_last_updated_timestamp","updated_timestamp","getFollowListStocks","getPositionStocks","omsUpdateLocalJsonData","data","new_data","distributeTradeData","position","updatePositionList","product_max_cash","trigger","type","max_cash","stock","cached_follow_stocks","omsGetLocalJsonData","push","extend","follow","combinePositionStocksInfo","id","market_value","total_amount","enable_sell_volume","position_realtime","forEach","e","stock_id","product_id","all_market_value","risk_position","el","obj","riskCheck","checkRules","trade_direction","trade_mode","volume","price","surged_limit","decline_limit","stock_code","stock_name","total_assets","runtime","enable_cash","security","net_value","Math","max","min","res_data","product_cash","mergeFreshStocksInfo","then","list","filterData","header_data","filter","test","toUpperCase","find","removeClass","cached_stock","ele","index","splice","length","reset","url","REQUEST_PREFIX","getJSON","done","res","concat","map","reverse","omsCacheLocalJsonData","code","failNotice","fail","bind","attr","cached_postion","displayStocksList","render","tableData_maketA_buy","tableData_maketA_sell","tableData_maketH_buy","tableData_maketH_sell","new_list","table_data","Array","excludeFutures","target_stocks","update5","request","get","i","n","deal_price","ask1_price","bid1_price","entrust_method","always","omsAlert","formatNumber","num","cent","isThousand","undefined","toString","replace","isNaN","sign","abs","floor","pow","cents","substring","th","show_type","class_name","class","name","float","option","value","placeholder","arr","filters","v1","Object","key1","key2","commodity_name","transfer_commission","Vue","component","props","template","my_checked_type","checktype","input_val","val","my_showtype","color","myVal","readyonly_placeholder","hidden","watch","$parent","profittype","myVla","earning_ratio_class","showtype","indexOf","methods","input_keyup","stock_num","parseFloat","select_change","evt","$emit","target","checked_change","input_blur","wind_contrl_all","focus_action","$refs","input_text","focus","computed","is_percentage","is_deal","mounted","$root","check_change","line_type","is_loading","error_show","target_position_all","transfer_position_all","transfer_position","current_positon","weight","weight_total_assets","trading_unit","parseInt","radio_type","total_position","modify_val","error_obj","error_info","current_amout","new_price","last_price","delete_stock","post","mouseenter","error_type","mouseleave","checklen","checkArr","checkall","odd_arr","error_arr","my_total_max_cash","my_total_cash","update_entrust_info","check_all","bool","onec_adjustment","len","weight_total","current_entrust_total","target_position_total","transfer_position_total","transfer_commission_total","transfer_total_total","current_entrust","target_position","toFixed","submit_stock_tbody","orders","self","is_trade_day","getCoreData","htmlArr","totalAmount","totalVolume","ins_price","ins_type","typeStr1","ins_model","typeStr2","utils","stock_custom","getMarketType","match","tmpInsVolume","tmpInsAmount","Number","priceStr","common","getData","PRICE_TYPE_LIST","confirmHtml","join","confirm","title","siblings","html","content","closeIcon","confirmButton","cancelButton","isLoading","startLoading","multi","submit_result","clearLoading","wind_contrl_op","wind_contrl","current_total_max_cash","price_type","toLowerCase","msg","freeNum","change_price_target","change_price_position","change_price_total","str_deal_method","row","btnType","entrustStatus","style","temp","limit_action","unshift","contentChild","$nextTick","tableData","JSON","parse","stringify","btn_submit","_this","ignore_tips","tmpObj","assign","prototype","$confirm","entrust_info","entrust_buy_num","entrust_buy_money","entrust_sell_num","entrust_sell_money","entrust","some","status","cancel_status","amount","deal","setTimeout","scroll","set_amount_type","equal_show","target_show","total","equal","displayStockCode","radio_change","addStock","tmpLi","each","split","submit_list","$on","exchange","slice","change","_stock_list","requset","delete_show","tbody","adjustment","change_price_position_value","change_price_target_value","change_price_total_value","change_amount_type","amount_type","change_radio_type"],"mappings":"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","file":"batchdeal.js","sourcesContent":["var vm_multi; //批量交易的vue对象\nvar user_id = $.pullValue(window, 'LOGIN_INFO.user_id', '');\nvar stock_list = [];\nvar list_data = []; //封装好的data\n//判断是买入还是卖出\nvar direction = \"buy\";\nvar total_cash = 0; //空仓下可用金额最大值\nvar total_max_cash = 0; //可用金额最大值\nvar product; //策略信息\n//最后一次加载时间\nvar last_loading_timestamp = new Date().valueOf();\n//证券列表中被选中的证券机构\nvar position_stocks;\n// var entrust_info = window.entrust_info?window.entrust_info:[];//委托信息\nvar market = 'marketA'; //默认a股\n//检测环境是否发生变化，主要是 product_id\n//multi_products:head:updated:checked_one   总列表中单选时触发  传递 产品信息\n$(window).on('multi_products:head:updated:checked_one', function(event) {\n  var new_product = event.product;\n  vm_multi || multiViewUpdate()\n  product = new_product;\n  getStockList();\n}).on('multi_products:head:updated:checked_notone', function() {\n  //check没有选中的时候\n});\n\n// 切换市场时，重新获取自选股数据\n$(window).on('order_create:market:changed', function(event) {\n  market = event.market; //修改股票市场\n  product && getStockList();\n});\n\n// 切换交易方式，重新获取自选股数据\n$(window).on('order_create:deal_method:changed', function(event) {\n  //切换买入 卖出\n  direction = event.deal_method;\n  product && getStockList();\n});\n\nvar position_last_updated_timestamp = 0;\n$(window).on('position_update_updated', function(event){\n  if (position_last_updated_timestamp < event.updated_timestamp) {\n    position_last_updated_timestamp = event.updated_timestamp;\n    product && direction == 'buy' ? getFollowListStocks() : getPositionStocks();\n  }\n});\n\n$(window).on('load', function() {\n  //清空缓存区的自选股列表\n  direction == 'buy' && $.omsUpdateLocalJsonData('stock_follow', user_id);\n}).on('order_create:nav:multi-stocks:buy', function() {\n  product && getStockList();\n}).on('order_create:nav:multi-stocks:sell', function() {\n  product && getStockList();\n}).on('add_multi_hand_order:success',\n  getStockList\n).on('order_create:multi_order:data_change:bull', function(event) {\n  data = event.new_data;\n  distributeTradeData(data);\n}).on('order_create:multi_order:data_change:sell', function(event) {\n  data = event.new_data;\n  distributeTradeData(data);\n}).on('product:position:updated', function(event) {\n  var position = event.position;\n  position && updatePositionList(position);\n}).on('risk_cash_check:success', function(event) {\n  // render();\n  var product_max_cash = $.pullValue(event, 'res_data.product_cash.max_cash', 0);\n  $(window).trigger({\n    type: 'create_order:multi_stocks:' + direction + ':max_cash:changed',\n    max_cash: product_max_cash\n  });\n});\n\ndirection == 'buy' && $(window).on('create_order:multi_stocks:add_stock', function(event) {\n  var stock = event.stock;\n  //新增，更新本地缓存\n  var cached_follow_stocks = $.omsGetLocalJsonData('stock_follow', user_id, false);\n  if (cached_follow_stocks) {\n    cached_follow_stocks.push($.extend(stock, {\n      follow: true\n    }));\n    $.omsUpdateLocalJsonData('stock_follow', user_id, cached_follow_stocks);\n  }\n  combinePositionStocksInfo([stock], $.omsGetLocalJsonData('position_realtime', product.id, []))\n    // 新增股票时，前端风控\n    // var product = PRODUCT;\n    // 计算可用余额\n    // 新增股票的总可用资金\n  var market_value = 0;\n  var total_amount = 0;\n  var enable_sell_volume = 0;\n  window.position_realtime && window.position_realtime.forEach(function(e) {\n    if (e.stock_id === stock.stock_id && e.product_id == product.id) {\n\n      // market_value = e.market_value;\n      // total_amount = e.total_amount;\n      enable_sell_volume = e.enable_sell_volume;\n    }\n  });\n  var all_market_value = 0;\n  window.risk_position[product.id].data.forEach(function(el) {\n    if (el.stock_id == stock.stock_id) {\n      total_amount = el.total_amount;\n      market_value = el.market_value;\n    }\n    all_market_value += el.market_value - 0;\n  });\n  var obj = riskCheck.checkRules({\n    product_id: product.id, // 产品id， id\n    // 交易数据 form_data\n    trade_direction: 1, // 交易方向，1买入 2卖出 trade_direction\n    trade_mode: 1, // 1限价／2市价  trade_mode\n    volume: 0, // 交易数量\n    price: 1, // 限价金额\n    surged_limit: 1, // 涨停价 price已经做了处理了\n    decline_limit: 1, // 跌停价 price已经做了处理了\n    stock_code: stock.stock_id, // 股票code，包含“.SZ”,比较的时候最好都进行小写转换\n    stock_name: stock.stock_name, // 股票名称，用于判断st股票\n    // 产品的数据 product\n    total_assets: product.runtime.total_assets, // 资产总值 runtime.total_assets\n    enable_cash: product.runtime.enable_cash, // 可用资金 runtime.enable_cash\n    security: all_market_value, // 持仓市值 runtime.security 改为 all_market_value\n    net_value: product.runtime.net_value, // 当日净值 runtime.net_value\n    // 持仓数据\n    market_value: market_value, // 本股票持仓市值 //window.position_realtime里面有\n    total_amount: total_amount, // 该股票当前持仓数\n    enable_sell_volume: 0 // 该股票能卖的数量\n  });\n  // 剩余可用资金 ＝ 空仓下的总可用资金 － 股票资产\n  var max_cash = Math.max(obj.max_cash, 0);\n  stock.max_cash = Math.min(max_cash, total_max_cash);\n  // stock.forEach(function(e){\n  //     e.max_cash = max_cash;\n  // });\n  $(window).trigger({\n    type: 'risk_cash_check:success',\n    res_data: {\n      product_cash: {\n        max_cash: max_cash\n      }\n    }\n  });\n  // 新增自定义股票时需要得到新的股票的可用资金等信息\n  mergeFreshStocksInfo([stock]).then(function() {\n    stock_list.push(stock);\n    let list = filterData(stock_list, vm_multi.header_data);\n    if ('marketA' == market) {\n      list = list.filter(function(e) {\n        return /\\.(SZ|SH)$/.test(e.stock_id.toUpperCase());\n      })\n    } else if ('marketHSH' == market) {\n      list = list.filter(function(e) {\n        return /\\.(HKSH)$/.test(e.stock_id.toUpperCase());\n      })\n    } else if ('marketHSZ' == market) {\n      list = list.filter(function(e) {\n        return /\\.(HKSZ)$/.test(e.stock_id.toUpperCase());\n      })\n    }\n    vm_multi.stock_list = list;\n  });\n\n  $('.multi-stocks-section').find('.nothing-nothing').removeClass('nothing');\n}).on('create_order:multi_stocks:delete_stock', function(event) {\n  var stock = event.stock;\n  //删除，更新本地缓存\n  var cached_follow_stocks = $.omsGetLocalJsonData('stock_follow', user_id, false);\n  if (cached_follow_stocks) {\n    cached_follow_stocks = cached_follow_stocks.filter(function(cached_stock) {\n      return cached_stock.stock_id != stock.stock_id;\n    });\n    $.omsUpdateLocalJsonData('stock_follow', user_id, cached_follow_stocks);\n  }\n  let list = vm_multi.stock_list;\n  list.forEach(function(ele, index) {\n    if (ele.stock_id == stock.stock_id) {\n      list.splice(index, 1);\n    }\n  })\n  vm_multi.stock_list = list;\n  getStockList();\n});\n\n//动态更新持仓数据\nfunction updatePositionList(position_stocks) {\n  if (!position_stocks || !position_stocks.length) {\n    return;\n  }\n}\n\n// 批量购买的规则鉴定\nfunction distributeTradeData(data) {\n  product && getStockList();\n}\n\nfunction getStockList() {\n  reset();\n  direction == 'buy' ? getFollowListStocks() : getPositionStocks();\n}\n\nfunction getFollowListStocks() {\n  var url = (window.REQUEST_PREFIX || '') + '/user/stock-follow/get';\n\n  var cached_follow_stocks = $.omsGetLocalJsonData('stock_follow', user_id, false);\n\n  cached_follow_stocks ? (stock_list = cached_follow_stocks, getPositionStocks()) : $.getJSON(url).done(function(res) {\n\n    stock_list = stock_list.concat($.pullValue(res, 'data.list', []).map(function(stock_id) {\n      return {\n        stock_id: stock_id,\n        follow: true\n      };\n    }).reverse());\n    //缓存 stock_follow 的信息\n    $.omsCacheLocalJsonData('stock_follow', user_id, stock_list);\n    res.code == 0 && getPositionStocks();\n    !res.code == 0 && $.failNotice(url, res);\n  }).fail($.failNotice.bind(null, url));\n}\n\nfunction getPositionStocks() {\n  var url = (window.REQUEST_PREFIX || '') + '/oms/api/position_realtime?product_id=' + $.pullValue(product, 'id');\n\n  last_loading_timestamp = new Date().valueOf();\n  $('.multi-stocks-section').attr('last_loading_timestamp', last_loading_timestamp);\n  var cached_postion = $.omsGetLocalJsonData('position_realtime', $.pullValue(product, 'id'), false);\n  cached_postion ? (position_stocks = cached_postion, displayStocksList()) : $.getJSON(url).done(function(res) {\n    if (!product) {\n      return;\n    } //如果已经切换到多策略模式，抛弃\n\n    position_stocks = $.pullValue(res, 'data', []);\n    displayStocksList();\n    !res.code == 0 && $.failNotice(url, res);\n  }).fail($.failNotice.bind(null, url));\n}\n\nfunction render() {\n  // reset();\n  let list = stock_list;\n  if ('marketA' == market) {\n    list = list.filter(function(e) {\n      return /\\.(SZ|SH)$/.test(e.stock_id.toUpperCase());\n    })\n  } else if ('marketHSH' == market) {\n    list = list.filter(function(e) {\n      return /\\.(HKSH)$/.test(e.stock_id.toUpperCase());\n    })\n  } else if ('marketHSZ' == market) {\n    list = list.filter(function(e) {\n      return /\\.(HKSZ)$/.test(e.stock_id.toUpperCase());\n    })\n  }\n  //修改 表格头部\n  if ('marketA' == market) {\n    if (direction == \"buy\") {\n      vm_multi.header_data = tableData_maketA_buy;\n    }\n    if (direction == \"sell\") {\n      vm_multi.header_data = tableData_maketA_sell;\n    }\n\n  } else if ('marketHSH' == market || 'marketHSZ' == market) {\n\n    if (direction == \"buy\") {\n      vm_multi.header_data = tableData_maketH_buy;\n    }\n    if (direction == \"sell\") {\n      vm_multi.header_data = tableData_maketH_sell;\n    }\n  }\n  //创建表格\n  let new_list = filterData(list, vm_multi.header_data);\n  vm_multi.table_data = new Array(...vm_multi.header_data);\n  // vm_multi.table_data = temp;\n  vm_multi.stock_list = new_list;\n  vm_multi.total_cash = product.runtime.total_assets; //总资产\n  vm_multi.product = product;\n  vm_multi.total_max_cash = product.runtime.enable_cash; //剩余最大资金\n  vm_multi.direction = direction;\n}\n\nfunction displayStocksList() {\n  if (!product.runtime) {\n    return;\n  }\n  if (direction == 'buy') {\n    //合并自选股的持仓数据\n    combinePositionStocksInfo(stock_list, position_stocks);\n    // 购买时，显示自定义股票\n    stock_list.length ? mergeFreshStocksInfo(stock_list).then(render) : render();\n    return;\n  }\n  if (direction == 'sell') {\n    stock_list = excludeFutures(position_stocks);\n    // 卖出时，显示自定义股票\n    stock_list.length ? mergeFreshStocksInfo(stock_list).then(render) : render();\n    return;\n  }\n}\n\nfunction combinePositionStocksInfo(target_stocks, position_stocks) {\n  target_stocks.forEach && target_stocks.forEach(function(stock) {\n    position_stocks.forEach && position_stocks.forEach(function(position) {\n      if (stock.stock_id == position.stock_id) {\n        $.extend(stock, position);\n      }\n    });\n  });\n}\n\n//动态更新持仓数据\nfunction excludeFutures(list) {\n  //排除期货，期货 stock_id 是 708090\n  return (list && list.map) ? list.filter(function(stock) {\n    return (stock.stock_id != 708090)\n  }) : [];\n}\n\nfunction reset() {\n  vm_multi.stock_list = [];\n  vm_multi.total_cash = 0; //总资产\n  vm_multi.product = {};\n  vm_multi.total_max_cash = 0; //剩余最大资金\n}\n\n//获取五档行情\nfunction update5(request, index) {\n  var url = (window.REQUEST_PREFIX || '') + \"/oms/helper/stock_detail?stock_id=\" + request;\n  $.get(url).done(function(res) {\n    res.code == 0 && ((list) => {\n      if (!vm_multi.stock_list.length) {\n        return;\n      }\n      for (let i = 0; i < list.length; i++) {\n        for (let n = 0; n < vm_multi.stock_list.length; n++) {\n          if (vm_multi.stock_list[n].stock_id == list[i].stock_id) {\n            if (direction == \"buy\") {\n              vm_multi.stock_list[n].deal_price = list[i].ask1_price || 0;\n            }\n            if (direction == \"sell\") {\n              vm_multi.stock_list[n].deal_price = list[i].bid1_price || 0;\n            }\n            vm_multi.stock_list[n].ask1_price = list[i].ask1_price || 0; //买一价\n            vm_multi.stock_list[n].bid1_price = list[i].bid1_price || 0; //卖一价\n\n            if ('marketA' == market) {\n              vm_multi.stock_list[n].entrust_method = \"1\"; //默认显示市价\n            } else {\n              vm_multi.stock_list[n].entrust_method = \"5\"; //默认显示增强\n            }\n          }\n        }\n      }\n\n    })($.pullValue(res, 'data'));\n    if (1 == res.code) {} else {\n      (res.code != 0 || !res.data || !res.data[0]) && failNotice(res);\n    }\n  }).fail(failNotice).always(function() {\n\n  });\n\n  function failNotice(res) {\n    $.omsAlert($.pullValue(res, 'msg', '请求异常'), false);\n  }\n}\n////////////////////////////////////////////////////////////////////////////////////////////\n//vue重构\n\n/**\n * 将数值四舍五入后格式化.\n * @param num 数值(Number或者String)\n * @param cent 要保留的小数位(Number)\n * @param isThousand 是否需要千分位 0:不需要,1:需要(数值类型);\n * @return 格式的字符串,如'1,234,567.45'\n * @type String\n */\nfunction formatNumber(num, cent, isThousand) {\n  if (num == undefined) {\n    return 0\n  }\n  num = num.toString().replace(/\\$|\\,/g, '');\n\n  // 检查传入数值为数值类型\n  if (isNaN(num))\n    num = \"0\";\n  // 获取符号(正/负数)\n  let sign = (num == (num = Math.abs(num)));\n  num = Math.floor(num * Math.pow(10, cent) + 0.50000000001); // 把指定的小数位先转换成整数.多余的小数位四舍五入\n  cents = num % Math.pow(10, cent); // 求出小数位数值\n  num = Math.floor(num / Math.pow(10, cent)).toString(); // 求出整数位数值\n  let cents = cents.toString(); // 把小数位转换成字符串,以便求小数位长度\n\n  // 补足小数位到指定的位数\n  while (cents.length < cent)\n    cents = \"0\" + cents;\n  if (isThousand) {\n    // 对整数部分进行千分位格式化.\n    for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++)\n      num = num.substring(0, num.length - (4 * i + 3)) + ',' + num.substring(num.length - (4 * i + 3));\n  }\n  if (cent > 0)\n    return (((sign) ? '' : '-') + num + '.' + cents);\n  else\n    return (((sign) ? '' : '-') + num);\n}\n\n// class_name使用的不纯粹，其的值不但控制样式名称，还控制了其它显示内容及逻辑，现在新该用class来承载样式名称。\n// a股买入表格头部\nvar tableData_maketA_buy = [{\n  th: \"error_info\",\n  show_type: \"error_icon\",\n  class_name: \"error_info\",\n  class: '',\n  name: \" \",\n}, {\n  th: \"checkbox\",\n  show_type: \"checkbox\",\n  name: \"\",\n  class_name: \"\"\n}, {\n  th: \"stock_code\", //证劵代码\n  show_type: 'number',\n  name: \"证券代码\",\n  class_name: \"vue_number_default\",\n  class: 'left10 maxWidth70',\n  float: 'left'\n}, {\n  th: \"stock_name\",\n  show_type: \"text\",\n  name: \"证券名称\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"commodity_name\",\n  show_type: \"text\",\n  name: \"交易单元\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"cost_price\",\n  show_type: \"number\",\n  name: \"成本价\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_amount\",\n  show_type: \"number\",\n  name: \"持仓数量\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"market_value\",\n  show_type: \"number\",\n  name: \"市值\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"earning_ratio\",\n  show_type: \"number\",\n  name: \"盈亏率\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"weight\",\n  show_type: \"number\",\n  name: \"当前仓位(个股)\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"current_entrust\",\n  show_type: \"number\",\n  name: \"当前挂单\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"entrust_method\",\n  show_type: \"select\",\n  name: \"报价方式\",\n  option: [{\n    value: \"1\",\n    name: \"限价\"\n  }, {\n    value: \"2\",\n    name: \"市价\",\n  }],\n  class_name: \"vue_input_select\",\n  class: 'right10',\n  float: 'right',\n  value: 1\n}, {\n  th: \"deal_price\",\n  show_type: \"input\",\n  name: \"买入价格\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"transfer_position\",\n  show_type: \"input_buy_percentage\",\n  name: \"总资产比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_commission\",\n  show_type: \"input_buy_deal\",\n  name: \"本次委买\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入数量'\n}];\n\n// a股卖出表格头部\nvar tableData_maketA_sell = [{\n  th: \"error_info\",\n  show_type: \"error_icon\",\n  class_name: \"error_info\",\n  class: '',\n  name: \" \",\n}, {\n  th: \"checkbox\",\n  show_type: \"checkbox\",\n  name: \"\",\n  class_name: \"\"\n}, {\n  th: \"stock_code\", //证劵代码\n  show_type: 'number',\n  name: \"证券代码\",\n  class_name: \"vue_number_default\",\n  class: 'left10 maxWidth70',\n  float: 'left'\n}, {\n  th: \"stock_name\",\n  show_type: \"text\",\n  name: \"证券名称\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"commodity_name\",\n  show_type: \"text\",\n  name: \"交易单元\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"cost_price\",\n  show_type: \"number\",\n  name: \"成本价\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_amount\",\n  show_type: \"number\",\n  name: \"持仓数量\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"market_value\",\n  show_type: \"number\",\n  name: \"市值\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"earning_ratio\",\n  show_type: \"number\",\n  name: \"盈亏率\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"weight\",\n  show_type: \"number\",\n  name: \"当前仓位(个股)\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"current_entrust\",\n  show_type: \"number\",\n  name: \"当前挂单\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"entrust_method\",\n  show_type: \"select\",\n  name: \"报价方式\",\n  option: [{\n    value: \"1\",\n    name: \"限价\"\n  }, {\n    value: \"2\",\n    name: \"市价\",\n  }],\n  class_name: \"vue_input_select\",\n  class: 'right10',\n  float: 'right',\n  value: 1\n}, {\n  th: \"deal_price\",\n  show_type: \"input\",\n  name: \"卖出价格\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_position\",\n  show_type: \"input_percentage\",\n  name: \"总资产比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_position\",\n  show_type: \"input_sell_percentage\",\n  name: \"持仓比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_commission\",\n  show_type: \"input_sell_deal\",\n  name: \"本次委卖\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入数量'\n}, ];\n\n// 港股买入表格头部\nvar tableData_maketH_buy = [{\n  th: \"error_info\",\n  show_type: \"error_icon\",\n  class_name: \"error_info\",\n  class: '',\n  name: \" \",\n}, {\n  th: \"checkbox\",\n  show_type: \"checkbox\",\n  name: \"\",\n  class_name: \"\"\n}, {\n  th: \"stock_code\", //证劵代码\n  show_type: 'number',\n  name: \"证券代码\",\n  class_name: \"vue_number_default\",\n  class: 'left10 maxWidth70',\n  float: 'left'\n}, {\n  th: \"stock_name\",\n  show_type: \"text\",\n  name: \"证券名称\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"commodity_name\",\n  show_type: \"text\",\n  name: \"交易单元\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"cost_price\",\n  show_type: \"number\",\n  name: \"成本价\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_amount\",\n  show_type: \"number\",\n  name: \"持仓数量\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"market_value\",\n  show_type: \"number\",\n  name: \"市值\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"earning_ratio\",\n  show_type: \"number\",\n  name: \"盈亏率\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"weight\",\n  show_type: \"number\",\n  name: \"当前仓位(个股)\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"current_entrust\",\n  show_type: \"number\",\n  name: \"当前挂单\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"entrust_method\",\n  show_type: \"select\",\n  name: \"报价方式\",\n  option: [{\n    value: \"5\",\n    name: \"增强限价买入\",\n  }, {\n    value: \"4\",\n    name: \"竞价限价买入\"\n  }],\n  class_name: \"vue_input_select\",\n  class: 'right10',\n  float: 'right',\n  value: 5\n}, {\n  th: \"deal_price\",\n  show_type: \"input\",\n  name: \"买入价格\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"transfer_position\",\n  show_type: \"input_buy_percentage\",\n  name: \"总资产比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_commission\",\n  show_type: \"input_buy_deal\",\n  name: \"本次委买\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入数量'\n}];\n\n// 港股卖出表格头部\nvar tableData_maketH_sell = [{\n  th: \"error_info\",\n  show_type: \"error_icon\",\n  class_name: \"error_info\",\n  class: '',\n  name: \" \",\n}, {\n  th: \"checkbox\",\n  show_type: \"checkbox\",\n  name: \"\",\n  class_name: \"\"\n}, {\n  th: \"stock_code\", //证劵代码\n  show_type: 'number',\n  name: \"证券代码\",\n  class_name: \"vue_number_default\",\n  class: 'left10 maxWidth70',\n  float: 'right'\n}, {\n  th: \"stock_name\",\n  show_type: \"text\",\n  name: \"证券名称\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"commodity_name\",\n  show_type: \"text\",\n  name: \"交易单元\",\n  class_name: \"vue_text_default\",\n  class: 'left10',\n  float: 'left'\n}, {\n  th: \"cost_price\",\n  show_type: \"number\",\n  name: \"成本价\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_amount\",\n  show_type: \"number\",\n  name: \"持仓数量\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"market_value\",\n  show_type: \"number\",\n  name: \"市值\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"earning_ratio\",\n  show_type: \"number\",\n  name: \"盈亏率\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"weight\",\n  show_type: \"number\",\n  name: \"当前仓位(个股)\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"current_entrust\",\n  show_type: \"number\",\n  name: \"当前挂单\",\n  class_name: \"vue_number_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"entrust_method\",\n  show_type: \"select\",\n  name: \"报价方式\",\n  option: [{\n    value: \"5\",\n    name: \"增强限价卖出\",\n  }, {\n    value: \"4\",\n    name: \"竞价限价卖出\"\n  }],\n  class_name: \"vue_input_select\",\n  class: 'right10',\n  float: 'right',\n  value: 5\n}, {\n  th: \"deal_price\",\n  show_type: \"input\",\n  name: \"卖出价格\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right'\n}, {\n  th: \"total_position\",\n  show_type: \"input_percentage\",\n  name: \"总资产比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_position\",\n  show_type: \"input_buy_percentage\",\n  name: \"持仓比例\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入比例'\n}, {\n  th: \"transfer_commission\",\n  show_type: \"input_sell_deal\",\n  name: \"本次委卖\",\n  class_name: \"vue_input_default\",\n  class: 'right10',\n  float: 'right',\n  placeholder: '请输入委卖数量'\n}];\n\n// 筛选数组\n// 分析评价by: liuzeyafzy@gmail.com\n// 这个函数看起来十分的复杂，因为变量的命名非常的杂乱无章。而且实际上做的并不是筛选的功能\n// 问题1: 第二个入参filters根本就没起作用\n// 问题2: forEach里面实现的只是将第二层的数据拿到第一层来。压根没有考虑第二层变量同名的情况。\n// 问题3: 这个函数的意义何在？\n// 问题4: 在这样一个类似于工具的函数内，穿插了业务的变量与逻辑。commodity_name这种东西意义何在？\n// 问题5: 在这样一个类似于工具的函数内，使用了全局变量product.name。\nfunction filterData(arr, filters) {\n  let data = [];\n  arr.forEach(function(v1) {\n    if (v1 instanceof Object) {\n      for (let key1 in v1) {\n        if (v1[key1] instanceof Object) {\n          for (let key2 in v1[key1]) {\n            v1[key2] = v1[key1][key2]\n          }\n          delete v1[key1];\n        }\n      }\n      v1.commodity_name = product.name;\n      // v1.target_position = v1.weight ? (v1.weight * 100).toFixed(2) : (0.00).toFixed(2);\n      // v1.transfer_position = (0.00).toFixed(2);\n      v1.transfer_commission = '';\n    }\n  })\n  return arr;\n}\n\n// vue单元格组件\n// 分析评价by：liuzeyafzy@gmail.com\n// 问题1: props传了placeholder，这是来自于tableData_maketA_buy这样的表头数据中的，但是例如float却又是在下面的函数中从this.header_data中获取的。同类数据走不同的路径，逻辑混乱。\n// 问题2: props传输的变量数太多了。例如placeholder，直接从header_data获取就可以了。数据冗余，逻辑不清。\n// 问题3: props变量名缺少注释，不是作者本人难以迅速理解父子组件关联\n// 问题4: 一个抽象组件内，不应该去根据name是不是“earning_ratio”来走不同的分支\n// 问题5: 这里用到了表格头数据show_type，有个可能的值是“input_buy_percentage”。组件里面的代码判断字符串是否含有buy来判断买入卖出方向。而此组件中又有地方获取买入卖出方向的方式是找$root的direction的值。同时使用两种方式会使得别人更加难以理解，只用某一种方式才对。\n// 问题6: 接问题5，show_type的数据，被几个维度使用，一个是判断输入框的形式（input、下拉框等），一个是买入卖出方式，一个是百分比什么的。不应该将多个逻辑混合到一个变量中来判断。\n// 问题7: 通过this.$parent.profittype来修改父组件的profittype值是不应该的。因为这样使用就隐含要求父组件包含profittype的data数据（computed、props都不行），而这是没有道理的。事件上报的好处就在这里。\n// 问题8: template中的v-if嵌套导致可读性比较差。我要花10分钟才能总结出来这段代码的显示逻辑：my_showtype为‘error_icon’或者“nubmer”，走自己的显示流程，而如果是“input”“select”“readyonly”，又当没选中或者该隐藏时，显示“--”，否则按各自的样式显示。减少层级嵌套能够有助于理解逻辑。请参考这种if逻辑：判断“error_icon”、判断“nubmer”、判断“input且checktype且非hidden”、判断“select且checktype且非hidden”、判断“readonly且checktype且非hidden”、其它情况。这种只有一层的判断会不会更清晰些？\n// 问题9: 这个组件内不应该使用闭包了。写了影响可读性。\n// 问题10: 针对传进来的val值，formatNumber处理的逻辑 应该在表头就考虑好了再传进来。\nVue.component('vue-cell-default', {\n  props: [\"val\", \"showtype\", \"checktype\", \"name\", \"index\", \"class_name\", \"header_data\", \"earning_ratio_class\", \"placeholder\"],\n  template: `\n    <div :class=\"header_data.class\" class=\"batchdeal-cell\">\n      <div :class=\"class_name\" v-if=\"my_showtype=='text'\">\n        <span :style=\"{color:color}\">{{myVal}}</span>\n      </div>\n      <div :class=\"class_name\" v-if=\"my_showtype=='checkbox'\">\n        <input type=\"checkbox\" @change=checked_change v-model=\"my_checked_type\" name=\"\" value=\"\" >\n      </div>\n\n      <div class=\"vue_input_default\" v-if=\"my_showtype=='input' && checktype && !hidden\">\n        <span v-show=\"deal_method\">{{deal_method}}</span>\n        <input step=\"any\" @keyup=\"input_keyup\" v-model=\"input_val\" ref=\"input_text\" type=\"number\" @blur=\"input_blur\" :placeholder=placeholder>\n        <span v-show=\"is_percentage\">%</span>\n        <span v-show=\"is_deal\"></span>\n      </div>\n      <div class=\"vue_input_default\" v-if=\"my_showtype=='select' && checktype && !hidden\">\n        <select @change=\"select_change\" :value=\"val\">\n          <option :value=\"item.value\" v-for=\"(item,index) in header_data.option\">{{item.name}}</option>\n        </select>\n      </div>\n      <div :class=\"class_name\" v-if=\"my_showtype=='readyonly' && checktype && !hidden\">\n        <input :value=\"readyonly_placeholder\" type=\"text\" readyonly=\"readonly\" disabled=\"disabled\" style=\"color:gray;\">\n      </div>\n      <div v-if=\"(my_showtype=='input' || my_showtype=='select' || my_showtype=='readyonly') && (!checktype || hidden)\">\n        <span>- -</span>\n      </div>\n      <div :class=\"class_name\" v-if=\"my_showtype=='error_icon'\">\n        <span></span>\n      </div>\n      <div :class=\"class_name\" v-if=\"my_showtype=='nubmer'\" step=\"0.01\">\n        <span>{{myVal}}</span>\n      </div>\n    </div>\n  `,\n  data: function() {\n    return {\n      // deal_method: false,\n      // is_percentage: false,\n      my_checked_type: this.checktype,\n      input_val: this.val,\n      my_showtype: '',\n      float: '',\n      color: 'black',\n      myVal: '',\n      // is_deal: false,\n      readyonly_placeholder: \"市价\",\n      hidden: false\n    }\n  },\n  watch: {\n    hidden(){\n      this.input_val = ''\n    },\n    checktype() {\n      this.my_checked_type = this.checktype\n    },\n    val(val) {\n      // val = val || 0.0;\n      if (this.val == '' || this.val == undefined) {\n        this.myVal = '- -';\n      } else {\n        this.myVal = this.val\n      }\n\n      if (this.name == \"earning_ratio\") {\n        if (val == \"- -\") {\n          this.$parent.profittype = \"black\";\n        } else if (val > 0) {\n          this.$parent.profittype = \"red\";\n        } else if (val < 0) {\n          this.$parent.profittype = \"green\";\n        }\n      }\n\n      if (this.name == \"cost_price\") {\n        if (this.val) {\n          this.myVla = formatNumber(this.val, 3, 1)\n        } else {\n          this.myVla = \"- -\";\n        }\n      }\n\n      if (this.name == \"total_amount\") {\n        if (this.val) {\n          return formatNumber(this.val, 0, 1)\n        } else {\n          this.myVal = \"- -\";\n        }\n      }\n\n      if (this.name == \"market_value\") {\n        if (this.val) {\n          this.myVal = formatNumber(this.val, 2, 1)\n        } else {\n          this.myVal = \"- -\";\n        }\n      }\n\n      if (this.name == \"earning_ratio\") {\n        if (this.val) {\n          this.myVal = formatNumber(this.val * 100, 2, 0) + \"%\"\n        } else {\n          this.myVal = \"- -\";\n        }\n      }\n\n      if (this.name == \"weight\") {\n        if (this.val) {\n          this.myVal = formatNumber(this.val * 100, 2, 0) + \"%\"\n        } else {\n          this.myVal = \"- -\";\n        }\n      }\n\n      if (this.name == \"current_entrust\") {\n        if (this.val) {\n          this.myVal = formatNumber(this.val, 0, 1)\n        } else {\n          this.myVal = \"- -\";\n        }\n      }\n\n      if (this.name == \"target_position\" || this.name == \"transfer_commission\" || this.name == \"transfer_position\" || this.name == \"total_position\") {\n        this.input_val = val;\n      }\n\n      if (this.name == \"deal_price\") {\n        this.input_val = val;\n      }\n    },\n    earning_ratio_class() {\n      if (this.name == \"market_value\") {\n        this.color = this.earning_ratio_class;\n      }\n\n      if (this.name == \"earning_ratio\") {\n        this.color = this.earning_ratio_class;\n      }\n    },\n    showtype(val) {\n      if (this.showtype.indexOf('text') > -1) {\n        this.my_showtype = \"text\";\n      }\n\n      if (this.showtype.indexOf('input') > -1) {\n        this.my_showtype = \"input\";\n      }\n\n      if (this.showtype.indexOf('checkbox') > -1) {\n        this.my_showtype = \"checkbox\";\n      }\n\n      if (this.showtype.indexOf('select') > -1) {\n        this.my_showtype = \"select\";\n      }\n\n      if (this.showtype.indexOf('error_icon') > -1) {\n        this.my_showtype = 'error_icon';\n      }\n\n      this.my_showtype = \"text\"\n    }\n  },\n  methods: {\n    input_keyup() {\n      var stock_num = this.input_val;\n      if (stock_num.indexOf('.') < 0 && '' != stock_num) {//以上已经过滤，此处控制的是如果没有小数点，首位不能为类似于 01、02的金额\n        this.input_val = parseFloat(stock_num);\n      }\n    },\n    select_change(evt) {\n      this.$emit('select_change', this.index, evt.target.value);\n    },\n    checked_change() {\n      this.$emit('check_change', this.my_checked_type)\n    },\n    input_blur() {\n      let input_val = this.input_val ? this.input_val : 0;\n\n      //重新计算目标值 本次调仓值  委托数量\n      this.$emit('modify_val', this.name, this.input_val)\n      this.$emit('input_blur', this.name, this.input_val)\n\n      //目标持仓\n      if (this.name != \"change_price_target\" && this.name != \"change_price_position\" && this.name != \"change_price_total\") {\n        this.$parent.$parent.wind_contrl_all();\n      }\n    },\n    focus_action() {\n      this.$refs.input_text.focus();\n    }\n  },\n  computed: {\n    is_percentage() {\n      if (this.showtype.indexOf('percentage') > -1) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n    deal_method() {\n      // if (this.showtype.indexOf('buy') > -1) {\n      //   //return '+'\n      // } else if (this.showtype.indexOf('sell') > -1) {\n      //   //return '-'\n      //   return false\n      // } else {\n      //   return false\n      // }\n    },\n    is_deal() {\n      if (this.showtype.indexOf('deal') > -1) {\n        return true;\n      } else {\n        return false;\n      }\n    },\n\n  },\n  mounted() {\n    //当卖出时  默认隐藏持仓比例列\n    if (this.$root.direction == \"sell\") {\n      if (this.name == \"transfer_position\") {\n        this.hidden = true;\n      }\n    }\n\n    this.my_showtype = (() => {\n      if (this.showtype.indexOf('text') > -1) {\n        return \"text\";\n      }\n\n      if (this.showtype.indexOf('input') > -1) {\n        return \"input\";\n      }\n\n      if (this.showtype.indexOf('checkbox') > -1) {\n        return \"checkbox\";\n      }\n\n      if (this.showtype.indexOf('select') > -1) {\n        return \"select\";\n      }\n      if (this.showtype.indexOf('error_icon') > -1) {\n        return 'error_icon';\n      }\n      return \"text\"\n    })();\n\n    if (this.header_data) {\n      this.float = this.header_data.float;\n    } else {\n      this.float = ''\n    }\n\n    if (this.val == '' || this.val == undefined) {\n      this.myVal = '- -';\n    } else {\n      this.myVal = this.val\n    }\n\n    if (this.name == \"earning_ratio\" && this.val > 0) {\n      this.$parent.earning_ratio_class = \"red\";\n    }\n\n    if (this.name == \"earning_ratio\" && this.val < 0) {\n      this.$parent.earning_ratio_class = \"green\";\n    }\n\n    if (this.name == \"cost_price\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val, 3, 1)\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n\n    if (this.name == \"total_amount\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val, 0, 1)\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n\n    if (this.name == \"market_value\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val, 2, 1)\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n\n    if (this.name == \"earning_ratio\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val * 100, 2, 0) + \"%\"\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n\n    if (this.name == \"weight\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val * 100, 2, 0) + \"%\"\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n\n    if (this.name == \"current_entrust\") {\n      if (this.val) {\n        this.myVal = formatNumber(this.val, 0, 1)\n      } else {\n        this.myVal = \"- -\";\n      }\n    }\n  }\n});\n\n// Vue表头组件\nVue.component('vue-row-header', {\n  props: [\"header_data\", \"list_data\", \"checkall\"],\n  template: `\n    <thead>\n      <tr class=\"top_tr\" style=\"padding-right: 10px;\">\n        <template v-for=\"(item,index) in header_data\">\n          <th v-if=\"index==0\">\n            <div class=\"error_info\"><span style=\"display:none;\"></span></div>\n          </th>\n          <th v-if=\"index==1\">\n            <vue-cell-default  @check_change=\"check_change\" val=item.name showtype=\"checkbox\"  :header_data=item :checktype=\"checkall\"></vue-cell-default>\n          </th>\n          <th v-if=\"index>1\" :style=\"index==0 || index==1?'':'flex:1;'\">\n            <vue-cell-default  :val=item.name showtype=\"text\"  :class_name=\"item.class\" :header_data=item ></vue-cell-default>\n          </th>\n        </template>\n        <th style=\"width:22px;\"></th>\n      </tr>\n    </thead>\n  `,\n  data: function() {\n    return {\n\n    }\n  },\n  methods: {\n    check_change(val) {\n      this.$emit('check_all', val);\n    }\n  }\n});\n\n// Vue表格行组件\n// 分析评价by：liuzeyafzy@gmail.com\n// 问题1: error_info在这个行组件中做了处理，又在vue-cell-default这个子组件中处理，应该考虑在一个层面上处理\n// 问题2: props传入了批量修改仓位什么的数值，这里会产生一个之前已经预见到的问题。产品已经明确指出只在修改了批量那里的值之后才修改选中行的数量。现在这种处理方式会导致：用户先改批量的值，再勾选某行，这行就会按批量的值展示数量。还有个问题，target_position_all这些变量在调试时发现一直都是undefined，是不是可以删除了？\n// 问题3: earning_ratio_class传来传去，应该想好在哪里处理。\n// 问题4: watch的radio_type使用了$refs来操作dom，不应该这样用。\n// 问题5: 与问题2相关，这里原来没有使用问题2的处理方式，watch的checktype方法没有取明明传进来的批量数据，而是直接从root中获取change_price_position_value，不便于跟踪数据变化\nVue.component('vue-row-tr', {\n  props: [\"header_data\", \"stock\", \"transfer_position_all\", \"target_position_all\", \"checktype\", \"index\", \"delete_show\", \"odd_price\", \"error_obj\", \"radio_type\"],\n  template: `\n    <tr :class=\"{error:error_obj.type,line:line_type}\" @mouseenter=\"mouseenter\" @mouseleave=\"mouseleave\">\n      <template v-for=\"(item,index) in header_data\">\n        <td v-if=\"index==0\">\n          <div class=\"error_info\"><span v-show=error_obj.type></span></div>\n        </td>\n        <td v-else :style=\"index==1?'':'flex:1;'\" style=\"max-width:\">\n          <vue-cell-default :placeholder=header_data[index].placeholder @modify_val=modify_val @check_change=check_change @select_change=select_change  :name=item.th :val=\"stock[item.th]\" :earning_ratio_class=\"earning_ratio_class\" :showtype=item.show_type :class_name=item.class_name :header_data=item :checktype=\"checktype\" :index=index :ref=\"item.th\"></vue-cell-default>\n        </td>\n      </template>\n      <td>\n        <vue-error-ele :delete_show=\"delete_show\" @delete_stock=delete_stock :isshow=\"error_show\" :error_info=\"error_obj.error_info\"></vue-error-ele>\n      </td>\n    </tr>\n  `,\n  data: function() {\n    return {\n      profittype: '',\n      line_type: false,\n      earning_ratio_class: \"black\",\n      is_loading: false,\n      error_show: false\n    }\n  },\n  watch: {\n    // 监听批量的变化\n    target_position_all(val) {\n      if (this.checktype) {\n        this.stock[\"target_position\"] = this.val;\n      }\n    },\n    // 监听批量的变化\n    transfer_position_all() {\n      if (this.checktype) {\n        this.stock[\"transfer_position\"] = this.val;\n      }\n    },\n    // 监听股票变化\n    stock(ele) {\n      if (this.$root.direction == \"buy\") {\n        this.stock.deal_price = ele.ask1_price;\n      } else {\n        this.stock.deal_price = ele.bid1_price;\n      }\n    },\n    // 监听勾选、取消勾选\n    checktype(val) {\n      //勾选时 重新计算价格\n      if (val) {\n        var stock_num;\n        if (this.$root.direction == \"buy\") {\n          // let transfer_position = this.$root.change_price_position_value / 100;\n          let transfer_position = 0;\n          let stock = this.stock;\n          // let current_positon = stock.weight ? stock.weight : 0;\n          let current_positon = stock.weight ? stock.weight : 0;\n          let weight_total_assets = this.$root.total_cash;\n          let deal_price = stock.deal_price ? stock.deal_price : 0;\n          let trading_unit = stock.trading_unit ? stock.trading_unit : 0\n          if (!deal_price) {\n            //成本价格为0\n            return\n          }\n          stock_num = parseInt((transfer_position) * weight_total_assets / deal_price / trading_unit) * trading_unit;\n          stock.transfer_commission = stock_num;\n          //stock.transfer_position = (transfer_position * 100).toFixed(2);\n        }\n\n        if (this.$root.direction == \"sell\") {\n          // let transfer_position = this.$root.change_price_position_value / 100;\n          let transfer_position = 0;\n          let stock = this.stock;\n          let current_positon = stock.total_amount ? stock.total_amount : 0;\n          let trading_unit = stock.trading_unit ? stock.trading_unit : 0\n          stock_num = parseInt(transfer_position * current_positon / trading_unit) * trading_unit\n          stock.transfer_commission = stock_num;\n          // stock.transfer_position = (transfer_position * 100).toFixed(2);\n        }\n      }\n    },\n    // 监听批量处的radio修改，现在应该已经废弃了。\n    radio_type(val) {\n      //神操作 点击下面的radio 选择让td隐藏\n      if (this.$root.direction == \"sell\") {\n        //切换显示总资产比例或者持仓比例并清空输入框\n        if (val == \"total\") {\n          this.$refs.transfer_position[0].hidden = true;\n          this.$refs.total_position[0].hidden = false;\n        }\n\n        if (val == \"equal\") {\n          this.$refs.transfer_position[0].hidden = false;\n          this.$refs.total_position[0].hidden = true;\n        }\n      }\n      this.stock.transfer_commission = 0;\n    }\n  },\n  methods: {\n    modify_val(name, val) {\n      this.stock[name] = val;\n      val = val ? val : 0;\n\n      if (this.$root.direction == 'buy') {\n        //通过本次调仓 计算委托价格\n        if (name == \"transfer_position\") {\n          let transfer_position = val / 100;\n          let stock = this.stock;\n          let current_positon = stock.weight ? stock.weight : 0;\n          let weight_total_assets = this.$root.total_cash;\n          let deal_price = stock.deal_price ? stock.deal_price : 0;\n          let trading_unit = stock.trading_unit ? stock.trading_unit : 100;\n          let stock_num = parseInt(transfer_position * weight_total_assets / deal_price / trading_unit) * trading_unit;\n\n          //判断委托数量是否正确\n          if (stock_num < 0) {\n            // this.error_obj.type = true;\n            // this.error_obj.error_info = \"输入有误，请检查后重新输入\";\n            return\n          } else {\n            this.error_obj.type = false;\n            this.error_obj.error_info = \"\";\n            stock.transfer_commission = stock_num;\n          }\n        }\n      }\n\n      if (this.$root.direction == 'sell') {\n        //本次调仓比例计算 本次委卖数量\n        if (name == \"transfer_position\") {\n          var transfer_position = val / 100;\n          var stock = this.stock;\n          var current_amout = parseInt(stock.total_amount);\n\n          //   let stock_num = parseInt(transfer_position * stock.weight_total_assets/stock.deal_price /stock.trading_unit)*stock.trading_unit;\n          // var stock_num = current_amout /current_positon *100 * transfer_position*100 -entrust_sell_num;\n          var stock_num = parseInt(current_amout * transfer_position / stock.trading_unit) * stock.trading_unit\n            //判断委托数量是否正确\n          if (stock_num < 0) {\n            // this.error_obj.type = true;\n            // this.error_obj.error_info = \"输入有误，请检查后重新输入\";\n            return\n          } else {\n            this.error_obj.type = false;\n            this.error_obj.error_info = \"\";\n            stock.transfer_commission = stock_num;\n          }\n        }\n        //卖出时 总资产比例 计算本次委卖数量\n        if (name == 'total_position') {\n          var total_position = val / 100;\n          var stock = this.stock;\n          var new_price = (+stock.market_value) / (+stock.total_amount); //根据市值计算最新价\n          var last_price = (+stock.last_price) || 0;\n          var total_cash = this.$root.total_cash;\n          var stock_num = (+total_cash) * total_position / new_price;\n          stock.transfer_commission = parseInt(stock_num / stock.trading_unit) * stock.trading_unit;\n        }\n      }\n\n      if (name == \"transfer_commission\") {\n        val = val ? val : 0;\n        var stock = this.stock;\n        var stock_num = parseInt(val / stock.trading_unit) * stock.trading_unit;\n        // this.input_val = Math.abs( num );\n        this.stock.transfer_commission = stock_num;\n        //判断委托数量是否正确\n        if (stock_num < 0) {\n          // this.error_obj.type = true;\n          // this.error_obj.error_info = \"输入有误，请检查后重新输入\";\n          return\n        } else {\n          this.error_obj.type = false;\n          this.error_obj.error_info = \"\";\n        }\n      }\n    },\n    check_change(val) {\n      this.$emit('check_change', this.index, val);\n    },\n    select_change(index, val) {\n      this.stock.entrust_method = val;\n      if (val == \"2\") {\n        this.$refs.deal_price[0].my_showtype = 'readyonly';\n        this.stock.deal_price = this.stock.last_price * 1.1;\n\n      } else {\n        this.$refs.deal_price[0].my_showtype = 'input';\n        if (this.$root.direction == \"buy\") {\n          this.stock.deal_price = this.stock.bid1_price;\n          this.$refs.deal_price[0].input_val = this.stock.ask1_price\n        }\n        if (this.$root.direction == \"sell\") {\n          this.stock.deal_price = this.stock.ask1_price;\n          this.$refs.deal_price[0].input_val = this.stock.bid1_price;\n        }\n      }\n    },\n    delete_stock() {\n      if (this.is_loading) {\n        return;\n      }\n      var stock_id = this.stock.stock_id;\n      var url = (window.REQUEST_PREFIX || '') + '/user/stock-follow/delete';\n      this.is_loading = true;\n      $.post(url, {\n        stock_id: stock_id\n      }).done(function(res) {\n        if (res.code == 0) {\n          $.omsAlert('删除自选股 ' + stock_id + ' 成功！');\n          $(window).trigger({\n            type: 'create_order:multi_stocks:delete_stock',\n            stock: {\n              stock_id: stock_id\n            }\n          });\n        } else {\n          $.failNotice(url, res);\n        }\n      }).fail($.failNotice.bind(null, url)).always(function() {\n        this.is_loading = false;\n      });\n    },\n    mouseenter() {\n      //鼠标移入 显示风控提示\n      if (this.error_type) {\n        this.error_show = true;\n      }\n    },\n    mouseleave() {\n      this.error_show = false;\n    },\n  }\n});\n\n// 表格的多行数据组件\n// 问题1: <重复问题>props传的数据太多。且有冗余\nVue.component('vue-multi-tbody', {\n  props: [\"header_data\", \"list_data\", \"total_cash\", \"target_position_all\", \"transfer_position_all\", 'direction', \"total_max_cash\", \"delete_show\", \"radio_type\"],\n  watch: {},\n  template: `\n    <table class=\"nothing-nothing buy batch_list\">\n      <vue-row-header @check_all=check_all :header_data=\"header_data\" :list_data=\"list_data\" :checkall=\"checkall\" ></vue-row-header>\n      <tbody >\n        <template v-for=\"(stock,index) in  list_data\" >\n          <vue-row-tr :radio_type=radio_type @check_change=check_change :delete_show=delete_show :header_data=\"header_data\" :stock=\"stock\" :error_obj=\"error_arr[index]\"  :checktype=\"checkArr[index]\" :odd_price=\"odd_arr[index]\" :target_position_all=\"target_position_all\" :transfer_position_all=\"transfer_position_all\" :index=\"index\" ></vue-row-tr>\n        </template>\n      </tbody>\n      <template v-if=\"direction == 'buy' \">\n        <thead>\n          <tr class=\"total_tr\" style=\"padding-right: 10px;\" >\n            <th style=\"width:24px;\">\n                <div class=\"error_info\">\n                  <span style=\"display:none;\"></span>\n                </div>\n            </th>\n            <th style=\"flex:1;text-align:left;\">汇总</th>\n            <th style=\"width:18px;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">\n                {{weight_total}}\n                <span if-show=\"weight_total\">%</span>\n              </div>\n            </th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">{{current_entrust_total}}</div>\n            </th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">{{transfer_position_total}}<span if-show=\"transfer_position_total\">%</span></div>\n            </th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">{{transfer_commission_total}}</div>\n            </th>\n            <th style=\"width:22px;\"></th>\n          </tr>\n        </thead>\n      </template>\n      <template v-if=\"direction == 'sell' \">\n        <thead>\n          <tr class=\"total_tr\" style=\"padding-right: 10px;\">\n            <th style=\"width:24px;\">\n                <div class=\"error_info\"><span style=\"display:none;\"></span></div>\n            </th>\n            <th style=\"flex:1;text-align:left;\">汇总</th>\n            <th style=\"width:18px;\"></th>\n\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">\n                {{weight_total}}\n                <span if-show=\"weight_total\">%</span>\n              </div>\n            </th>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">\n                {{current_entrust_total}}\n              </div>\n            </th>\n            <th style=\"flex:1;\"></th>\n            <th style=\"flex:1;\"></th>\n            <template v-if=\"radio_type=='total'\">\n              <th style=\"flex:1;text-align:right;\">\n                <div style=\"padding-right: 10px;\">{{transfer_total_total}}<span if-show=\"transfer_total_total\">%</span></div>\n              </th>\n            </template>\n            <template v-else>\n              <th style=\"flex:1;\">\n                <div style=\"padding-right: 10px;\">- -</div>\n              </th>\n            </template>\n            <template v-if=\"radio_type=='equal'\">\n              <th style=\"flex:1;text-align:right;\">\n                <div style=\"padding-right: 10px;\">{{transfer_position_total}}<span if-show=\"transfer_position_total\">%</span></div>\n              </th>\n            </template>\n            <template v-else>\n              <th style=\"flex:1;text-align:right;\">\n                <div style=\"padding-right: 10px;\">- -</div>\n              </th>\n            </template>\n            <th style=\"flex:1;text-align:right;\">\n              <div style=\"padding-right: 10px;\">{{transfer_commission_total}}</div>\n            </th>\n            <th style=\"width:22px;\"></th>\n          </tr>\n        </thead>\n      </template>\n    </table>\n  `,\n  data: function() {\n    return {\n      \"weight_total\": 0, //总仓位\n      \"current_entrust_total\": 0, //当前挂单\n      \"target_position_total\": 0, //目标仓位\n      \"transfer_position_total\": 0, //本次调仓\n      \"transfer_commission_total\": 0, //本次委买\n      \"transfer_total_total\": 0, //按相同总资产比例\n      \"checkref\": \"checkbox\",\n      \"my_total_cash\": this.total_cash,\n      \"checkall\": false,\n      \"checklen\": this.list_data.length,\n      \"checknum\": 0,\n      \"checktr\": false,\n      \"checkArr\": [],\n      \"my_total_max_cash\": this.total_max_cash,\n      \"odd_arr\": [],\n      \"error_arr\": [],\n    }\n  },\n  watch: {\n    list_data(val) {\n      this.checklen = val.length\n      this.checkArr = new Array(val.length);\n      for (let i = 0; i < this.checkArr.length; i++) {\n        this.checkArr[i] = false;\n      }\n      this.checkall = false;\n      this.odd_arr = new Array(val.length);\n      for (let i = 0; i < this.odd_arr.length; i++) {\n        this.odd_arr[i] = 0;\n      }\n      this.error_arr = new Array(val.length);\n      for (let i = 0; i < this.error_arr.length; i++) {\n        this.error_arr[i] = {\n          type: false,\n          error_info: \"\"\n        };\n      }\n      this.my_total_max_cash = this.total_max_cash;\n      this.my_total_cash = this.total_cash\n        //股票数据改变获取新的委托数量\n      this.update_entrust_info();\n    },\n    checkArr() {\n      //当checkbox改变 调用整体风控\n      this.wind_contrl_all();\n    },\n  },\n  mounted() {\n    this.checkArr = new Array(this.checklen);\n    for (let i = 0; i < this.checkArr.length; i++) {\n      this.checkArr[i] = false;\n    }\n    this.odd_arr = new Array(this.checklen);\n    for (let i = 0; i < this.odd_arr.length; i++) {\n      this.odd_arr[i] = 0;\n    }\n  },\n  methods: {\n    check_all(val) {\n      this.checkall = val;\n      this.checkArr = new Array(this.checklen);\n      for (let i = 0; i < this.checkArr.length; i++) {\n        this.checkArr[i] = val;\n      }\n      //添加吸顶的全选状态改变\n      //$(this.$root.header_tr).find(':checkbox')[0].checked = val;\n    },\n    check_change(index, val) {\n      this.checkArr = new Array(...this.checkArr);\n      this.checkArr[index] = val;\n\n      let bool = true;\n\n      this.checkArr.forEach(function(ele) {\n        if (ele == false) {\n          bool = false;\n        }\n      })\n      this.checkall = bool;\n    },\n    onec_adjustment() {\n      this.my_total_max_cash = this.$root.total_max_cash;\n      //清空tr中的交易金额\n      for (let i = 0; i < this.odd_arr.length; i++) {\n        this.odd_arr[i] = 0;\n      }\n      this.error_arr.forEach(function(ele) {\n        ele.type = false;\n        ele.error_info = '';\n      })\n      //一键调整\n      var len = this.checkArr.length;\n      for (let i = 0; i < len; i++) {\n        if (this.checkArr[i]) {\n          //使用tr中的委托数进行一键调整 传 stock的数组序号🈴和当前的委托数目\n          // this.wind_contrl_op(i, this.list_data[i].transfer_commission)\n        }\n      }\n    },\n    wind_contrl_all() {\n      //  统计数据\n      this.weight_total = 0;\n      this.current_entrust_total = 0;\n      this.target_position_total = 0;\n      this.transfer_position_total = 0;\n      this.transfer_commission_total = 0;\n      this.transfer_total_total = 0;\n      var total_amount = 0;\n      //计算统计\n      for (let i = 0; i < this.checkArr.length; i++) {\n        if (this.checkArr[i]) {\n\n          this.weight_total += this.list_data[i].weight * 100 || 0;\n          this.current_entrust_total += parseFloat(this.list_data[i].current_entrust) || 0;\n          this.target_position_total += parseFloat(this.list_data[i].target_position) || 0;\n          this.transfer_position_total += parseFloat(this.list_data[i].transfer_position) || 0;\n          this.transfer_commission_total += parseFloat(this.list_data[i].transfer_commission) || 0;\n          this.transfer_total_total += parseFloat(this.list_data[i].total_position) || 0\n\n          total_amount += parseFloat(this.list_data[i].total_amount) || 0;\n\n        }\n      }\n\n      this.weight_total = this.weight_total.toFixed(2);\n      this.current_entrust_total = formatNumber(this.current_entrust_total, 0, 1);\n      this.target_position_total = this.target_position_total.toFixed(2);\n      this.transfer_position_total = this.transfer_position_total.toFixed(2);\n      this.transfer_total_total = this.transfer_total_total.toFixed(2);\n      //修改持仓比例汇总\n      if (this.$root.direction == \"sell\") {\n        if (total_amount == 0) {\n          total_amount = 1;\n        }\n        this.transfer_position_total = (this.transfer_commission_total / total_amount * 100).toFixed(2);\n      }\n    },\n    submit_stock_tbody() {\n      //委托确认\n      let orders = [];\n      let obj = {}\n      let len = this.list_data.length;\n      var self = this;\n      this.checkArr.forEach(function(ele, index) {\n        if (ele) {\n          if (self.list_data[index][\"transfer_commission\"] > 0) {\n            obj = {\n              price: self.list_data[index]['deal_price'],\n              trade_direction: self.$root.direction,\n              trade_mode: self.list_data[index].entrust_method || 2,\n              market: self.list_data[index].market,\n              volume: self.list_data[index][\"transfer_commission\"],\n              stock_id: self.list_data[index].stock_id,\n              stock_name: self.list_data[index].stock_name\n            }\n            orders.push(obj);\n          }\n        }\n      });\n\n      var url = (window.REQUEST_PREFIX || '') + '/oms/workflow/' + product.id + '/add_multi_hand_order';\n\n      if (orders.length) {\n        var is_trade_day = $.pullValue($('.trade-5').getCoreData(), 'is_trade_day');\n        //这里新增二次提醒\n        var htmlArr = [];\n        var totalAmount = 0;\n        var totalVolume = 0;\n        orders.forEach(function(e) {\n          var ins_price = e.price;\n          ins_price = ('' == ins_price) ? 0 : ins_price;\n          if (e.trade_direction == \"buy\") {\n            e.trade_direction = 1;\n          } else {\n            e.trade_direction = 2;\n          }\n          var ins_type = e.trade_direction; //1买入 2卖出\n          // var trade_market = 1;\n          var typeStr1 = '';\n          if (1 == ins_type) {\n            typeStr1 = '<span style=\"color:#F44336;\">买入</span>';\n          } else if (2 == ins_type) {\n            typeStr1 = '<span style=\"color:#2196F3\">卖出</span>';\n          }\n          var ins_model = e.trade_mode; //限价、市价，市价时，价格切记传空\n          var typeStr2 = '';\n          if ('marketA' == market) {\n            if (\"1\" == ins_model) {\n              typeStr2 = '限价';\n              if (0 == ins_price) {\n                ins_model = utils.stock_custom.getMarketType(e.stock_id.match(/[a-zA-Z]+/));\n                e.trade_mode = ins_model;\n                typeStr2 = '市价';\n                e.trade_mode = 2;\n              }\n              e.trade_mode = 1;\n            } else if (\"2\" == ins_model) {\n              // ins_price = 0;\n              ins_model = utils.stock_custom.getMarketType(e.stock_id.match(/[a-zA-Z]+/));\n              e.trade_mode = ins_model;\n              typeStr2 = '市价';\n              e.trade_mode = 2;\n            }\n            e.market = 1;\n          } else if ('marketHSH' == market) {\n            // trade_market = 2;\n            //e.trade_mode = e.marketH_trade_mode;\n            if (e.trade_mode == 5) {\n              typeStr2 = '增强限价'\n            } else if (e.trade_mode == 4) {\n              typeStr2 = '竞价限价'\n            }\n            e.market = 2;\n          } else if ('marketHSZ' == market) {\n            // trade_market = 2;\n            //e.trade_mode = e.marketH_trade_mode;\n            if (e.trade_mode == 5) {\n              typeStr2 = '增强限价'\n            } else if (e.trade_mode == 4) {\n              typeStr2 = '竞价限价'\n            }\n            e.market = 3;\n          }\n          var tmpInsVolume = e.volume;\n          var tmpInsAmount = Number((10000 * ins_price).toFixed(2)) * tmpInsVolume / 10000;\n          totalAmount = (parseFloat(totalAmount) * 10000 + parseFloat(tmpInsAmount) * 10000) / 10000;\n          totalVolume = parseFloat(totalVolume) + parseFloat(tmpInsVolume);\n          var priceStr = (('市价' == typeStr2) ? utils.common.getData(PRICE_TYPE_LIST, ins_model) : ins_price);\n          htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left\">' + e.stock_id + ' ' + e.stock_name + '</td>' +\n            '<td class=\"cell-left\">' + typeStr1 + '</td>' +\n            '<td class=\"cell-left\">' + typeStr2 + '</td>' +\n            '<td class=\"cell-right\" style=\"max-width:190px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\" title=\"' + priceStr + '\">' + priceStr + '</td>' +\n            '<td class=\"cell-right\">' + tmpInsVolume + '</td>' +\n            '<td class=\"cell-right\">' + tmpInsAmount + '</td></tr>');\n        });\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\"><tr><th class=\"cell-left\">证券</th>' +\n          '<th class=\"cell-left\">买卖标志</th>' +\n          '<th class=\"cell-left\">报价方式</th>' +\n          '<th class=\"cell-right\">委托价格</th>' +\n          '<th class=\"cell-right\">交易数量(股)</th>' +\n          '<th class=\"cell-right\">交易金额(元)</th></tr>' + htmlArr.join('') + '</tbody></table>' +\n          '<div class=\"custom_total\"><span style=\"color:#999999;font-size:13px;\">总计</span><span>' + totalVolume + '</span><span>' + totalAmount + '</span></div>';\n        if (0 == is_trade_day) { //0是休市时间，也就是非交易日或者是交易日的15点之后 1为非休市时间\n          confirmHtml += '<div style=\"color:#F44336;font-size: 14px;padding-bottom: 3px;\">*当前为休市时间，指令将提交至下一交易日</div>'\n        }\n        $.confirm({\n          title: '委托确认 <span style=\"margin-left:10px;font-size: 14px;font-weight: normal;\">交易单元：' + $('.multi-product-head').find('input[type=\"checkbox\"]:checked').siblings('span[data-src=\"name\"]').html() + '</span>',\n          content: confirmHtml,\n          closeIcon: true,\n          confirmButton: '确定',\n          cancelButton: false,\n          confirm: function() {\n            if ($.isLoading()) {\n              return;\n            }\n            $.startLoading('正在提交订单...');\n\n            $.post(url, {\n              multi: orders\n            }).done(function(res) {\n              if (res.code == 0) {\n                //reportResult(res);\n                self.submit_result(res, orders);\n                $(window).trigger({\n                  type: 'add_multi_hand_order:success',\n                  res: res\n                });\n                $(window).trigger({\n                  type: 'position_update_updated'\n                });\n                $(window).trigger({\n                    type: 'multi_batch:create_order:finish'\n                  }) //触发委托列表刷新\n              } else {\n                self.submit_result(res, orders);\n              }\n            }).fail($.failNotice.bind(null, url)).always(function() {\n              $.clearLoading();\n\n            });\n          }\n        });\n      } else {\n        $.omsAlert(\"提交失败，请检查！\", false);\n      }\n    },\n    wind_contrl_op(index, num) {\n      //一键调整操作\n      // if (num == 0) {\n      //   return;\n      // }\n      // if (this.$root.direction == \"buy\") {\n      //   // var tbody = this.$parent;\n      //   var current_total_max_cash = this.my_total_max_cash;\n      //   // let len = tbody.list_data.length;\n      //   for (var i = 0; i < this.checkArr.length; i++) {\n      //     if (this.checkArr[i] == true) {\n      //       if (i != index) {\n      //         current_total_max_cash -= this.odd_arr[i]\n      //       }\n      //     }\n      //   }\n      // }\n      // //获取最大交易金额\n      // var enable_cash = this.enable_cash\n      // var price_type = 1\n      // var stock = this.list_data[index];\n      // var price = stock.deal_price;\n      // var product = this.$root.product;\n      // var all_market_value = 0;\n      // window.risk_position[product.id].data.forEach(function(el) {\n      //   if (el.stock_id == stock.stock_id) {\n      //     let total_amount = el.total_amount;\n      //     let market_value = el.market_value;\n      //   }\n      //   all_market_value += el.market_value - 0;\n      // });\n      // enable_cash = enable_cash ? enable_cash : product.runtime.enable_cash;\n      // if (product) {\n      //   var obj = riskCheck.checkRules({\n      //     product_id: product.id, // 产品id， id\n      //     // 交易数据 form_data\n      //     trade_direction: direction == \"buy\" ? 1 : 2, // 交易方向，1买入 2卖出 trade_direction\n      //     trade_mode: price_type, // 1限价／2市价  trade_mode\n      //     volume: num, // 交易数量\n      //     price: price, // 限价金额\n      //     surged_limit: 1, // 涨停价 price已经做了处理了\n      //     decline_limit: 1, // 跌停价 price已经做了处理了\n      //     stock_code: stock.stock_id, // 股票code，包含“.SZ”,比较的时候最好都进行小写转换\n      //     stock_name: stock.stock_name, // 股票名称，用于判断st股票\n      //     // 产品的数据 product\n      //     total_assets: product.runtime.total_assets, // 资产总值 runtime.total_assets\n      //     enable_cash: current_total_max_cash, // 可用资金 runtime.enable_cash\n      //     security: all_market_value, // 持仓市值 runtime.security 改为 all_market_value\n      //     net_value: product.runtime.net_value, // 当日净值 runtime.net_value\n      //     // 持仓数据\n      //     market_value: stock.market_value, // 本股票持仓市值 //window.position_realtime里面有\n      //     total_amount: stock.total_amount, // 该股票当前持仓数\n      //     enable_sell_volume: 0 // 该股票能卖的数量\n      //   });\n      //   if (obj.code == 0) {\n      //     this.error_arr[index].type = false;\n      //     this.odd_arr[index] = num * price;\n      //   } else {\n      //     this.error_arr[index].type = true;\n      //     stock.transfer_commission = obj.freeNum;\n      //     this.error_arr[index].type = false;\n      //     this.odd_arr[index] = obj.freeNum * price;\n      //   }\n      // }\n    },\n    wind_contrl(index, num) {\n      //当行风控\n      //当前可用余额\n      if (num == 0) {\n        return;\n      }\n      if (this.$root.direction == \"buy\") {\n        var current_total_max_cash = this.my_total_max_cash\n          // let len = tbody.list_data.length;\n\n        for (var i = 0; i < this.checkArr.length; i++) {\n          if (this.checkArr[i] == true) {\n            if (i != this.index) {\n              current_total_max_cash -= this.odd_arr[i]\n            }\n          }\n        }\n      }\n      if (num == 0) {\n        this.error_arr[index] = true;\n        this.error_info = '当前购买股票不足100股，请修改！';\n        return\n      }\n      if (num < 0) {\n        this.error_arr[index] = true;\n        this.error_info = '输入有误，请检查后重新输入';\n        return\n      }\n      let stock = this.list_data[index];\n      // let price_type = this.price_method==\"limit_price\"?1:2;\n      let price_type = 1;\n      let price = stock.deal_price;\n      let product = this.$root.product;\n      let all_market_value = 0;\n      window.risk_position[product.id].data.forEach(function(el) {\n        if (el.stock_id == stock.stock_id) {\n          let total_amount = el.total_amount;\n          let market_value = el.market_value;\n        }\n        all_market_value += el.market_value - 0;\n      });\n      if (product) {\n        var obj = riskCheck.checkRules({\n          product_id: product.id, // 产品id， id\n          // 交易数据 form_data\n          trade_direction: this.$root.direction == \"buy\" ? 1 : 2, // 交易方向，1买入 2卖出 trade_direction\n          trade_mode: price_type, // 1限价／2市价  trade_mode\n          volume: num, // 交易数量\n          price: price, // 限价金额\n          surged_limit: 1, // 涨停价 price已经做了处理了\n          decline_limit: 1, // 跌停价 price已经做了处理了\n          stock_code: stock.stock_id.toLowerCase(), // 股票code，包含“.SZ”,比较的时候最好都进行小写转换\n          stock_name: stock.stock_name, // 股票名称，用于判断st股票\n          // 产品的数据 product\n          total_assets: product.runtime.total_assets, // 资产总值 runtime.total_assets\n          enable_cash: current_total_max_cash, // 可用资金 runtime.enable_cash\n          security: all_market_value, // 持仓市值 runtime.security 改为 all_market_value\n          net_value: product.runtime.net_value, // 当日净值 runtime.net_value\n          // 持仓数据\n          market_value: stock.market_value || 0, // 本股票持仓市值 //window.position_realtime里面有\n          total_amount: stock.total_amount || 0, // 该股票当前持仓数\n          enable_sell_volume: 0, // 该股票能卖的数量\n          trading_unit: stock.trading_unit //每手数量\n        });\n        if (obj.code == 0) {\n          let error_arr = new Array(...this.error_arr);\n          error_arr[index].type = false;\n          this.error_arr = error_arr;\n          this.odd_arr[this.index] = num * price;\n        } else {\n          this.odd_arr[this.index] = num * price;\n          let error_arr = new Array(...this.error_arr);\n          error_arr[index].type = true;\n          error_arr[index].error_info = obj.msg + ' 当前可买数量：' + obj.freeNum + '';\n          this.error_arr = error_arr;\n        }\n      }\n    },\n    change_price_target: function(val) {\n      //批量修改目标仓位\n    },\n    change_price_position(val) {\n      //批量修改本次调仓\n      //let self = this;\n      this.my_total_max_cash = this.$root.total_max_cash;\n      this.list_data.forEach(function(ele) {\n        ele.transfer_commission = 0;\n      })\n      this.odd_arr.forEach(function(ele) {\n        ele = 0;\n      })\n      this.error_arr.forEach(function(ele) {\n          ele.type = false;\n          ele.error_info = '';\n        })\n        //批量修改时 重置重大可交易金额\n        //批量修改时 将委托数量 置为零\n      for (let i = 0; i < this.checkArr.length; i++) {\n        if (this.checkArr[i]) {\n\n          let stock = this.list_data[i];\n          let transfer_position = val / 100;\n          let current_positon = stock.weight ? stock.weight : 0;\n          let weight_total_assets = this.total_cash;\n          let deal_price = stock.deal_price ? stock.deal_price : 0;\n          let trading_unit = stock.trading_unit ? stock.trading_unit : 0\n          stock.transfer_position = val;\n          if (!deal_price) {\n            //成本价格为0\n            continue\n          }\n          let stock_num; //委托数量\n          if (this.$root.direction == \"buy\") {\n            var stock_num = parseInt((transfer_position) * weight_total_assets / deal_price / trading_unit) * trading_unit;\n          }\n          if (this.$root.direction == \"sell\") {\n            var current_amout = parseInt(stock.total_amount);\n            var stock_num = parseInt(transfer_position * current_amout / trading_unit) * trading_unit\n          }\n          //判断委托数量是否正确\n          if (stock_num < 0) {\n            this.error_arr[i].type = true;\n            this.error_arr[i].error_info = \"输入有误，请检查后重新输入\";\n            return\n          } else {\n            this.error_arr[i].type = false;\n            this.error_arr[i].error_info = \"\";\n            stock.transfer_commission = stock_num;\n          }\n        }\n      };\n      this.wind_contrl_all();\n    },\n    change_price_total(val) {\n      //批量修改总资产比例调仓\n      this.my_total_max_cash = this.$root.total_max_cash;\n      this.list_data.forEach(function(ele) {\n        ele.transfer_commission = 0;\n      })\n      this.odd_arr.forEach(function(ele) {\n        ele = 0;\n      })\n      this.error_arr.forEach(function(ele) {\n          ele.type = false;\n          ele.error_info = '';\n        })\n        //批量修改时 重置重大可交易金额\n        //批量修改时 将委托数量 置为零\n      for (let i = 0; i < this.checkArr.length; i++) {\n        if (this.checkArr[i]) {\n          let total_position = val / 100;\n          let stock = this.list_data[i];\n          let new_price = (+stock.market_value) / (+stock.total_amount); //根据市值计算最新价\n          let last_price = (+stock.last_price) || 0;\n\n          let total_cash = this.$root.total_cash;\n          let stock_num = (+total_cash) * total_position / new_price;\n          stock.total_position = val;\n          //判断委托数量是否正确\n          if (stock_num < 0) {\n            this.error_arr[i].type = true;\n            this.error_arr[i].error_info = \"输入有误，请检查后重新输入\";\n            return\n          } else {\n            this.error_arr[i].type = false;\n            this.error_arr[i].error_info = \"\";\n            stock.transfer_commission = stock_num;\n          }\n          stock.transfer_commission = parseInt(stock_num / stock.trading_unit) * stock.trading_unit;\n        }\n      };\n      this.wind_contrl_all();\n    },\n    submit_result(res, orders) {\n      // res = {\n      //   \"code\": 0,\n      //   \"msg\": \"\",\n      //   \"data\": {\n      //     \"000017.SZ\": {\n      //       \"code\": 5022111,\n      //       \"msg\": \"\",\n      //       \"data\": {\n      //         \"msg\": [\n      //           \"已触发风控:0329股票池禁止买入\",\n      //           \"已触发风控(公司):0329股票池禁止买入\"\n      //         ],\n      //         \"limit_action\": 0\n      //       }\n      //     },\n      //     \"000023.SZ\": {\n      //       \"code\": 5022111,\n      //       \"msg\": \"\",\n      //       \"data\": {\n      //         \"msg\": [\n      //           \"已触发风控:0329股票池禁止买入\",\n      //           \"已触发风控(公司):0329股票池禁止买入\"\n      //         ],\n      //         \"limit_action\": 0\n      //       }\n      //     }\n      //   }\n      // }\n      let str_deal_method ;\n      if(this.$root.direction == \"buy\"){\n        str_deal_method=\"买入\"\n      }\n      if(this.$root.direction == \"sell\"){\n        str_deal_method=\"卖出\"\n      }\n      orders.forEach(function(row) {\n        if (res.code == 0) {\n          row.btnType = false;\n          row.msg = [\"委托成功\"];\n          row.entrustStatus = \"pass\";\n          row.style = {};\n        } else if(res.code == 700001){\n            if (res.data[row.stock_id]) {\n              let temp = res.data[row.stock_id];\n              if (temp.code == 0) {\n                //没问题\n                row.btnType = false;\n                row.msg = [\"委托成功\"];\n                row.entrustStatus = \"pass\";\n                row.style = {\n                }\n              } else if (temp.code == 5022111) {\n                //提示性风控\n                if (temp.msg == \"\") {\n                  if (temp.data.limit_action == 0) {\n                    //alert\n                    row.btnType = true;\n                    row.msg = temp.data.msg;\n                    row.entrustStatus = \"alert\";\n                    row.style = {\n                      color: \"#FAA11F\"\n                    }\n                  } else {\n                    //购买失败\n                    row.btnType = false;\n                    row.entrustStatus = \"fail\";\n                    row.style = {\n                      color: \"red\"\n                    }\n                    if (temp.msg == \"\") {\n                      row.msg = temp.data.msg;\n                    } else {\n                      row.msg = [temp.msg];\n                    }\n                    row.msg.unshift(\"委托失败\");\n                  }\n                } else {\n                  //购买失败\n                  row.btnType = false;\n                  row.entrustStatus = \"fail\";\n                  row.style = {\n                    color: \"red\"\n                  }\n                  if (temp.msg == \"\") {\n                    row.msg = []\n                  } else {\n                    row.msg = [temp.msg];\n                  }\n                  row.msg.unshift(\"委托失败\");\n                }\n              }else if(temp.code == 5022110){\n                row.btnType = false;\n                row.msg = [temp.msg];\n                row.msg.unshift(\"委托失败\");\n                row.entrustStatus = \"fail\";\n                row.style = {\n                  color: \"red\"\n                }\n              } else {\n                //禁止性风控\n                row.btnType = false;\n                if(temp.msg && temp.msg !=\"\"){\n                  row.msg = [temp.msg];\n                }else if(temp.data.msg){\n                  row.msg = temp.data.msg;\n                }else{\n                  row.msg = []\n                }\n                row.msg.unshift(\"委托失败\");\n                row.entrustStatus = \"fail\";\n                row.style = {\n                  color: \"red\"\n                }\n              }\n            } else {\n              row.btnType = false;\n              row.entrustStatus = \"pass\";\n              row.msg = [\"委托成功\"];\n              row.style = {\n\n              }\n            }\n        }else {\n          //购买失败\n          row.btnType = false;\n          row.entrustStatus = \"fail\";\n          row.style = {\n            color: \"red\"\n          }\n          if (res.msg == \"\") {\n            row.msg = [];\n          } else {\n            row.msg = [res.msg];\n          }\n          row.msg.unshift(\"委托失败\");\n        }\n      })\n      let product = this.$root.product;\n      let contentChild = Vue.extend({\n        data() {\n          this.$nextTick(function(){\n            // 加处理，清空数据\n            getStockList()\n          });\n          return {\n            // tableData: orders,\n            tableData: JSON.parse(JSON.stringify(orders)),\n            product:product\n          }\n        },\n        template: `\n          <div style=\"position:relative\">\n          <span style=\"position: absolute;top: -36px;left: 91px;font-size:12px;\">交易单元：{{product.name}}</span>\n          <div class=\"vue-form-confirmation\">\n              <table style=\"max-width: 600px;\">\n                  <thead>\n                      <tr style=\"border-bottom: 1px solid rgba(0,0,0,0.05);\">\n                          <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">证券</th>\n                          <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">`+str_deal_method+`价格</th>\n                          <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">`+str_deal_method+`数量</th>\n                          <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">备注</th>\n\n                      </tr>\n                  </thead>\n                  <tbody>\n                      <tr  v-for=\"row in tableData\" style=\"border-bottom: 1px solid rgba(0,0,0,0.05);\">\n                          <td class=\"vue-form-confirmation__text-align-left\">{{row.stock_name}}</td>\n                          <td class=\"vue-form-confirmation__text-align-left\">{{row.price}}</td>\n                          <td class=\"vue-form-confirmation__text-align-left\">{{row.volume}}</td>\n                          <td class=\"vue-form-confirmation__text-align-left vue-form-confirmation__span-center\" >\n                              <div>\n                                  <span :style=row.style>\n                                      <template v-for=\"msg in row.msg\">\n                                          {{msg}}</br>\n                                      </template>\n                                  </span>\n                                  <button type=\"\" v-if=\"row.btnType\" @click=btn_submit(row)>继续委托</button>\n                              </div>\n                          </td>\n                      </tr>\n                  </tbody>\n              </table>\n            </div>\n            </div>\n          `,\n        methods: {\n          btn_submit(row) {\n            //忽略提示性风控 继续购买\n            let _this = this;\n            let orders = [row]\n            var url = (window.REQUEST_PREFIX || '') + '/oms/workflow/' + product.id + '/add_multi_hand_order';\n            $.post(url, {\n              multi: orders,\n              ignore_tips:1,\n            }).done(function(res) {\n              if (res.code != 0) {\n                if (res.data == '') {\n                  row.btnType = false;\n                  row.entrustStatus = \"pass\";\n                  row.msg = [];\n                  row.msg.unshift('委托成功');\n                  row.style = {}\n                } else {\n                  var tmpObj = res.data[row.stock_id];\n                  if (0 == tmpObj.code) {\n                    row.btnType = false;\n                    row.entrustStatus = \"pass\";\n                    row.msg = [];\n                    row.msg.unshift('委托成功');\n                    row.style = {\n\n                    }\n                  } else {\n                    row.btnType = false;\n                    row.entrustStatus = \"fail\";\n                    row.msg = [];\n                    row.msg.unshift(tmpObj.msg);\n                    row.msg.unshift('委托失败');\n                    row.style = {\n                      color: \"red\"\n                    }\n                  }\n                }\n              } else {\n                  row.btnType = false;\n                  row.entrustStatus = \"pass\";\n                  row.msg = [];\n                  row.msg.unshift('委托成功');\n                  row.style = {};\n              }\n              _this.tableData = Object.assign({}, _this.tableData)\n            }).fail(function() {\n              row.btnType = false;\n              row.msg = [\"委托失败\"];\n              row.entrustStatus = \"fail\";\n              row.style = {\n                color: \"red\"\n              }\n              _this.tableData = Object.assign({}, _this.tableData)\n\n            });\n          },\n        },\n        mounted() {\n          $.clearLoading();\n        }\n      });\n\n      Vue.prototype.$confirm({\n        title: '委托结果',\n        content: contentChild,\n        closeIcon: true,\n      });\n    },\n    update_entrust_info() {\n      //更新委托数量\n      let entrust_info = window.entrust_info ? window.entrust_info : [];\n      let self = this;\n      if (entrust_info.length != 0) {\n        this.list_data.forEach((stock) => {\n          stock.current_entrust = 0;\n          stock.entrust_buy_num = 0;\n          stock.entrust_buy_money = 0;\n          stock.entrust_sell_num = 0;\n          stock.entrust_sell_money = 0;\n          entrust_info.forEach(function(entrust) {\n              if (entrust.stock.code == stock.stock_id && entrust.product_id == self.$root.product.id &&\n                (![4, 5, 7, 8, 9].some(function(ele) {\n                  return entrust.status == ele;\n                }) || (entrust.status == 4 && !/1|2/.test(entrust.cancel_status)))\n              ) {\n                if ('buy' == self.$root.direction && 1 == entrust.entrust.type) {\n\n\n\n                  stock.entrust_buy_num += entrust.entrust.amount - entrust.deal.amount;\n                  stock.entrust_buy_money += (entrust.entrust.amount - entrust.deal.amount) * entrust.entrust.price;\n\n\n\n                } else if ('sell' == self.$root.direction && 2 == entrust.entrust.type) {\n                  stock.entrust_sell_num += entrust.entrust.amount - entrust.deal.amount;\n                  stock.entrust_sell_money += (entrust.entrust.amount - entrust.deal.amount) * entrust.entrust.price;\n                }\n              }\n            })\n            // 修改当前委托数量为  买入数量或者卖出数量的最大值\n          stock.current_entrust = Math.max(stock.entrust_buy_num, stock.entrust_sell_num);\n\n\n          if (this.$root.direction == \"buy\") {\n            // stock.target_position = stock.target_position || 0;\n            // stock.target_position = parseFloat(stock.target_position);\n            // stock.total_amount = (stock.total_amount || 0)\n\n            // if (stock.total_amount) {\n            //   stock.target_position = (stock.total_amount + stock.entrust_sell_num) * stock.weight / stock.total_amount;\n            // } else {\n            //   stock.target_position = 0.00;\n            // }\n            // stock.target_position = (stock.target_position * 100).toFixed(2);\n          } else {\n            // stock.target_position = stock.target_position || 0;\n            // stock.target_position = parseFloat(stock.target_position)\n            // stock.total_amount = stock.total_amount || 0\n            // stock.target_position = (stock.total_amount - stock.entrust_sell_num) * stock.weight / stock.total_amount;\n            // stock.target_position = (stock.target_position * 100).toFixed(2);\n          }\n\n        })\n      } else {}\n      //触发滚动事件 出现滚动条\n      this.$nextTick(function() {\n        setTimeout(function() {\n          $(window).scroll();\n        })\n      })\n    }\n\n  }\n\n});\n\nVue.component('vue-error-ele', {\n  props: [\"isshow\", \"error_info\", \"delete_show\"],\n  template: `\n    <div class=\"error-box\">\n      <div class=\"error-info\" v-show=isshow><span>风险提示：</span>{{error_info}}</div>\n      <span v-if=delete_show class=\"dele_icon\" @click=\"delete_stock\"></span>\n    </div>\n  `,\n  methods: {\n    delete_stock() {\n      this.$emit('delete_stock');\n    }\n  }\n});\n\n// 自选股功能，又夹杂了交易相关功能。\n// 分析评价by：liuzeyafzy@gmail.com\n// 问题1: $refs来操作dom，导致不好被跟踪定位，严重影响定位解决问题的效率\n// 问题2: 此组件使用了子组件“vue-cell-default”，或者是命名，或者是理解不对。此组件明明只需要多个下拉框而已，却使用带表格cell含义的vue-cell-default\nVue.component('vue-foot-inner', {\n  props: [\"error_type\", \"direction\", \"radio_type\"],\n  template: `\n    <div class=\"foot-inner\" style=\"display: flex;\">\n      <div class=\"add_stock\" v-show=\"direction == 'buy'\" style=\"padding-left: 24px;clear: both;\">\n        <input id=\"add_stock_code\" style=\"padding: 0 5px;border-radius: 3px;border: 1px solid #ccc;\" :value=\"displayStockCode(stock_code)\" placeholder=\"输入股票代码 ...\" pattern=\"^(\\d{6}\\.(SZ|SH)|\\d{5}\\.(HK))$\" focus-class=\"active\" active-slide=\"#magic-suggest\" >\n        <div class=\"magic-suggest-wrap\" data-src=\"|getMagicSuggest\" display=\"none\"></div>\n        <button @click=\"addStock\">添加</button>\n      </div>\n\n      <div class=\"modify_stock\" style=\"flex: 1;text-align: right;\">\n        <template v-if=\"direction=='sell'\">\n          <label @click=\"radio_change('total')\">\n            <input style=\"border-radius: 3px;\" name=\"modify_method\" type=\"radio\" checked />\n            按同等总资产比例\n            <vue-cell-default :header_data=\"{class: 'vue_text_default'}\" ref=\"total\" placeholder=\"请输入比例\" @input_blur=\"input_blur\" showtype=\"input_percentage\" index=\"none\" name=\"change_price_total\" checktype=\"true\" class_name=\"vue_input_default\"></vue-cell-default>\n          </label>\n          <label>\n            <input style=\"border-radius: 3px;\" name=\"modify_method\" type=\"radio\" @click=\"radio_change('equal')\" />\n            按同等持仓比例\n            <vue-cell-default :header_data=\"{class: 'vue_text_default'}\" ref=\"equal\" placeholder=\"请输入比例\" @input_blur=\"input_blur\" showtype=\"input_percentage\" index=\"none\" name=\"change_price_position\" checktype=\"true\" class_name=\"vue_input_default\"></vue-cell-default>\n          </label>\n        </template>\n        <template v-if=\"direction=='buy'\">\n          <label @click=\"radio_change('equal')\">\n            <input name=\"modify_method\" type=\"radio\" style=\"display:none;border-radius: 3px;\"/>\n            按同等总资产比例\n            <vue-cell-default :header_data=\"{class: 'vue_text_default'}\" placeholder=\"请输入比例\" @input_blur=\"input_blur\" showtype=\"input_percentage\" index=\"none\" name=\"change_price_position\" checktype=\"true\" class_name=\"vue_input_default\"></vue-cell-default>\n          </label>\n        </template>\n      </div>\n\n      <div class=\"form_stock\" style=\"margin-right: 20px;clear: both;\">\n        <button v-show=\"direction=='buy'\" class=\"delal_btn_buy\" @click=\"submit_list\">批量买入</button>\n        <button v-show=\"direction!='buy'\" class=\"delal_btn_sell\" @click=\"submit_list\">批量卖出</button>\n        <button class=\"adjustment_btn\" @click=\"onec_adjustment\" style=\"display:none\">一键调仓</button>\n        <span v-show=\"error_type\">请修改触发风控的股票</span>\n      </div>\n\n    </div>\n  `,\n  data: function() {\n    return {\n      set_amount_type: \"part\",\n      equal_show: false,\n      target_show: false,\n      stock_code: '',\n    }\n  },\n  watch: {\n    radio_type(name) {\n      if(this.$root.direction != \"buy\"){\n        this.$nextTick(function() {\n          if (name == \"total\") {\n            this.$refs.total.my_showtype = \"input\";\n            this.$refs.equal.my_showtype = \"readyonly\";\n            this.$refs.equal.readyonly_placeholder = \"请输入比例\";\n            this.$refs.equal.input_val = ''\n          }\n          if (this.$root.direction == \"sell\") {\n            if (name == \"equal\") {\n              this.$refs.equal.my_showtype = \"input\";\n              this.$refs.total.my_showtype = \"readyonly\";\n              this.$refs.total.readyonly_placeholder = \"请输入比例\";\n            }\n          }\n          this.$refs.equal.input_val = '';\n          this.$refs.total.input_val = '';\n        })\n      }\n    }\n  },\n  methods: {\n    displayStockCode: function(val) {\n      if ('marketA' == market) {\n        return val\n      } else if ('marketHSH' == market) {\n        return val.replace('SH', '');\n      } else if ('marketHSZ' == market) {\n        return val.replace('SZ', '');\n      }\n    },\n    input_blur(name, val) {\n      if (name == \"change_price_target\") {\n        this.$emit(\"change_price_target\", val);\n      }\n      if (name == \"change_price_position\") {\n        this.$emit(\"change_price_position\", val);\n      }\n      if (name == \"change_price_total\") {\n        this.$emit('change_price_total', val)\n      }\n    },\n    radio_change: function(name) {\n      //切换input状态为只读\n      if (name == \"total\") {\n        this.$emit('change_radio_type', \"total\")\n      }\n\n      if (name == \"equal\") {\n        this.$emit('change_radio_type', \"equal\")\n      }\n    },\n    addStock: function() {\n      let _this = this;\n      if (!this.stock_code.length) {\n        $.omsAlert('股票代码不正确！', false);\n        return;\n      }\n      var stock_id = this.stock_code;\n      var url = (window.REQUEST_PREFIX || '') + '/user/stock-follow/add';\n\n      $.post(url, {\n        stock_id: this.stock_code\n      }).done(function(res) {\n        if (res.code == 0) {\n          $.omsAlert('添加自选股 ' + stock_id + ' 成功！');\n          var tmpLi = $('.multi-stocks-section').find('.magic-suggest>li');\n          var stock_name = '';\n          tmpLi.each(function() {\n            var arr = $(this).html().split(' &nbsp; ');\n            if (arr[0] == stock_id) {\n              stock_name = arr[1];\n            }\n          });\n          $(window).trigger({\n            type: 'create_order:multi_stocks:add_stock',\n            stock: {\n              stock_id: stock_id,\n              stock_name: stock_name\n            }\n          });\n          _this.stock_code = '';\n        } else {\n          res.code == 502204 ? $.omsAlert(res.msg, false) : $.failNotice(url, res);\n        }\n      }).fail($.failNotice.bind(null, url)).always(function() {});\n    },\n    submit_list: function() {\n      //跳转到tbody执行 委托确认\n      this.$emit('submit_list');\n    },\n    onec_adjustment: function() {\n      //tobody处理意见调仓\n      this.$emit('adjustment');\n    }\n  },\n  mounted() {\n    this.$on('addStock', 'addStock');\n    let self = this;\n    $(function() {\n      $('.multi-stocks-section').find('.magic-suggest-wrap').render();\n      $('.multi-stocks-section').on('stock_code:suggest', function(event) {\n        var stock = event.stock;\n\n        $('.multi-stocks-section').find('#add_stock_code').val(stock.stock_code + '.' + stock.exchange.slice(0, 2)).change();\n        self.stock_code = stock.stock_id;\n      });\n    });\n    $(window).on('stock:add_follow', function(event) {\n      var stock = event.stock;\n      // $('.multi-stocks-section').find('input').val(stock.stock_id).change();\n      // self.stock_code = stock.stock_id;\n      // self.$emit('addStock');\n      var url = (window.REQUEST_PREFIX || '') + '/user/stock-follow/add';\n      var stock_id = stock.stock_id;\n      var stock_name = stock.stock_name;\n      $.post(url, {\n        stock_id: stock_id\n      }).done(function(res) {\n        if (res.code == 0) {\n          $.omsAlert('添加自选股 ' + stock_id + ' 成功！');\n          $(window).trigger({\n            type: 'create_order:multi_stocks:add_stock',\n            stock: {\n              stock_id: stock_id,\n              stock_name: stock_name\n            }\n          });\n        } else {\n          res.code == 502204 ? $.omsAlert(res.msg, false) : $.failNotice(url, res);\n        }\n      }).fail($.failNotice.bind(null, url)).always(function() {});\n    });\n\n    $(window).on('order_create:market:changed', function(event) {\n      var market = event.market; //修改股票市场\n      $('.multi-stocks-section').find('input#add_stock_code').attr('data-market', market);\n      $('.multi-stocks-section').find('.magic-suggest-wrap').render();\n    });\n    // 切换交易方式，重新获取自选股数据\n    $(window).on('order_create:deal_method:changed', function(event) {\n      // 此处使用全局的market\n      $('.multi-stocks-section').find('input#add_stock_code').attr('data-market', market);\n      $('.multi-stocks-section').find('.magic-suggest-wrap').render();\n\n    });\n  }\n})\n\n// 类似于入口函数\n// 分析评价by：liuzeyafzy@gmail.com\n// 问题1: \"vm_multi || multiViewUpdate()\" 不应该这种使用方式来调用，应该使用显示的if判断来处理。不是说能写这样的代码能看懂这样的代码就牛的。\n// 问题2: 在我看来，使用vm_multi赋值给全局变量已经是一个不应该的事情了，更何况使用了这些全局变量变量：total_cash、direction、product、total_max_cash、product等。既然使用了函数扩起来，就该用传入参的方式来处理。\n// 问题3: 不推荐使用“this.delete_show = val == \"buy\" ? true : false;”这样的写法。\n// 问题4: 使用了“update5”的函数，函数中修改vm_multi的数据过于频繁了，其实可以在“update5”中拼好了再赋值给vm_multi的。\n// 问题5: 按我的理解，此root组件与vue-multi-tbody的数据交互，不需要传delete_show的，而应该传direction就可以了。这个root组件为什么要理解delete_show呢？把交易方向交给tbody组件，甚至于交给tr组件，再让子组件自己去判断就好了。感觉父子组件数据传输的逻辑关系不清晰。radio_type同理\n// 问题6: onec_adjustment这种一键调仓的功能去掉了就删掉，至少注释掉。\nfunction multiViewUpdate() {\n  vm_multi = new Vue({\n    el: \"[batch-deal-view]\",\n    data: {\n      \"table_data\": [],\n      \"stock_list\": [],\n      \"total_cash\": total_cash,\n      \"direction\": direction,\n      \"error_type\": false,\n      \"product\": product,\n      \"total_max_cash\": total_max_cash,\n      \"change_price_position_value\": 0,\n      \"change_price_target_value\": 0,\n      \"change_price_total_value\": 0,\n      \"amount_type\": 'part',\n      \"delete_show\": true,\n      \"header_tr\": '',\n      \"radio_type\": '',\n      \"product\": product\n    },\n    template: `\n      <div id=\"batch_section\">\n        <div class=\"buy multi-stocks-section\" >\n          <div style=\"padding-bottom: 20px;\">\n            <div id=\"multi_table_batch_buy\" >\n              <div class=\"section-loading loading-loading\"></div>\n              <vue-multi-tbody :radio_type=radio_type :header_data=table_data  :delete_show=delete_show ref=\"tbody\" :change_price_target=change_price_target :change_price_position=change_price_position :list_data=stock_list :total_cash=\"total_cash\" :total_max_cash=\"total_max_cash\" :direction=\"direction\"></vue-multi-tbody>\n            </div>\n          </div>\n          <div class=\"multi_footer\">\n            <vue-foot-inner :radio_type=radio_type @change_radio_type=change_radio_type :error_type=\"error_type\" :direction=\"direction\" @change_amount_type=change_amount_type @submit_list=submit_list @adjustment=adjustment @change_price_target=change_price_target @change_price_position=change_price_position @change_price_total=change_price_total></vue-foot-inner>\n          </div>\n        </div>\n      </div>\n    `,\n    watch: {\n      stock_list(val) {\n        var _stock_list = this.stock_list;\n\n        if (_stock_list.length > 0) {\n          var requset = [];\n          this.stock_list.forEach(function(ele, index) {\n            requset.push(ele.stock_id);\n          });\n          requset = requset.join(\",\");\n\n          update5(requset)\n        }\n      },\n      direction(val) {\n        this.delete_show = val == \"buy\" ? true : false;\n        if (val == \"sell\") {\n          this.radio_type = \"total\";\n        } else {\n          this.radio_type = '';\n        }\n      }\n    },\n    methods: {\n      submit_list() {\n        this.$refs.tbody.submit_stock_tbody()\n      },\n      adjustment() {\n        this.$refs.tbody.onec_adjustment();\n      },\n      change_price_position(val) {\n        this.change_price_position_value = val;\n        this.$refs.tbody.change_price_position(val);\n      },\n      change_price_target(val) {\n        this.change_price_target_value = val;\n        this.$refs.tbody.change_price_target(val);\n      },\n      change_price_total(val) {\n        this.change_price_total_value = val;\n        this.$refs.tbody.change_price_total(val);\n      },\n      change_amount_type(val) {\n        this.amount_type = val;\n      },\n      change_radio_type(val) {\n        this.radio_type = val;\n      }\n    }\n  });\n}\n"]}