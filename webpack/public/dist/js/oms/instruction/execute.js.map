{"version":3,"sources":["oms/instruction/execute.js"],"names":["orginfo_theme","window","LOGIN_INFO","org_info","theme","position_last_updated_timestamp","instructionExecutePage","tradeControllor","market","instructionExecuteData","typeStr","order","order_by","display_rules","type","id","label","format","class","preControl","trueClass","falseClass","preShow","subClass","sub_id","btnClickFn","entrust_query_arr","uri","REQUEST_PREFIX","gridDataStr","tips","withMultiIcon","$","on","event","product_list","product_ids","Vue","component","mixins","numberMixin","template","data","title","ajax_list","loadingStatus","rulesData","showAborted","showFinished","gridHead","web_checked","showManageList","beforeMount","loadManageList","watch","readyShowList","handler","every","e","deep","methods","_this","ajax","url","count","ins_status_arr","success","res","code","list","omsAlert","msg","error","chgAll","$nextTick","forEach","filter","tmpShowArr","tmpCheckedArr","showChildren","push","ins_id","arr","obj","instruction","some","el","stock_id","stock","stock_name","product_name","gathering","product_name_list","join","sub_list","deal_direction","deal_direction_name","price","quote_type","price_str","numeralNumber","ins_volume","add_ins_method","target_position","total_asset_ratio","latest_price","current_position","current_volume","current_cost_price","pending_order_number","progress","complete_progress","created_at","creator_name","fund_manager_name","status_name","status","operation","length","children","isChild","checked_count","me_can_trade","gridData","curActive","showChildrenList","Map","temporary_order","hideRevert","hideDeal","hideIssue","entrustGrid","entrustGrid_listNum","entrustGrid_midGridList","revertGrid","revertGrid_listNum","revertGrid_midGridList","dealGrid","dealGrid_listNum","dealGrid_midGridList","entrustAndDealGrid","entrustAndDealGrid_listNum","entrustAndDealGrid_midGridList","entrustListAGrid","entrustListAGrid_listNum","entrustListAGrid_midGridList","entrustListHGrid","entrustListHGrid_listNum","entrustListHGrid_midGridList","query_arr","orderNum","loadingNum","computed","activeGridList","entrustGridList","revertGridList","dealGridList","tmpRtn1","tmpRtn2","tmpRtn3","ele","checked","entrustAndDealGridList","product_id","entrustListAGridList","entrustListHGridList","rtn","sort","a","b","curQueryInfo","str","show_batchs","is_batch","orders","do_hide","get","batch_no","web_showChildren","hideStockType","val","split","displayStockClass","row","rule","value","checkStockType","test","toLowerCase","displayStockType","changeShow","set","checkDisabled","statusClass","checkShow","isFinish","doRevert","doRevertArr","htmlArr","cancel_status","entrustTypeCH","entrust_type","entrust_price","entrust_amount","html","confirmHtml","confirm","content","closeIcon","confirmButton","cancelButton","results","startLoading","cancel_res","setTimeout","entrust_id","stock_code","post","done","fail","always","checkResults","Math","random","waiting_num","filter_res","pullValue","NaN","clearLoading","loadOrderList","chgSelect","getGridList","deal_volume_by_group","entrust_amount_by_group","entrust_type_name","deal_avg_price","entrust","stock_info","name","product","parseFloat","amount","deal_price","deal","deal_amount","cancel_volume","entrust_model","model","updated_at","exchange_rate","bs_symbol_text","quote_type_text","vendor_status_text","batch_orders","sub_order","first_order","o1","o2","batch","deal_value","all_status","all_cancel_status","can_cancel","is_finish","all_finish_status","status_no","cancel_status_no","index","findIndex","is_sub","splice","order_status","v","toString","entrustTypeClass","statusCH","entrustModelType","unixTime","unixTimeStamp","undefined","momentor","moment","unix","arg","num","i","numeral","numeralPercent","displayValue","sub_value","Array","Function","args","concat","slice","apply","unit","displayClass","classFormat","last_loading_timestamp","Date","valueOf","getJSON","mergeOrderStocksInfo","then","mergeProductsBriefInfo","ordersLength","timestamp","entrust_info","ajaxExecuteList","ajaxProductList","doExecute","tradeFlow","chgSelectIns","loadList","instructionList","props","org_info_theme","curMarket","displayRevertNum","showBoard","hide","show","chgShowBoard","$emit","chgCurMarket","change","click","attr","chgActive","omsUpdateLocalJsonData","chgCurActive","stock_input_type_id","trade_model","trade_price","trade_num","showOrHide","can_trade_num_total","checkSubmitDisabled","mounted","chgTradePrice","setPriceAndAmount","volume","chgTradeNum","setCheckSubmitDisabled","setTotalInfo","setFormData","$refs","selectOneStock","trade_mode","chgStockId","chgTradeMode","chgInsMethod","multiProductsSubmit","colorMixin","ajaxStockDetail","showTipFlag","tag","ajaxTimes","loadInterval","is_loading","loadData","clearInterval","setInterval","cur_active","Object","keys","indexCopy","Number","floor","trading_unit","getTipStr","getStyle","showTip","hideTip","priceClick","trigger","tmpStockId","commonAjax","shgStockDetail","ask1_price","bid1_price","catch","err","withStockType","hide_flag","selectAll","selectList","chgSelectAll","marketType","time","code_000001","code_399001","code_399006","rgColor","middle","indexs","loadStockIndexs","res_data","index_stock","detail_arr","trade_number_method","buy_or_sell","display_arr","totalInfo","gap_number","gridHead_web_checked","checkedProductList","select_ins","trade_direction","stock_detail","multi_num","allDstPosition","allChgPosition","flag","riskRtn","checkRow","refreshDisplay","chgSingle","typeStr1","typeStr2","ins_price","stop_top","stop_down","totalAmount","totalMoney","toFixed","is_trade_day","location","search","includes","keyboardEnabled","isLoading","add_hand_order_res","trade_market","is_manual_order","trade_num_copy","btnType","entrustStatus","style","temp","limit_action","color","unshift","contentChild","extend","assign","tableData","form_data","btn_submit","self","ins_volume_arr","policy_amount_arr","randomNo","user_id","ignore_tips","console","log","prototype","$confirm","total_amount","market_value","all_market_value","stock_position_num","stock_entrust_num","stock_total_share","total_share_capital","stock_all_position_num","stock_all_entrust_num","stock_entrust_buy_num","stock_entrust_sell_num","stock_all_entrust_buy_num","stock_all_entrust_sell_num","risk_position","enable_sell_volume","position_realtime","riskCheck","checkRules","surged_limit","decline_limit","total_assets","runtime","enable_cash","security","net_value","display_title","setSubmitData","tmpSelectArr","totalGapNumber","net_assets","diff_number","min","predict_progress","$root","setDealPrice","leftWidth","wholeWidth","chgMenu","setWidth","intervalMap","loadRiskRulesInfo","Promise","resolve","reject","getRulesData","parseInt","loadStockPoolInfo","getStockPoolData","loadFeeRulesInfo","getFeeData","loadRiskPositionFn","call","loadRIskPositionInfo","loadPositionRealtimeFn","positions","position","profit_of_today","today_earning","PRODUCTS","profit_of_today_v2","redeem_fee","manage_fee","other_fee","profit_rate_of_day_v2","loadPositionRealtimeInfo","loadInsInfo","loadRuntimeFn","unuse_cache","failNotice","bind","loadRuntimeInfo","all","me","css","section_height","section","find","first","navigator","userAgent","addClass","container","closest","side_nav","scroll_reable_transition","strategy_scrollbar_full","ghost_section","appendTo","resize","clearTimeout","removeClass","side_nav_status","is","left","width","side_nav_width","scrollX","tmpWidth","outerWidth","height","max","last_updated_timestamp","updated_timestamp"],"mappings":"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","file":"execute.js","sourcesContent":["/**\n * 指令执行页面\n * Author: liuzeyafzy@gmail.com\n */\nvar orginfo_theme = window.LOGIN_INFO.org_info.theme;//机构版／专户版枚举值 专户版为3，机构版为非3.\nvar position_last_updated_timestamp = 0;\nlet instructionExecutePage;\nlet tradeControllor;\nlet market = 'marketA';\n\n// 指令执行表格数据\nlet instructionExecuteData = {\n  typeStr: '',\n  order: '',\n  order_by: '',\n  display_rules: [{\n    type: 'text',\n    id: 'stock_id',\n    label: '证券代码',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'stock_name',\n    label: '证券名称',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'product_name',\n    label: 3 == orginfo_theme ? '产品账户' : '交易单元',\n    format: '',\n    class: 'left20',\n    preControl: {\n      id: 'showChildren',\n      class: 'control-btn',\n      trueClass: 'control-btn__hide',\n      falseClass: 'control-btn__display'\n    }\n  },{\n    type: 'text',\n    id: 'fund_manager_name',\n    label: '基金经理',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'deal_direction_name',\n    label: '买卖标记',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'price_str',\n    label: '价格',\n    // format: ['numeralNumber', 3],\n    class: 'right20'\n  },{\n    type: 'text',\n    id: 'ins_volume',\n    label: '指令数量',\n    format: ['numeralNumber', 0],\n    class: 'right20'\n  },{\n    type: 'text',\n    id: 'target_position',\n    label: '目标仓位',\n    format: ['numeralPercent', 2],\n    class: 'right20'\n  },{\n    type: 'text',\n    id: 'total_asset_ratio',\n    label: '总资产比例',\n    format: ['numeralPercent', 2],\n    class: 'right20'\n  },{\n    type: 'text',\n    id: 'latest_price',\n    label: '最新价',\n    format: ['numeralNumber', 3],\n    class: 'right20'\n  },{\n    type: 'text',\n    id: 'current_position',\n    label: '当前持仓',\n    format: ['addParenthese', 'numeralPercent', 2],\n    preShow: {\n      type: 'text',\n      id: 'current_volume',\n      format: ['numeralNumber', 0]\n    },\n    class: 'right20 ',\n    subClass: 'colorYellow'\n  },{\n    type: 'text',\n    id: 'current_cost_price',\n    label: '当前持仓成本',\n    format: ['numeralNumber', 3],\n    class: 'right20'\n  },{\n    type: 'text', // 当前挂单\n    id: 'pending_order_number',\n    label: '当前挂单',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'percent2',\n    id: 'complete_progress',\n    sub_id: 'progress',\n    label: '执行进度',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'creator_name',\n    label: '创建人',\n    format: '',\n    class: 'left20'\n  },{\n    type: 'text',\n    id: 'created_at',\n    label: '创建时间',\n    format: '',\n    class: 'left20'\n\n  // },{\n  //   type: 'text',\n  //   id: 'status_name',\n  //   label: '指令状态',\n  //   format: '',\n  //   class: 'left20'\n  },{\n    type: 'btn',\n    id: 'status',\n    label: '操作',\n    format: ['displayStatusForExecute'],\n    btnClickFn: 'doExecute',\n    class: 'left20 width100'\n  }]\n};\n\nlet entrust_query_arr = [{\n  id: 'entrustAndDeal',\n  uri: window.REQUEST_PREFIX + '/oms/order/getEntrustAndDealList?permission_type=product&type=all&count=9999&market=1',\n  gridDataStr: 'entrustAndDealGrid',\n  display_rules: [{\n    id: 'product_name',\n    label: 3 == orginfo_theme ? '产品' : '交易单元',\n    format: '',\n    class: 'cell-left'\n  },{\n    id: 'stock_id',\n    label: '证券代码',\n    format: '',\n    class: 'cell-left'\n  },{\n    id: 'stock_name',\n    label: '证券名称',\n    format: '',\n    class: 'cell-left'\n  },{\n    id: 'entrust_type_name',\n    label: '买卖标志',\n    class: 'cell-left'\n  },{\n    id: 'entrust_amount_by_group',\n    label: '有效委托数量',\n    format: ['numeralNumber', 0],\n    tips: '有效委托数量不含废单及已撤销的委托数量',\n    class: 'cell-right'\n  },{\n    id: 'deal_volume_by_group',//'ins_volume_by_group',\n    label: '成交数量',\n    format: ['numeralNumber', 0],\n    class: 'cell-right'\n  },{\n    id: 'deal_avg_price',\n    label: '成交均价',\n    format: ['numeralNumber', 3],\n    class: 'cell-right'\n  }]\n},{\n  id: 'entrustListA',\n  uri: window.REQUEST_PREFIX + '/oms/order/get_entrust_list?permission_type=product&type=all&count=9999&market=1',\n  gridDataStr: 'entrustListAGrid',\n  // 证券代码 证券名称 买卖标志 产品 委托价格 委托数量 成交均价 成交数量 已撤数量 订单状态 报价方式 参考汇率 委托时间 更新时间\n  display_rules: [{\n    id: 'stock_id',\n    label: '证券代码',\n    withMultiIcon: true,\n    format: '',\n    class: ''\n  },{\n    id: 'stock_name',\n    label: '证券名称',\n    format: '',\n    class: 'cell-left'\n  },{\n    id: 'bs_symbol_text',\n    label: '买卖标志',\n    class: 'cell-left'\n  },{\n    id: 'product_name',\n    label: '产品',\n    class: 'cell-left'\n  },{\n    id: 'entrust_price',\n    label: '委托价格',\n    format: ['numeralNumber', 3],\n    class: 'cell-right'\n  },{\n    id: 'entrust_amount',\n    label: '委托数量',\n    format: ['numeralNumber', 0],\n    class: 'cell-right'\n  },{\n    id: 'deal_price',\n    label: '成交均价',\n    format: ['numeralNumber', 3],\n    class: 'cell-right'\n  },{\n    id: 'deal_amount',\n    label: '成交数量',\n    format: ['numeralNumber', 0],\n    class: 'cell-right'\n  },{\n    id: 'cancel_volume',\n    label: '已撤数量',\n    format: ['numeralNumber', 0],\n    class: 'cell-right'\n  },{\n    id: 'vendor_status_text',\n    label: '订单状态',\n    class: 'cell-right'\n  },{\n    id: 'quote_type_text',\n    label: '报价方式',\n    format: '',\n    class: 'cell-right'\n  },{\n    id: 'exchange_rate',\n    label: '参考汇率',\n    format: '',\n    class: 'cell-right'\n  },{\n    id: 'created_at',\n    label: '委托时间',\n    format: ['unixTime', 3],\n    class: 'cell-right'\n  },{\n    id: 'updated_at',\n    label: '更新时间',\n    format: ['unixTime', 3],\n    class: 'cell-right'\n  }]\n}];\n\n$(window).on('multi_load', function(event){\n  var product_list = event.product_list;\n  var product_ids = event.product_ids;\n\n  // 指令管理表格\n  Vue.component('vue-instruction-execute', {\n    // props: ['ajax_list'],\n    mixins: [numberMixin],\n    template: `\n      <div class=\"instruction-manage\">\n        <div class=\"instruction-manage__header\" style=\"padding: 10px 30px 10px;display: flex;\">\n          <h2 style=\"display: inline-block;\">{{title}}</h2>\n          <div style=\"flex:1\"></div>\n          <label style=\"margin-right: 20px;padding-top: 10px;\"><i style=\"width: 12px;height: 12px;display: inline-block;background: #FB8927;margin-right: 5px;\"></i>已完成比例</label>\n          <label style=\"margin-right: 40px;padding-top: 10px;\"><i style=\"width: 12px;height: 12px;display: inline-block;background: #FFDE00;margin-right: 5px;\"></i>挂单比例</label>\n          <a @click=\"loadManageList()\" class=\"bem-ui-btn bem-ui-btn__refresh-btn\" v-bind:class=\"{'loading': 'loading' == loadingStatus}\"><i></i>刷新</a>\n        </div>\n        <table class=\"instruction-manage__body newweb-common-grid oms-nothing-table\" v-bind:class=\"{'nothing': showManageList.length == 0}\">\n          <thead>\n            <tr>\n              <vue-common-grid-th v-for=\"rule in rulesData.display_rules\" :rule=\"rule\" :row=\"gridHead\" @change=\"chgAll($event)\"></vue-common-grid-th>\n            </tr>\n          </thead>\n          <tbody>\n            <template v-for=\"row in showManageList\">\n              <tr>\n                <vue-common-grid-td v-for=\"rule in rulesData.display_rules\" v-model=\"row[rule.id]\" :rule=\"rule\" :row=\"row\"></vue-common-grid-td>\n              </tr>\n              <template v-if=\"row.children && 0 < row.children.length && row.showChildren\">\n                <tr v-for=\"sub_row in row.children\">\n                  <vue-common-grid-td v-for=\"rule in rulesData.display_rules\" :rule=\"rule\" :row=\"sub_row\"></vue-common-grid-td>\n                </tr>\n              </template>\n            </template>\n          </tbody>\n        </table>\n      </div>\n    `,\n    data: function(){\n      return {\n        title: '指令执行',\n        ajax_list: [],\n        loadingStatus: '',\n        rulesData: instructionExecuteData,\n        showAborted: true,\n        showFinished: true,\n        gridHead: {\n          web_checked: false\n        },\n        // checkedAll: false,\n        // ajaxManageList: [],\n        showManageList: [],\n      }\n    },\n    beforeMount: function(){\n      this.loadManageList();\n    },\n    watch: {\n      ajax_list: function(){\n        this.readyShowList();\n      },\n      showManageList: {\n        handler: function(){\n          if (this.showManageList.every(e => true === e.web_checked)) {\n            this.gridHead.web_checked = true;\n          }else{\n            this.gridHead.web_checked = false;\n          }\n        },\n        deep: true\n      }\n    },\n    methods: {\n      loadManageList: function(){\n        let _this = this;\n        this.loadingStatus = 'loading';\n        $.ajax({\n          url: window.REQUEST_PREFIX + '/sync/instruction/search_list',\n          data: {\n            count: 9999,\n            type: 'execute',\n            ins_status_arr: [-1, 2, 3, 4]\n          },\n          success: function(res){\n            _this.loadingStatus = '';\n            if (0 == res.code) {\n              _this.ajax_list = res.data.list || [];\n            }else{\n              $.omsAlert(res.msg);\n            }\n          },\n          error: function(){\n            _this.loadingStatus = '';\n            $.omsAlert('网络异常');\n          }\n        })\n      },\n      chgAll: function(event){\n        this.$nextTick(() => {\n          this.showManageList.forEach(function(e){\n            e.web_checked = event;\n          });\n          this.showManageList.filter(function(e){\n\n          });\n        });\n      },\n      readyShowList: function(){\n        let tmpShowArr = [];\n        let tmpCheckedArr = [];\n        this.showManageList.forEach(e => {\n          if (e.showChildren) {\n            tmpShowArr.push(e.ins_id);\n          }\n\n          if (e.web_checked) {\n            tmpCheckedArr.push(e.ins_id);\n          }\n        })\n\n        let arr = [];\n        this.ajax_list.forEach((e) => {\n          let obj = {};\n          obj.id = e.instruction.id;\n          // 照抄，避免没有定义ins_id\n          obj.ins_id = e.instruction.id;\n          obj.web_checked = false;\n          if (tmpCheckedArr.some(el => el == obj.ins_id)) {\n            obj.web_checked = true;\n          }\n          obj.id = e.instruction.id;\n          // 股票代码\n          obj.stock_id = e.stock.stock_id;\n          // 股票名称\n          obj.stock_name = e.stock.stock_name;\n          // 产品名称\n          obj.product_name = e.gathering.product_name_list.join('，');\n          obj.sub_list = e.sub_list;\n\n          // 交易方向、买卖标志\n          obj.deal_direction = e.gathering.deal_direction;\n          obj.deal_direction_name = e.gathering.deal_direction_name;\n          // 指令价格\n          obj.price = e.gathering.price;\n          if (1 == e.instruction.quote_type) {\n            obj.price_str = this.numeralNumber(obj.price, 3);\n          }else{\n            obj.price_str = '市价';\n          }\n\n          // 指令数量\n          obj.ins_volume = e.gathering.ins_volume;\n          // 目标仓位\n          if (1 == e.instruction.add_ins_method) {\n            obj.target_position = e.gathering.target_position;\n          }else{\n            obj.target_position = '--';\n          }\n          // obj.target_position = e.gathering.target_position;\n          // 本次调仓\n          // obj.current_adjust_position = e.gathering.current_adjust_position;\n          // 总资产比例\n          if (2 == e.instruction.add_ins_method) {\n            obj.total_asset_ratio = e.gathering.total_asset_ratio;\n          }else{\n            obj.total_asset_ratio = '--';\n          }\n          // obj.total_asset_ratio = e.gathering.total_asset_ratio;\n          // 最新价\n          obj.latest_price = e.stock.latest_price;\n          // 当前持仓\n          obj.current_position = e.gathering.current_position;\n          // 当前持仓数量\n          obj.current_volume = e.gathering.current_volume;\n          // 当前持仓成本价\n          obj.current_cost_price = e.gathering.current_cost_price;\n          // 当前挂单\n          obj.pending_order_number = e.gathering.pending_order_number;\n          // 完成进度百分比\n          obj.progress = e.gathering.progress;\n          // 挂单进度百分比\n          obj.complete_progress = e.gathering.complete_progress;\n          // 创建日期\n          obj.created_at = e.instruction.created_at;\n          // 创建人\n          obj.creator_name = e.instruction.creator_name;\n          // 基金经理\n          obj.fund_manager_name = e.instruction.fund_manager_name;\n          // 指令状态\n          obj.status_name = e.instruction.status_name;\n          obj.status = e.instruction.status; //(2提交成功，3正在执行，4执行完毕，-1终止执行)\n          // 操作\n          obj.operation = '撤销';\n          obj.showChildren = false;\n          if (tmpShowArr.some(el => el == obj.ins_id)) {\n            obj.showChildren = true;\n          }\n\n          // 产品账户购买子列表 // 结构与gathering一致\n          if (e.sub_list.length > 1) {\n            obj.children = e.sub_list;\n            obj.children.forEach(function(e){\n              e.isChild = true;\n            })\n          }else{\n            obj.children = [];\n          }\n\n          arr.push(obj);\n        });\n\n        this.showManageList = arr;\n      }\n    }\n  });\n\n  // 订单列表\n  let orginfo_theme = window.LOGIN_INFO.org_info.theme;// 非3表示机构版\n  Vue.component('vue-order-list', {\n    template: `\n      <section class=\"order-list new-design\">\n        <a id=\"anchor-orderlist\" style=\"position: relative;top:-65px;display: block;height: 0;width:0;\"></a>\n        <div class=\"hd\">\n          <span class=\"section-title\">订单</span>\n\n          <span class=\"order-list-ctrls left loading-loading list-ctrls\">\n            <label v-if=\"3 == orginfo_theme\" class=\"order-label\" v-bind:class=\"{'active': curActive == 'entrust'}\"><input v-model=\"curActive\" type=\"radio\" name=\"display_type\" value=\"entrust\" />今日委托（{{entrustGrid_listNum || 0}}笔）</label>\n            <label v-if=\"3 == orginfo_theme\" class=\"order-label\" v-bind:class=\"{'active': curActive == 'deal'}\"><input v-model=\"curActive\" type=\"radio\" name=\"display_type\" value=\"deal\" />今日成交（{{dealGrid_listNum || 0}}笔）</label>\n            <label v-if=\"3 != orginfo_theme\" class=\"order-label\" v-bind:class=\"{'active': curActive == 'entrustAndDeal'}\">\n              <input v-model=\"curActive\" type=\"radio\" name=\"display_type\" value=\"entrustAndDeal\" />\n              委托成交汇总\n            </label>\n            <label v-if=\"3 != orginfo_theme\" class=\"order-label\" v-bind:class=\"{'active': curActive == 'entrustListA'}\">\n              <input v-model=\"curActive\" type=\"radio\" name=\"display_type\" value=\"entrustListA\" />\n              委托明细A（{{entrustListAGrid_listNum || 0}}笔）\n            </label>\n            <label v-if=\"3 != orginfo_theme && false\" class=\"order-label\" v-bind:class=\"{'active': curActive == 'entrustListH'}\">\n              <input v-model=\"curActive\" type=\"radio\" name=\"display_type\" value=\"entrustListH\" />\n              委托明细H（{{entrustListHGrid_listNum || 0}}笔）\n            </label>\n          </span>\n          <span v-if=\"'entrustListA' == curActive || 'entrustListH' == curActive || (orginfo_theme == 3 && curActive == 'entrust')\" class=\"order-list-ctrls left loading-loading\">\n            <label style=\"margin-right: 20px;\"><input style=\"margin-right: 5px;\" type=\"checkbox\" v-model=\"hideRevert\" />隐藏已撤</label>\n            <label style=\"margin-right: 20px;\"><input style=\"margin-right: 5px;\" type=\"checkbox\" v-model=\"hideDeal\" />隐藏已成</label>\n            <label style=\"margin-right: 20px;\"><input style=\"margin-right: 5px;\" type=\"checkbox\" v-model=\"hideIssue\" />隐藏废单</label>\n          </span>\n          <a class=\"oms-btn gray refresh-btn loading-loading right\" v-bind:class=\"{'loading': loadingNum > 0}\" href=\"javascript:;\" v-on:click=\"loadOrderList\"><i class=\"oms-icon refresh\"></i>刷新</a>\n          <a v-if=\"curActive == 'revert' || (orginfo_theme == 3 && curActive == 'entrust')\" class=\"oms-btn red revert-btn  right\" href=\"javascript:;\" v-on:click=\"doRevert\">撤单</a>\n        </div>\n        <table class=\"oms-table loading-loading nothing-nothing\" v-bind:class=\"{'nothing': Object.keys(temporary_order).length == 0 && activeGridList.length == 0}\">\n          <tbody>\n            <tr>\n              <th v-if=\"curActive == 'revert' || (orginfo_theme == 3 && curActive == 'entrust')\" style=\"width: 40px;\"></th>\n              <th v-if=\"rule.hide_flag != true\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                <span v-text=\"rule.label\"></span>\n                <prompt-language style=\"width: 15px;display: inline-block;position: absolute;right: -10px;top: 6px;\" v-if=\"'' != rule.tips && undefined != rule.tips\" :language_val=\"rule.tips\"></prompt-language>\n              </th>\n            </tr>\n          </tbody>\n          <tbody>\n            <tr v-if=\"Object.keys(temporary_order).length > 0\">\n              <td v-if=\"curActive == 'revert' || (orginfo_theme == 3 && curActive == 'entrust')\">\n                <input :disabled=\"checkDisabled(temporary_order)\" type=\"checkbox\" v-model=\"temporary_order.web_checked\" v-on:change=\"chgSelect(temporary_order)\" />\n              </td>\n              <td v-on:click=\"changeShow(temporary_order)\" v-if=\"rule.hide_flag != true\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                <span v-bind:class=\"displayClass(temporary_order, rule)\" v-text=\"displayValue(temporary_order, rule)\"></span>\n                <div v-if=\"rule.withMultiIcon && temporary_order.is_batch\" v-bind:class=\"{'icon-show': temporary_order.web_showChildren, 'icon-hide': !temporary_order.web_showChildren}\"></div>\n              </td>\n            </tr>\n            <tr v-for=\"row in activeGridList\" v-show=\"checkShow(row)\" v-bind:class=\"{'sub_order': row.is_sub, 'display_multi': row.web_showChildren}\">\n              <td v-if=\"curActive == 'revert' || (orginfo_theme == 3 && curActive == 'entrust')\">\n                <input :disabled=\"checkDisabled(row)\" type=\"checkbox\" v-model=\"row.web_checked\" v-on:change=\"chgSelect(row)\" />\n              </td>\n              <td v-on:click=\"changeShow(row)\" v-if=\"rule.hide_flag != true\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                <span v-bind:class=\"displayClass(row, rule)\" v-text=\"displayValue(row, rule)\"></span>\n                <div v-if=\"rule.withMultiIcon && row.is_batch\" v-bind:class=\"{'icon-show': row.web_showChildren, 'icon-hide': !row.web_showChildren}\" ></div>\n                <span v-if=\"rule.withStockType && (3 == checkStockType(row[rule.id]) || 4 == checkStockType(row[rule.id]))\" v-bind:class=\"displayStockClass(row, rule)\">\n                  {{ displayStockType(row[rule.id]) }}\n                </span>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </section>\n    `,\n    data: function(){\n      return {\n        // 已经选中的产品信息\n        product_list: [],\n        checked_count: 0,\n\n        me_can_trade: true,\n        gridData: [],\n        curActive: (3 == orginfo_theme) ? 'entrust' : 'entrustAndDeal',\n        // 记录showChildrenList为true的id\n        showChildrenList: new Map(),\n\n        orginfo_theme: orginfo_theme,\n        temporary_order: {},\n\n        hideRevert: false,\n        hideDeal: false,\n        hideIssue: false,\n\n        // 委托列表\n        entrustGrid: {},\n        entrustGrid_listNum: 0,\n        entrustGrid_midGridList: [],\n        // 机构版撤单相关已无用，已经改到了底部的菜单\n        revertGrid: {},\n        revertGrid_listNum: 0,\n        revertGrid_midGridList: [],\n        // 成交列表\n        dealGrid: {},\n        dealGrid_listNum: 0,\n        dealGrid_midGridList: [],\n        // 委托成交列表\n        entrustAndDealGrid: {},\n        entrustAndDealGrid_listNum: 0,\n        entrustAndDealGrid_midGridList: [],\n        // 委托明细A\n        entrustListAGrid:{},\n        entrustListAGrid_listNum: 0,\n        entrustListAGrid_midGridList: [],\n        // 委托明细H\n        entrustListHGrid:{},\n        entrustListHGrid_listNum: 0,\n        entrustListHGrid_midGridList: [],\n\n        query_arr: entrust_query_arr,\n        orderNum: 0,\n        // last_loading_timestamp: '',\n        loadingNum: 0\n      }\n    },\n    computed: {\n      activeGridList: function(){\n        var _this = this;\n        if ('entrust' == this.curActive) {\n          this.entrustGrid_listNum = this.entrustGridList.length;\n          return this.entrustGridList;\n        }\n\n        if ('revert' == this.curActive) {\n          this.revertGrid_listNum = this.revertGridList.length;\n          return this.revertGridList;\n        }\n\n        if ('deal' == this.curActive) {\n          this.dealGrid_listNum = this.dealGridList.length;\n          return this.dealGridList;\n        }\n\n        // 新增判断所有列表在当前组合选中情况下的数量\n        if (0 != this.checked_count) {\n          var tmpRtn1 = [];\n          var tmpRtn2 = [];\n          var tmpRtn3 = [];\n          this.product_list.forEach(function(ele){\n            if (true == ele.checked) {\n              _this.entrustAndDealGridList.forEach(function(e){\n                if (e.product_id == ele.product_id){\n                  tmpRtn1.push(e);\n                }\n              });\n\n              _this.entrustListAGridList.forEach(function(e){\n                if (e.product_id == ele.product_id){\n                  tmpRtn2.push(e);\n                }\n              });\n\n              _this.entrustListHGridList.forEach(function(e){\n                if (e.product_id == ele.product_id){\n                  tmpRtn3.push(e);\n                }\n              });\n            }\n          });\n          _this['entrustAndDealGrid_listNum'] = tmpRtn1.length;\n          _this['entrustListAGrid_listNum'] = tmpRtn2.length;\n          _this['entrustListHGrid_listNum'] = tmpRtn3.length;\n        }else{\n          _this['entrustAndDealGrid_listNum'] = _this.entrustAndDealGridList.length;\n          _this['entrustListAGrid_listNum'] = _this.entrustListAGridList.length;\n          _this['entrustListHGrid_listNum'] = _this.entrustListHGridList.length;\n        }\n\n        // 委托成交汇总\n        if ('entrustAndDeal' == this.curActive) {\n          if (0 == this.checked_count) {\n            _this['entrustAndDealGrid_listNum'] = this.entrustAndDealGridList.length;\n            return this.entrustAndDealGridList;\n          }else{\n            var rtn = [];\n            this.product_list.forEach(function(ele){\n              if (true == ele.checked) {\n                _this.entrustAndDealGridList.forEach(function(e){\n                  if (e.product_id == ele.product_id){\n                    rtn.push(e);\n                  }\n                });\n              }\n            });\n            _this['entrustAndDealGrid_listNum'] = rtn.length;\n            return rtn;\n          }\n        }\n\n        // 委托A\n        if ('entrustListA' == this.curActive) {\n          // return this.entrustListAGridList;\n          if (0 == this.checked_count) {\n            _this['entrustListAGrid_listNum'] = this.entrustListAGridList.length;\n            return this.entrustListAGridList;\n          }else{\n            var rtn = [];\n            this.product_list.forEach(function(ele){\n              if (true == ele.checked) {\n                _this.entrustListAGridList.forEach(function(e){\n                  if (e.product_id == ele.product_id){\n                    rtn.push(e);\n                  }\n                });\n              }\n            });\n            rtn = rtn.sort(function(a,b){\n              return b.created_at - a.created_at;\n            });\n            _this['entrustListAGrid_listNum'] = rtn.length;\n            return rtn;\n          }\n        }\n\n        // 委托H\n        if ('entrustListH' == this.curActive) {\n          // return this.entrustListHGridList;\n          if (0 == this.checked_count) {\n            _this['entrustListHGrid_listNum'] = this.entrustListHGridList.length;\n            return this.entrustListHGridList;\n          }else{\n            var rtn = [];\n            this.product_list.forEach(function(ele){\n              if (true == ele.checked) {\n                _this.entrustListHGridList.forEach(function(e){\n                  if (e.product_id == ele.product_id){\n                    rtn.push(e);\n                  }\n                });\n              }\n            });\n            rtn = rtn.sort(function(a,b){\n              return b.created_at - a.created_at;\n            });\n            _this['entrustListHGrid_listNum'] = rtn.length;\n            return rtn;\n          }\n        }\n\n        return [];\n      },\n      curQueryInfo: function(){\n        var _this = this;\n        var rtn = {};\n        this.query_arr.forEach(function(e){\n          if (e.id == _this.curActive) {\n            rtn = e;\n          }\n        });\n        return rtn;\n      },\n      entrustGridList: function(){\n        var _this = this;\n        var str = 'entrustGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n\n        show_batchs.forEach(function(e){\n          if (_this.showChildrenList.get(e.batch_no)) {\n            e.web_showChildren = true;\n          }\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      },\n      dealGridList: function(){\n        var str = 'dealGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      },\n      // 委托成交汇总\n      entrustAndDealGridList: function(){\n        var str = 'entrustAndDealGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      },\n      // 委托A\n      entrustListAGridList: function(){\n        var str = 'entrustListAGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      },\n      // 委托H\n      entrustListHGridList: function(){\n        var str = 'entrustListHGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      },\n      // 可撤单（已废弃）\n      revertGridList: function(){\n        var str = 'revertGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      }\n    },\n    methods: {\n      hideStockType: function(val){\n        return val.split(/\\./)[0];\n      },\n      displayStockClass: function(row, rule){\n        var value = row[rule.id];\n        var type = this.checkStockType(value);\n        if (3 == type) {\n          return 'stock-type-hksh';\n        }\n        if (4 == type) {\n          return 'stock-type-hksz'\n        }\n      },\n      checkStockType: function(value){\n        if (/\\.sh/.test(value.toLowerCase())) {\n          return 1;\n        }\n        if (/\\.sz/.test(value.toLowerCase())) {\n          return 2;\n        }\n        if (/\\.hksh/.test(value.toLowerCase())) {\n          return 3;\n        }\n        if (/\\.hksz/.test(value.toLowerCase())) {\n          return 4;\n        }\n      },\n      displayStockType: function(value){\n        var type = this.checkStockType(value);\n        if (3 == type) {\n          return '沪港通'\n        }\n        if (4 == type) {\n          return '深港通'\n        }\n      },\n      changeShow: function(row){\n        if (row.is_batch) {\n          row.web_showChildren = !row.web_showChildren;\n\n          if (row.web_showChildren == true) {\n            this.showChildrenList.set(row.batch_no, true);\n          }else{\n            this.showChildrenList.set(row.batch_no, false);\n          }\n        }\n      },\n      checkDisabled: function(row){\n        return (this.statusClass(row) !== 'red' || 6 == row.status || 8 == row.status || 105 == row.status || 108 == row.status) ? true : false\n      },\n      checkShow: function(row){\n        if (row.do_hide) {\n          return false;\n        }\n        if (row.status == 7 && this.hideRevert) {\n          return false;\n        }\n        // if ((row.status == 5 || row.status == 105) && this.hideDeal) {\n        //   return false;\n        // }\n        if ((this.isFinish(row) && row.status != 7 && row.status != 8) && this.hideDeal) {\n          return false;\n        }\n        if (row.status == 8 && this.hideIssue) {\n          return false;\n        }\n\n        return true;\n      },\n      doRevert: function(){\n        var _this = this;\n        var doRevertArr = [];\n        var htmlArr = [];\n        this.activeGridList.forEach(function(e){\n          if (e.is_batch != true && e.web_checked && !(+e.cancel_status) && [1,2,4].some(function(el){\n            return el == e.status\n          })) {\n            doRevertArr.push(e);\n            htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left\">' + e.product_name + '</td>' +\n              '<td class=\"cell-left\">' + e.stock_id + ' ' + e.stock_name + '</td>' +\n              '<td class=\"cell-left\">' + _this.entrustTypeCH(e.entrust_type) + '</td>' +\n              '<td class=\"cell-right\">' + _this.numeralNumber(e.entrust_price, 3) + '</td>' +\n              '<td class=\"cell-right\">' + e.entrust_amount + '</td></tr>');\n\n          }\n        });\n\n        if (doRevertArr.length == 0) {\n          $.omsAlert('请选择需要撤单的订单');\n          return;\n        }\n\n        var html = htmlArr.join('');\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\"><tr><th class=\"cell-left\">策略</th>'+\n          '<th class=\"cell-left\">证券</th>'+\n          '<th class=\"cell-left\">买卖标志</th>'+\n          '<th class=\"cell-right\">委托价格</th>'+\n          '<th class=\"cell-right\">委托数量(股)</th></tr>'+html+'</tbody></table>';\n\n        $.confirm({\n          title: '撤单确认',\n          content: confirmHtml,\n          closeIcon: true,\n          confirmButton: '确定',\n          cancelButton: false,\n          confirm: function(){\n            var results = [];\n\n            $.startLoading('正在批量撤单...');\n            doRevertArr.forEach(function(order){\n              order.cancel_res = null;\n              results.push(order);\n              setTimeout(function(){\n                var url = (window.REQUEST_PREFIX||'')+'/oms/workflow/'+order.product_id+'/'+order.id +'/do_cancel?workflow_id=' + order.id;\n\n                if (3 != _this.orginfo_theme) {\n                  url = (window.REQUEST_PREFIX||'')+'/oms/workflow/' + order.product_id + '/direct_cancel?entrust_id=' + order.entrust_id + '&stock_id=' + order.stock_code;\n                }\n\n                $.post(url).done(function(res){\n                    order.cancel_res = res;\n                }).fail(function(){\n                    order.cancel_res = {code:110,msg:'网络错误！'};\n                }).always(function(){\n                  _this.checkResults(results);\n                });\n              },Math.random()*500);\n            });\n\n          }\n        });\n      },\n      checkResults: function(results){\n\n\n        var _this = this;\n        var waiting_num = results.filter(function(order){\n            return !order.cancel_res;\n        }).length;\n        if(waiting_num){return;}\n\n        var filter_res = {success:[],fail:[]};\n        results.forEach(function(order){\n            filter_res[$.pullValue(order,'cancel_res.code',NaN) == 0 ? 'success' : 'fail'].push(order);\n        });\n\n        var htmlArr = [];\n        filter_res.fail.forEach(function(e){\n          htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left max-width-120\" title=\"'+ e.product_name +'\">' + e.product_name + '</td>' +\n            '<td class=\"cell-left\">' + e.stock_id + ' ' + e.stock_name + '</td>' +\n            '<td class=\"cell-left\">' + _this.entrustTypeCH(e.entrust_type) + '</td>' +\n            '<td class=\"cell-right\">' + _this.numeralNumber(e.entrust_price, 3) + '</td>' +\n            '<td class=\"cell-right\">' + e.entrust_amount + '</td>' +\n            '<td>' + e.cancel_res.msg + '</td>' +\n            '</tr>');\n        });\n\n        var html = htmlArr.join('');\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\">'+\n          '<tr>'+\n          '<th class=\"min-width-40 max-width-120 cell-left\">策略</th>'+\n          '<th class=\"min-width-40 cell-left\">证券</th>'+\n          '<th class=\"min-width-40 cell-left\">买卖标志</th>'+\n          '<th class=\"min-width-40 cell-right\">委托价格</th>'+\n          '<th class=\"min-width-40 cell-right\">委托数量(股)</th>'+\n          '<th class=\"min-width-40 cell-right\">备注</th>' +\n          '</tr>'+html+'</tbody></table>';\n\n        $.clearLoading();\n\n        if (filter_res.fail.length == 0) {\n          $.omsAlert('撤单请求提交成功')\n        }else{\n          $.confirm({\n            title: '失败提示',\n            content: confirmHtml,\n            closeIcon: true,\n            confirmButton: '确定',\n            cancelButton: false\n          });\n        }\n\n        setTimeout(function(){\n          _this.loadOrderList();\n        });\n        setTimeout(function(){\n            _this.loadOrderList();\n        }, 2000);\n\n      },\n      chgSelect: function(row){\n        if (row.is_batch) {\n          // 修改批量的选中框之后，修改其子项的选中框\n          row.orders.forEach(function(e){\n            e.web_checked = row.web_checked;\n          })\n        }\n      },\n      getGridList: function(str){\n        let _this = this;\n        var rtn = [];\n\n        // 后端接口返回格式不统一，\"委托成交汇总\"接口不返回entrust、deal这样的结构，没办法，只能走特殊分支处理\n        if('entrustAndDealGrid' == str){\n          this[str].list.forEach(function(e){\n            var obj = {};\n            obj.product_id = e.product_id;\n            obj.product_name = e.product_name;\n            obj.deal_volume_by_group = e.deal_volume_by_group;\n            obj.entrust_amount_by_group = e.entrust_amount_by_group;\n            obj.stock_code = e.stock_code;\n            obj.stock_id = e.stock_code;\n            obj.stock_name = e.stock_name;\n            obj.entrust_type_name = e.entrust_type_name;\n            obj.deal_avg_price = e.deal_avg_price;\n            rtn.push(obj);\n          });\n          this[str + '_midGridList'] = rtn;\n          return;\n        }\n\n        this.temporary_order = {};\n\n        this[str].list.forEach(function(e){\n          var obj = {};\n          obj.web_checked = false;\n          // 批量处理序号\n          obj.batch_no = e.entrust.batch_no;\n          // 证券代码\n          // obj.stock_id = e.stock_info ? e.stock_info.stock_id : '';\n          obj.stock_id = ('' == e.stock.code) ? (e.stock_info ? e.stock_info.stock_id : '') : e.stock.code;\n          // 机构版撤单id，仅revert表格使用\n          obj.entrust_id = e.entrust_id;\n          // 机构版股票代码，仅revert表格使用\n          obj.stock_code = e.stock ? e.stock.code : '';\n          // 证券名称\n          obj.stock_name = ('' == e.stock.name) ? (e.stock_info ? e.stock_info.stock_name : '') : e.stock.name;\n          // 买卖标志\n          obj.entrust_type = e.entrust.type;\n          // 策略\n          obj.product_name = e.product ? e.product.name : '';\n          // 委托价格\n          obj.entrust_price = e.entrust.price;\n          // 委托数量\n          obj.entrust_amount = parseFloat(e.entrust.amount);\n          // 成交均价\n          obj.deal_price = e.deal.price;\n          // 成交数量\n          obj.deal_amount = e.deal.amount;\n          // 已撤数量\n          obj.cancel_volume = e.entrust.cancel_volume;\n          // 订单状态\n          obj.status = e.status;\n          // 报价方式\n          obj.entrust_model = e.entrust.model;\n          // 委托时间\n          obj.created_at = e.created_at;\n          // 更新时间 //在已成交的订单中，这就是成交时间\n          obj.updated_at = e.updated_at;\n\n          // 汇率\n          obj.exchange_rate = e.entrust.exchange_rate;\n          // 买卖方向\n          obj.bs_symbol_text = e.entrust.bs_symbol_text;\n          // 报价方式\n          obj.quote_type_text = e.entrust.quote_type_text;\n          // 订单状态\n          obj.vendor_status_text = e.entrust.vendor_status_text;\n\n          obj.cancel_status = e.cancel_status;\n          obj.id = e.id;\n          obj.product_id = e.product_id;\n\n\n          rtn.push(obj);\n        });\n\n        var batch_orders = {};\n        rtn.forEach(function(e){\n          if (e.batch_no) {\n            e.sub_order = e.batch_no;\n            (batch_orders[e.batch_no] = batch_orders[e.batch_no] || []).push(e);\n          }\n        });\n\n        rtn = rtn.sort(function(a, b){\n          // return a.batch_no < b.batch_no ? 1 : -1;\n          return a.created_at < b.created_at ? 1 : -1;\n        })\n\n        var show_batchs = [];\n        for(var batch_no in batch_orders){\n          if (batch_orders[batch_no].length>1) {\n\n          }\n          // 得到批量的显示内容\n          var first_order = batch_orders[batch_no].sort(function(o1,o2){\n            return o1.updated_at>o2.updated_at ? 1 : -1;\n          })[0];\n\n          // todo 这里的参数格式要变一下\n          var batch = {\n            is_batch: true,\n\n            web_checked: false,\n            web_showChildren: false,\n\n            batch_no: first_order.batch_no,\n            updated_at: first_order.updated_at,\n            created_at: first_order.created_at,\n\n            orders: batch_orders[batch_no],\n\n            // 证券代码\n            stock_id : first_order.stock_id,\n            // 证券名称\n            stock_name : first_order.stock_name,\n            // 买卖标志\n            entrust_type : first_order.entrust_type,\n            // 策略\n            product_name : '多策略',//first_order.product_name,\n            // 委托价格\n            entrust_price : first_order.entrust_price,\n            // 委托数量\n            entrust_amount : 0, // first_order.entrust_amount,\n            // 成交均价\n            deal_price : 0, //first_order.deal_price,\n            deal_value : 0, //first_order.deal_value,\n            // 成交数量\n            deal_amount : 0, //first_order.deal_amount,\n            // 已撤数量\n            cancel_volume: 0,\n            // 订单状态\n            status : 0, //first_order.status,\n            // 报价方式\n            entrust_model : first_order.entrust_model,\n            // 委托时间\n            created_at : first_order.created_at,\n            // 更新时间 //在已成交的订单中，这就是成交时间\n            updated_at : first_order.updated_at,\n\n            product: {\n                name: '多策略',\n                length: batch_orders[batch_no].length\n            },\n\n            all_status: [],\n\n            cancel_status: \"\",\n            all_cancel_status: [],\n            can_cancel: false,\n\n            all_finish_status: []//,\n\n            // me_can_trade: first_order.me_can_trade\n          };\n\n          batch_orders[batch_no].forEach(function(order){\n            var deal_price = +$.pullValue(order,'deal_price')||0;\n            var deal_amount = +$.pullValue(order,'deal_amount')||0;\n            var deal_value = deal_price*deal_amount;\n\n            // $.pushValue(order,'deal_value',deal_value);\n            batch.deal_value += deal_value;\n            batch.deal_amount += deal_amount;\n            batch.deal_price = batch.deal_amount ? batch.deal_value/batch.deal_amount : 0;\n\n            var entrust_amount = +$.pullValue(order,'entrust_amount')||0;\n            batch.entrust_amount += entrust_amount;\n\n            batch.all_status.push(+order.status||0);\n            batch.all_cancel_status.push(+order.cancel_status||0);\n\n            order.can_cancel = /1|2|4/.test( order.status ) && !/1|2/.test( order.cancel_status );\n\n            order.is_finish = _this.isFinish(order);\n            batch.all_finish_status.push(order.is_finish?1:0);\n\n            //########## 断定是否可以撤单\n            batch.can_cancel = batch.can_cancel || order.can_cancel;\n          });\n\n          //########### Batch 状态处理\n          // 这里for循环最终执行的条件似乎是：all_status是全为一个数字元素的数组。比如说：[1,1,1,1,1,1,1]\n          [1,2,3,4,5,6,7,8,9].forEach(function(status_no){\n            batch.all_status.filter(function(status){return status==status_no}).length == batch.all_status.length && (batch.status = status_no);\n          });\n          // 这里for循环最终执行的条件似乎是：all_cancel_status是全为一个数字元素的数组。\n          [1,2].forEach(function(cancel_status_no){\n            batch.all_cancel_status.filter(function(cancel_status){\n              return cancel_status==cancel_status_no\n            }).length == batch.all_cancel_status.length && (batch.cancel_status = cancel_status_no);\n          });\n\n          // 多策略状态展示逻辑遵守单策略订单状态显示逻辑\n          // 以已完成、已完成（有废单）、未完成描述策略订单状态。\n          // 1、当策略订单中有待完成的订单时：委托、部分成交、等待撤单等，显示未完成。\n          // 2、当策略订单中所有订单操作时：全部成交、全部撤单显示已完成；\n          // 3、当策略中有废单，其余订单全部完成时，显示：已完成（有废单）\n\n          // 这里的枚举实在是不清楚什么含义\n          if(!batch.status){\n            batch.status = /0/.test( batch.all_finish_status.join('') ) ? 101 : (\n              /8/.test( batch.all_status.join('') ) ? 108 : 105\n            );\n          }\n\n          show_batchs.push(batch);\n        }\n\n        // 这里实际上也包含了只有一个元素的带有batch_no的数据列，在随后的插入数据操作中注意过滤\n        show_batchs = show_batchs.filter(function(e){\n          return e.orders.length > 1;\n        });\n\n        show_batchs.forEach(function(e){\n          var batch_no = e.batch_no;\n          var index = rtn.findIndex(function(el){\n            return el.batch_no == batch_no;\n          });\n          e.orders.forEach(function(el){\n            el.is_sub = true;\n          });\n          rtn.splice(index, 0, e);\n        });\n\n        // this[str + '_midGridList'] = [];\n        this[str + '_midGridList'] = rtn;\n      },\n      // 判断是否已经结束\n      isFinish: function(order){\n          if( order.status == 3 ){ return true; }\n          if( order.status == 5 ){ return true; }\n          if( order.status == 7 ){ return true; }\n          if( order.status == 8 ){ return true; }\n          if( order.status == 9 ){ return true; }\n          if( order.status == 105 ){ return true; }\n          if( order.status == 108 ){ return true; }\n          if( order.order_status == 4 ){ return true; }\n          if( order.cancel_status == 2 ){ return true; }\n          return false;\n      },\n      entrustTypeCH: function(v){\n        switch(v.toString()){\n          case '1': return '买入';\n          case '2': return '卖出';\n          case '101': return '融券';\n        }\n      },\n      entrustTypeClass: function(v){\n        switch(v.toString()){\n          case '1': return 'red';\n          case '2': return 'blue';\n          case '101': return '';\n        }\n      },\n      statusCH: function(v){\n        switch(v.toString()){\n          case '1': return '等待执行';\n          case '2': return '已委托';\n          case '3': return '已退回';\n          case '4': return '部分成交';\n          case '5': return '全部成交';\n          case '6': return '等待撤单';\n          case '7': return '已撤单';\n          case '8': return '废单';\n          case '9': return '已删除';\n\n          //多策略订单合并状态\n          case '101': return '未完成';\n          case '105': return '已完成';\n          case '108': return '已完成（有废单）';\n\n          //刚刚添加的订单\n          case '0': return '提交中..';\n\n          default: return '- -';\n        }\n      },\n      // // 判断是否已经结束\n      // isFinish: function(order){\n      //     if( order.status == 3 ){ return true; }\n      //     if( order.status == 5 ){ return true; }\n      //     if( order.status == 7 ){ return true; }\n      //     if( order.status == 8 ){ return true; }\n      //     if( order.status == 9 ){ return true; }\n      //     if( order.status == 105 ){ return true; }\n      //     if( order.status == 108 ){ return true; }\n      //     if( order.order_status == 4 ){ return true; }\n      //     if( order.cancel_status == 2 ){ return true; }\n      //     return false;\n      // },\n      statusClass: function(v){\n        if (this.isFinish(v) == false && v.status != 0) {\n          return 'red';\n        }else{\n          return '';\n        }\n      },\n      entrustModelType: function(v){\n        switch(v.toString()){\n          case '1': return '限价';\n          case '2': return '市价';\n          case '3': return '市价(对手方最优价格)';\n          case '4': return '市价(本方最优价格)';\n          case '5': return '市价(即时成交剩余撤单)';\n          case '6': return '市价(最优五档即时成交剩余撤单)';\n          case '7': return '市价(全额成交或撤单)';\n          case '8': return '市价(最优五档即时成交剩余转限)';\n        }\n      },\n      unixTime: function(unixTimeStamp){\n        if (undefined == unixTimeStamp) {\n          return '--';\n        }\n\n        var momentor = /\\-/.test(unixTimeStamp) ? moment : moment.unix;// if hyphen is tested, it's sqlTimeStr and use moment, else use moment.unix\n        return  moment().format('YYYY-MM-DD') === momentor(unixTimeStamp).format('YYYY-MM-DD')\n            ? momentor(unixTimeStamp).format('HH:mm:ss')\n            : momentor(unixTimeStamp).format('M月D日 HH:mm:ss');\n      },\n      numeralNumber: function(arg, num){\n        if ('--' == arg || '' === arg || undefined == arg) {\n          return '--'\n        }\n        if (undefined != num) {\n          var str = '0.'\n          for (let i = num - 1; i >= 0; i--) {\n            str += '0';\n          }\n          if(0 == num){\n            str = '0';\n          }\n          return numeral(arg).format( '0,' + str );\n        }\n        return numeral(arg).format( '0,0.00' );\n      },\n      numeralPercent: function(arg){\n        return numeral(arg).format( '0.00%' );\n      },\n      displayValue: function(sub_value, rule){\n        var value = sub_value[rule.id];\n        if ((rule.format != '') && (rule.format instanceof Array) && (this[rule.format[0]] instanceof Function)) {\n          // value = this[rule.format].call(this, value, )\n          var args = [value].concat(rule.format.slice(1))\n          value = this[rule.format[0]].apply(this, args);\n\n        }\n        if (rule.unit) {\n          return value + rule.unit;\n        }else{\n          return value;\n        }\n      },\n      displayClass: function(sub_value, rule){\n        // 注意这里是把sub_value整个传给了函数处理\n        var value = sub_value;\n        var rtn = '';\n        if ((rule.classFormat != '') && (rule.classFormat instanceof Array) && (this[rule.classFormat[0]] instanceof Function)) {\n          // value = this[rule.classFormat].call(this, value, )\n          var args = [value].concat(rule.classFormat.slice(1))\n          rtn = this[rule.classFormat[0]].apply(this, args);\n        }\n        return rtn;\n      },\n      // 读取三个接口的数据\n      loadOrderList: function(){\n        let _this = this;\n        // this.last_loading_timestamp = new Date().valueOf();\n        this.query_arr.forEach(function(e){\n          var last_loading_timestamp = new Date().valueOf();\n          _this[e.gridDataStr].last_loading_timestamp = last_loading_timestamp;\n\n          _this[e.gridDataStr].loadingStatus = 'loading';\n          _this.loadingNum += 1;\n          $.getJSON(e.uri, {product_id: product_ids}).done(function(res){\n            if( _this[e.gridDataStr].last_loading_timestamp != last_loading_timestamp ){return;}\n\n            if (0 == res.code) {\n              var orders = res.data.list || [];\n              // // 额外，更新当天所有委托信息\n              // if (e.gridDataStr == 'entrustGrid') {\n              //   window.entrust_info = orders;\n              // }\n              mergeOrderStocksInfo(orders).then(function(){\n                mergeProductsBriefInfo(orders).then(function(){\n                  _this[e.gridDataStr]['list'] = orders;\n                  // 计算数量，在后面根据选中产品也进行了对改字段的修改。以后面的为准\n                  // 但是有些不过滤的就以此处为准\n                  if (0 == _this.checked_count) {\n                    _this[e.gridDataStr+ '_listNum'] = orders.length;\n                  }else{\n                    var ordersLength = 0;\n                    _this.product_list.forEach(function(ele){\n                      if (true == ele.checked) {\n                        orders.forEach(function(e){\n                          if (e.product_id == ele.product_id){\n                            ordersLength++;\n                          }\n                        });\n                      }\n                    });\n                    _this[e.gridDataStr+ '_listNum'] = ordersLength;\n                  }\n\n                  _this[e.gridDataStr]['last_updated_timestamp'] = res.timestamp;\n                  _this.getGridList(e.gridDataStr);\n                })\n              })\n            }\n          }).always(function(){\n            _this.loadingNum -= 1;\n            _this[e.gridDataStr].loadingStatus = '';\n          });\n        });\n\n        // 额外，更新当天所有委托信息\n        $.getJSON(window.REQUEST_PREFIX + '/oms/order/get_entrust_list?permission_type=product&type=all', {\n          product_id: product_ids\n        }).done(function(res){\n          if (0 == res.code) {\n            var orders = res.data.list || [];\n            window.entrust_info = orders;\n\n            // mergeOrderStocksInfo(orders).then(function(){\n            //   mergeProductsBriefInfo(orders).then(function(){\n            //     window.entrust_info = orders;\n            //   });\n            // });\n\n          }\n        })\n      }\n    }\n  })\n\n  // 指令执行页面展示\n  instructionExecutePage = new Vue({\n    el: '#instruction-execute',\n    data: {\n      ajaxExecuteList: [],\n      ajaxProductList: [],\n    },\n    methods: {\n      doExecute: function(row, rule){\n\n        tradeFlow.chgSelectIns(row);\n      },\n      loadList: function(product_list){\n        this.ajaxExecuteList = window.instructionList;\n        this.ajaxProductList = product_list;\n        // this.readyShowList();\n\n\n      },\n    }\n  });\n\n  // 页面底部交易部分，基于原来的逻辑实现\n  // var board = $('#order_create_id').find('>.body>.right-board');\n  Vue.component('vue-trade-menu', {\n    props: [],\n    template: `\n    <div class=\"left-nav\">\n      <div class=\"trade-nav\" style=\"overflow: visible;\">\n        <div v-if=\"3 != org_info_theme && false\" class=\"trade-nav__market\" @click=\"chgCurMarket('marketA')\" v-bind:class=\"{'active': 'marketA' == curMarket}\">沪深交易A</div>\n        <div v-if=\"3 != org_info_theme && false\" class=\"trade-nav__market\" @click=\"chgCurMarket('marketH')\" v-bind:class=\"{'active': 'marketH' == curMarket}\" style=\"margin-right: 55px;\">沪港通交易H</div>\n\n        <span class=\"trade-nav__item single-buy\" v-bind:class=\"{'active': 'single-buy' == curActive, 'disabled': 'single-buy' != curActive}\">个股买入</span>\n        <span class=\"trade-nav__item single-sell\" v-bind:class=\"{'active': 'single-sell' == curActive, 'disabled': 'single-sell' != curActive}\">个股卖出</span>\n        <span class=\"trade-nav__item do_revert\" v-bind:class=\"{'active': 'do_revert' == curActive}\" @click=\"chgActive('do_revert')\">撤单<i v-if=\"displayRevertNum > 0\" class=\"trade-nav__item--tip\" v-text=\"displayRevertNum\"></i></span>\n        <div style=\"flex: 1;\"></div>\n        <a class=\"trade-nav__toggle\" @click=\"chgShowBoard()\">\n          <i class=\"nav-bar-show-icon\" v-bind:class=\"{'icon-collapse': showBoard, 'icon-spread': !showBoard}\"></i>\n        </a>\n      </div>\n    </div>\n    `,\n    data: function(){\n      return {\n        org_info_theme: window.LOGIN_INFO.org_info.theme,\n        curMarket: 'marketA',\n        curActive: 'single-buy',\n        displayRevertNum: 0,\n        showBoard: true,\n        product_list: [],\n        checked_count: 0\n      }\n    },\n    watch: {\n      checked_count: function(){\n        if (1 == this.checked_count) {\n          $('.disabled-mask').hide();\n        }else{\n          $('.disabled-mask').show();\n        }\n      },\n    },\n    methods: {\n      chgShowBoard: function(){\n        this.showBoard = !this.showBoard;\n        this.$emit('menu', {\n          curActive: this.curActive,\n          curMarket: this.curMarket,\n          showBoard: this.showBoard\n        });\n      },\n      chgCurMarket: function(curMarket){\n        // 判断是否修改，如果被修改，清空股票及价格\n        if(curMarket !== this.curMarket){\n          $('#stock_code').val('').change();\n          $(\"#val_price\").val('');\n\n          $('[click-active=\".trade_number_method-by_volume\"]').click()\n          $('#val_volume').val('');\n          if ('marketA' == curMarket) {\n            $('.order_model_limit_price').click();\n            $(\"#val_volume\").attr('placeholder', '每手100股');\n            $(\"#vale_current_volum\").attr('placeholder', '每手100股');\n          }else if ('marketH' == curMarket) {\n            $(\"#val_volume\").attr('placeholder', '');\n            $(\"#vale_current_volum\").attr('placeholder', '');\n          }\n        }\n\n        this.curMarket = curMarket;\n        this.showBoard = true;\n\n        this.$emit('menu', {\n          curActive: this.curActive,\n          curMarket: this.curMarket,\n          showBoard: this.showBoard\n        });\n      },\n      chgActive: function(val){\n        if (1 != this.checked_count && ('multi-buy' == val || 'multi-sell' == val)) {\n          $.omsAlert('多策略暂时无法使用批量下单功能！',false,1000);\n          return;\n        }\n        this.curActive = val;\n        this.showBoard = true;\n\n        var index = 0;\n        if ('single-sell' == this.curActive) {\n          index = 1;\n        }\n        $.omsUpdateLocalJsonData('etc','order_create_nav_index', index);\n\n        this.$emit('menu', {\n          curActive: this.curActive,\n          curMarket: this.curMarket,\n          showBoard: this.showBoard\n        });\n\n        tradeFlow.chgCurActive(this.curActive);\n      }\n    }\n  });\n  // 交易表单组件\n  Vue.component('vue-trade-form', {\n    props: ['cur_active'],\n    template:`\n    <form class=\"vue-trade-form\">\n      <div class=\"vue-trade-form__line\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <label class=\"vue-trade-form__label\">股票代码</label>\n        <div class=\"vue-trade-form__content\">\n          <vue-stock-search assets_class=\"e,f\" ref=\"stock-search\" :disabled=\"true\" :custom_cls=\"'trade-custom-tmp-class'\" :stock_input_id=\"stock_input_type_id\" :placeholder=\"'请输入股票代码'\" v-on:stock_id=\"chgStockId($event)\" v-on:stock_input=\"stock_input_type_id = $event\"></vue-stock-search>\n        </div>\n      </div>\n      <div class=\"vue-trade-form__line\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <label class=\"vue-trade-form__label\">报价方式</label>\n        <div class=\"vue-trade-form__content\">\n          <div class=\"vue-trade-form__content--radio\">\n            <label @click=\"chgTradeMode(1)\" class=\"vue-trade-form__content--radio-label\" v-bind:class=\"{'active': 1 == trade_model}\">\n              限价\n              <i class=\"right-icon\"></i>\n            </label>\n            <label style=\"width: 10px;\"></label>\n            <label @click=\"chgTradeMode(2)\" class=\"vue-trade-form__content--radio-label\" v-bind:class=\"{'active': 2 == trade_model}\">\n              市价\n              <i class=\"right-icon\"></i>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div class=\"vue-trade-form__line\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <label class=\"vue-trade-form__label\">价格</label>\n        <div class=\"vue-trade-form__content\">\n          <input v-if=\"1 == trade_model\" v-model=\"trade_price\" @change=\"chgTradePrice()\" class=\"vue-trade-form__content--input\" placeholder=\"请输入指令价格\" />\n          <input v-if=\"2 == trade_model\" disabled=\"disabled\" :value=\"'市价'\" @change=\"chgTradePrice()\" class=\"vue-trade-form__content--input\" placeholder=\"请输入指令价格\" />\n        </div>\n      </div>\n      <div v-if=\"false\" class=\"vue-trade-form__line\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <label class=\"vue-trade-form__label\">下单方式</label>\n        <div class=\"vue-trade-form__content\">\n          <select class=\"vue-trade-form__content--select\" v-model=\"add_ins_method\" @change=\"chgInsMethod()\">\n            <option value=\"3\">按指令数量</option>\n            <option value=\"1\">按目标仓位</option>\n            <option value=\"2\">按总资产比例</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"vue-trade-form__line\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <label class=\"vue-trade-form__label\">{{'single-buy' == cur_active ? '本次委买' : '本次委卖'}}</label>\n        <div class=\"vue-trade-form__content\">\n          <input v-model=\"trade_num\" @change=\"chgTradeNum()\" class=\"vue-trade-form__content--input\" placeholder=\"请输入数量\" />\n          <span></span>\n        </div>\n      </div>\n      <div class=\"vue-trade-form__line\" style=\"flex-direction: row-reverse;justify-content: space-between;\" v-bind:class=\"'single-buy' == cur_active ? 'buy-color-cls' : 'sell-color-cls'\">\n        <a v-bind:class=\"{'disabled': checkSubmitDisabled}\" class=\"vue-trade-form__btn\" @click=\"multiProductsSubmit()\">{{'single-buy' == cur_active ? '提交委买' : '提交委卖'}}</a>\n        <span v-show=\"showOrHide\" style=\"margin-left: 30px;margin-top:10px;line-height:28px;color:#2ECC71;\">预计{{'single-buy' == cur_active ? '买入' : '卖出'}}{{can_trade_num_total}}股</span>\n      </div>\n    </form>\n    `,\n    data: function(){\n      return {\n        stock_id: '',\n        stock_input_type_id: '',\n        trade_model: 1,\n        trade_price: '',\n        trade_num: '',\n        showOrHide: false,\n        can_trade_num_total: 0,\n        add_ins_method: 3, // 1按目标仓位 2按总资产比例 3按指令数量\n        checkSubmitDisabled: true,\n      }\n    },\n    mounted: function(){\n      // 接收从五档行情触发的事件\n      $(window).on('trade-5__priceClick', (event) => {\n        this.trade_price = event.price;\n        this.chgTradePrice();\n      })\n    },\n    methods: {\n      setPriceAndAmount: function(price, volume){\n        this.trade_price = price;\n        this.trade_num = volume;\n        this.chgTradePrice();\n        this.chgTradeNum();\n      },\n      setCheckSubmitDisabled: function(value){\n        this.checkSubmitDisabled = value;\n      },\n      setTotalInfo: function(obj){\n        this.showOrHide = obj.showOrHide;\n        this.can_trade_num_total = obj.trade_num;\n      },\n      setFormData: function(obj){\n        // this.stock_id = obj.stock_id;\n        this.$refs['stock-search'].selectOneStock(obj.stock_id, obj.stock_name);\n        this.trade_model = obj.trade_mode;\n        this.trade_price = obj.trade_price;\n        this.trade_num = obj.trade_num;\n        // this.chgStockId(obj.stock_id);\n        // console.log(this.stock_id);\n      },\n      chgStockId: function(event){\n        this.stock_id = event;\n        this.$emit('stock_id', this.stock_id);\n        // tradeFlow.chgStockId(this.stock_id);\n      },\n      chgTradeMode: function(val){\n        this.trade_model = val;\n        tradeFlow.chgTradeMode(this.trade_model);\n      },\n      chgTradePrice: function(){\n        tradeFlow.chgTradePrice(this.trade_price);\n      },\n      chgInsMethod: function(){\n        tradeFlow.chgInsMethod(this.add_ins_method);\n      },\n      chgTradeNum: function(){\n        tradeFlow.chgTradeNum(this.trade_num);\n      },\n      multiProductsSubmit: function(){\n        // console.log('multiProductsSubmit')\n        if (this.checkSubmitDisabled) {\n          return false;\n        }\n        tradeControllor.$refs['trade-preview'].multiProductsSubmit();\n      }\n    }\n  });\n\n  Vue.component('vue-trade-5', {\n    mixins: [numberMixin, colorMixin],\n    props: ['stock_id', 'cur_active'],\n    template: `\n      <div class=\"vue-trade-5\">\n        <div class=\"vue-trade-5__high-low\">\n          <h1 class=\"loading-loading\" :class=\"{'trade-loading': true == is_loading}\" style=\"position: relative;\">\n            <span class=\"code\">{{ajaxStockDetail.stock_code}}</span><br/>\n            <span>{{ajaxStockDetail.stock_name}}</span>\n          </h1>\n          <div class=\"loading-loading vue-trade-5__main-info\">\n            <b @click=\"priceClick(ajaxStockDetail.last_price)\" style=\"cursor: pointer;\" class=\"vue-trade-5__main-info--last-price\" v-bind:class=\"rmgColor(ajaxStockDetail.last_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.last_price, 3)}}</b>\n            <span class=\"vue-trade-5__main-info--span\" v-bind:class=\"rmgColor(ajaxStockDetail.change, '0')\">{{numeralNumber(ajaxStockDetail.change, 3)}}</span>\n            <span class=\"vue-trade-5__main-info--span\" v-bind:class=\"rmgColor(ajaxStockDetail.change_ratio, '0')\">{{numeralPercent(ajaxStockDetail.change_ratio, 3)}}</span>\n          </div>\n          <div class=\"vue-trade-5__bd\">\n            <p>\n              今开：<span @click=\"priceClick(ajaxStockDetail.open_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.open_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.open_price, 3)}}</span><br/>\n              昨收：<span @click=\"priceClick(ajaxStockDetail.prev_close_price)\" style=\"cursor: pointer;\">{{numeralNumber(ajaxStockDetail.prev_close_price, 3)}}</span>\n            </p>\n            <p>\n              最高：<span @click=\"priceClick(ajaxStockDetail.high_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.high_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.high_price, 3)}}</span><br/>\n              最低：<span @click=\"priceClick(ajaxStockDetail.low_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.low_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.low_price, 3)}}</span>\n            </p>\n            <p>\n              涨停：<span @click=\"priceClick(ajaxStockDetail.stop_top)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.stop_top, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.stop_top, 3)}}</span><br/>\n              跌停：<span @click=\"priceClick(ajaxStockDetail.stop_down)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.stop_down, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.stop_down, 3)}}</span>\n            </p>\n          </div>\n        </div>\n        <div class=\"vue-trade-5__ask-bid\">\n          <div class=\"ask-bid__trade-tip\" v-bind:class=\"{'hide': !showTipFlag || 0 == Object.keys(ajaxStockDetail).length}\" v-bind:style=\"getStyle()\">\n            {{getTipStr()}}\n          </div>\n          <table style=\"width: 100%;\">\n            <tbody>\n              <tr @click=\"setPriceAndAmount('single-buy', 5)\" @mouseover=\"showTip('forSell', 5)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-buy' == cur_active && index >= 5 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>卖5</td>\n                <td @click=\"priceClick(ajaxStockDetail.ask5_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.ask5_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.ask5_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.ask5_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-buy', 4)\" @mouseover=\"showTip('forSell', 4)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-buy' == cur_active && index >= 4 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>卖4</td>\n                <td @click=\"priceClick(ajaxStockDetail.ask4_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.ask4_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.ask4_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.ask4_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-buy', 3)\" @mouseover=\"showTip('forSell', 3)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-buy' == cur_active && index >= 3 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>卖3</td>\n                <td @click=\"priceClick(ajaxStockDetail.ask3_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.ask3_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.ask3_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.ask3_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-buy', 2)\" @mouseover=\"showTip('forSell', 2)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-buy' == cur_active && index >= 2 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>卖2</td>\n                <td @click=\"priceClick(ajaxStockDetail.ask2_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.ask2_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.ask2_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.ask2_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-buy', 1)\" @mouseover=\"showTip('forSell', 1)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-buy' == cur_active && index >= 1 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>卖1</td>\n                <td @click=\"priceClick(ajaxStockDetail.ask1_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.ask1_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.ask1_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.ask1_volume, 0)}}</td>\n              </tr>\n              <tr class=\"blank-tr\" style=\"height: 2px;line-height: 2px;\"><td>&nbsp;</td></tr>\n            </tbody>\n            <tbody><tr class=\"hr-tr\" style=\"height: 2px!important;line-height: 2px!important;border-top: 1px solid #f2f2f2;\"><td colspan=\"3\" class=\"hr\"></td></tr></tbody>\n            <tbody>\n              <tr @click=\"setPriceAndAmount('single-sell', 1)\" @mouseover=\"showTip('forBuy', 1)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-sell' == cur_active && index >= 1 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>买1</td>\n                <td @click=\"priceClick(ajaxStockDetail.bid1_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.bid1_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.bid1_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.bid1_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-sell', 2)\" @mouseover=\"showTip('forBuy', 2)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-sell' == cur_active && index >= 2 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>买2</td>\n                <td @click=\"priceClick(ajaxStockDetail.bid2_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.bid2_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.bid2_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.bid2_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-sell', 3)\" @mouseover=\"showTip('forBuy', 3)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-sell' == cur_active && index >= 3 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>买3</td>\n                <td @click=\"priceClick(ajaxStockDetail.bid3_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.bid3_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.bid3_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.bid3_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-sell', 4)\" @mouseover=\"showTip('forBuy', 4)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-sell' == cur_active && index >= 4 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>买4</td>\n                <td @click=\"priceClick(ajaxStockDetail.bid4_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.bid4_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.bid4_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.bid3_volume, 0)}}</td>\n              </tr>\n              <tr @click=\"setPriceAndAmount('single-sell', 5)\" @mouseover=\"showTip('forBuy', 5)\" @mouseout=\"hideTip()\" v-bind:class=\"{'mouseover': 'single-sell' == cur_active && index >= 5 && showTipFlag && 0 != Object.keys(ajaxStockDetail).length}\">\n                <td>买5</td>\n                <td @click=\"priceClick(ajaxStockDetail.bid5_price)\" style=\"cursor: pointer;\" v-bind:class=\"rmgColor(ajaxStockDetail.bid5_price, ajaxStockDetail.prev_close_price)\">{{numeralNumber(ajaxStockDetail.bid5_price, 3)}}</td>\n                <td>{{numeralNumber(ajaxStockDetail.bid4_volume, 0)}}</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    `,\n    data: function(){\n      return {\n        ajaxStockDetail: {},\n        showTipFlag: false,\n        index: 1,\n        tag: '',\n        price: '0.00',\n        volume: 100,\n        ajaxTimes: 0,\n        loadInterval: '',\n        is_loading: false\n      }\n    },\n    watch: {\n      stock_id: function(){\n        let _this = this;\n        this.ajaxTimes = 0;\n        this.loadData();\n        clearInterval(this.loadInterval);\n        this.loadInterval = setInterval(function(){\n          _this.loadData();\n        }, 5000)\n      }\n    },\n    methods: {\n      setPriceAndAmount: function(str, index){\n        // 此处的判断条件与显示mouseover样式的条件类似\n        if (str == this.cur_active && this.index >= index && this.showTipFlag && 0 != Object.keys(this.ajaxStockDetail).length) {\n          let indexCopy = index;\n          let price;\n          let volume = 0;\n          if ('single-buy' == this.cur_active) {\n            price = Number(this.numeralNumber(this.ajaxStockDetail['ask'+ index +'_price'], 3));\n            while(indexCopy > 0){\n              volume += Number(this.ajaxStockDetail['ask'+ indexCopy +'_volume']);\n              indexCopy -= 1;\n            }\n          }\n          if ('single-sell' == this.cur_active) {\n            price = Number(this.numeralNumber(this.ajaxStockDetail['bid'+ index +'_price'], 3));\n            while(indexCopy > 0){\n              volume += Number(this.ajaxStockDetail['bid'+ indexCopy +'_volume']);\n              indexCopy -= 1;\n            }\n          }\n          volume = Math.floor(volume / this.ajaxStockDetail.trading_unit) * this.ajaxStockDetail.trading_unit;\n\n          tradeControllor.$refs['trade-form'].setPriceAndAmount(price, volume);\n        }\n      },\n      getTipStr: function(){\n        let index = this.index;\n        let indexCopy = index;\n        if ('single-buy' == this.cur_active) {\n          let price = Number(this.numeralNumber(this.ajaxStockDetail['ask'+ index +'_price'], 3));\n          let volume = 0;\n          while(indexCopy > 0){\n            volume += Number(this.ajaxStockDetail['ask'+ indexCopy +'_volume']);\n            indexCopy -= 1;\n          }\n          volume = Math.floor(volume / this.ajaxStockDetail.trading_unit) * this.ajaxStockDetail.trading_unit;\n          return `点击卖${index}则自动将价格设置为卖${index}价${price}，本次委买数量设为${volume}股(卖1-${index}的总挂单量）`;\n        }\n        if ('single-sell' == this.cur_active) {\n          let price = Number(this.numeralNumber(this.ajaxStockDetail['bid'+ index +'_price'], 3));\n          let volume = 0;\n          while(indexCopy > 0){\n            volume += Number(this.ajaxStockDetail['bid'+ indexCopy +'_volume']);\n            indexCopy -= 1;\n          }\n          volume = Math.floor(volume / this.ajaxStockDetail.trading_unit) * this.ajaxStockDetail.trading_unit;\n          return `点击买${index}则自动将价格设置为买${index}价${price}，本次委卖数量设为${volume}股(买1-${index}的总挂单量）`;\n        }\n      },\n      getStyle: function(){\n        if ('forSell' == this.tag) {\n          return 'top: ' + (80 - 10 * (this.index - 1)) + 'px;';\n        }else if('forBuy' == this.tag){\n          return 'top: ' + (100 + 10 * (this.index - 1)) + 'px;';\n        }\n        return '';\n      },\n      showTip: function(tag, index){\n        this.tag = tag;\n\n        if ('forSell' == this.tag && 'single-buy' == this.cur_active) {\n          this.index = index;\n          this.showTipFlag = true;\n        }else if('forBuy' == this.tag && 'single-sell' == this.cur_active){\n          this.index = index;\n          this.showTipFlag = true;\n        }else{\n          this.showTipFlag = false;\n        }\n\n      },\n      hideTip: function(){\n        this.showTipFlag = false;\n      },\n      priceClick: function(val){\n        // 触发事件，修改表单的价格\n        $(window).trigger({\n          type: 'trade-5__priceClick',\n          price: val\n        })\n      },\n      loadData: function(){\n        let _this = this;\n        if ('' == this.stock_id) {\n          _this.ajaxStockDetail = {};\n          return;\n        }\n        var tmpStockId = this.stock_id;\n        this.is_loading = true;\n        commonAjax( (window.REQUEST_PREFIX||'')+\"/oms/helper/stock_detail?stock_id=\"+ this.stock_id ).then(function({code, msg, data}){\n          if (0 == code) {\n            if (tmpStockId != _this.stock_id) {\n              return;\n            }\n            _this.ajaxTimes++;\n\n            _this.ajaxStockDetail = data[0];\n            tradeFlow.shgStockDetail(_this.ajaxStockDetail);\n\n            if (1 == _this.ajaxTimes) {\n              $(window).trigger({\n                type: 'trade-5__firstTime_price',\n                ask1_price: _this.ajaxStockDetail.ask1_price,\n                bid1_price: _this.ajaxStockDetail.bid1_price,\n              })\n            }\n          }else if(1 == code){\n            // 旧的逻辑，错误码为1，不提示。\n          }else{\n            $.omsAlert(msg);\n          }\n          _this.is_loading = false;\n        }).catch(function(err){\n          $.omsAlert(err);\n        });\n      }\n    }\n  })\n\n  // 撤单模块\n  var query_arr = [{\n    id: 'revert',\n    uri: window.REQUEST_PREFIX + '/oms/order/getCanBeCanceledList?permission_type=product&type=all&count=9999',\n    gridDataStr: 'revertGrid',\n    display_rules: [{\n      id: 'stock_id',\n      label: '证券代码',\n      withMultiIcon: true,\n      withStockType: true,\n      format: ['hideStockType'],\n      class: ''\n    },{\n      id: 'stock_name',\n      label: '证券名称',\n      format: '',\n      class: 'cell-left'\n    },{\n      // 专户版买卖标志\n      id: 'entrust_type',\n      label: '买卖标志',\n      hide_flag: (3 == orginfo_theme) ? false : true,\n      format: ['entrustTypeCH'],\n      classFormat: ['entrustTypeClass'],\n      class: 'cell-left'\n    },{\n      // 机构版买卖标志\n      id: 'bs_symbol_text',\n      label: '买卖标志',\n      hide_flag: (3 == orginfo_theme) ? true : false,\n      class: 'cell-left'\n    },{\n      id: 'product_name',\n      label: '策略',\n      format: '',\n      class: 'cell-left'\n    },{\n      id: 'entrust_price',\n      label: '委托价格',\n      format: ['numeralNumber', 3],\n      class: 'cell-right'\n    },{\n      id: 'entrust_amount',\n      label: '委托数量',\n      format: '',\n      class: 'cell-right'\n    },{\n      id: 'deal_price',\n      label: '成交价格',\n      format: ['numeralNumber', 3],\n      class: 'cell-right'\n    },{\n      id: 'deal_amount',\n      label: '成交数量',\n      format: '',\n      class: 'cell-right'\n    },{\n      // 专户版订单状态\n      id: 'status',\n      label: '订单状态',\n      hide_flag: (3 == orginfo_theme) ? false : true,\n      format: ['statusCH'],\n      classFormat: ['statusClass'],\n      class: 'cell-left'\n    },{\n      // 机构版订单状态\n      id: 'vendor_status_text',\n      label: '订单状态',\n      hide_flag: (3 == orginfo_theme) ? true : false,\n      // format: ['statusCH'],\n      // classFormat: ['statusClass'],\n      class: 'cell-left'\n    },{\n      // 专户版报价方式\n      id: 'entrust_model',\n      label: '报价方式',\n      hide_flag: (3 == orginfo_theme) ? false : true,\n      format: ['entrustModelType'],\n      class: 'cell-left'\n    },{\n      // 机构版报价方式\n      id: 'quote_type_text',\n      label: '报价方式',\n      hide_flag: (3 == orginfo_theme) ? true : false,\n      class: 'cell-left'\n    // },{\n    //   id: 'created_at',\n    //   label: '委托时间',\n    //   format: ['unixTime'],\n    //   class: 'cell-right'\n    // },{\n    //   id: 'updated_at',\n    //   label: '更新时间',\n    //   format: ['unixTime'],\n    //   class: 'cell-right'\n\n    // },{\n    //   // 机构版 港股 字段\n    //   id: 'exchange_rate',\n    //   label: '参考汇率',\n    //   hide_flag: (3 == orginfo_theme) ? true : false,\n    //   doHideWhenMarketA: true,\n    //   format: '',\n    //   class: 'cell-left'\n    }]\n  }];\n  Vue.component('vue-trade-revert', {\n    // el: '#do_revert',\n    template: `\n      <section class=\"order-list new-design\" style=\"min-height: 245px; max-height: 400px; overflow: auto;margin: 0;\">\n        <a id=\"anchor-orderList\" style=\"position: relative;top:-65px;display: block;height: 0;width:0;\"></a>\n        <div class=\"hd\">\n          <span class=\"section-title\" style=\"font-size: 16px; color: #222222;\">可撤订单</span>\n          <a class=\"oms-btn gray refresh-btn loading-loading right\" v-bind:class=\"{'loading': loadingNum > 0}\" href=\"javascript:;\" v-on:click=\"loadOrderList\"><i class=\"oms-icon refresh\"></i>刷新</a>\n          <a class=\"oms-btn red revert-btn  right\" href=\"javascript:;\" v-on:click=\"doRevert\">撤单</a>\n        </div>\n        <div style=\"max-height: 193px;overflow: auto;\">\n          <table class=\"oms-table loading-loading nothing-nothing\" v-bind:class=\"{'nothing': Object.keys(temporary_order).length == 0 && activeGridList.length == 0}\">\n            <tbody>\n              <tr>\n                <th style=\"width: 40px;\">\n                  <input type=\"checkbox\" v-model=\"selectAll\" v-on:change=\"chgSelectAll()\" />\n                </th>\n                <th v-if=\"rule.hide_flag != true\" v-show=\"rule.doHideWhenMarketA != true || 'marketA' != market\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                  <span v-text=\"rule.label\"></span>\n                </th>\n              </tr>\n            </tbody>\n            <tbody>\n              <tr v-if=\"Object.keys(temporary_order).length > 0\">\n                <td>\n                  <input :disabled=\"checkDisabled(temporary_order)\" type=\"checkbox\" v-model=\"temporary_order.web_checked\" v-on:change=\"chgSelect(temporary_order)\" />\n                </td>\n                <td v-on:click=\"changeShow(temporary_order)\" v-if=\"rule.hide_flag != true\" v-show=\"rule.doHideWhenMarketA != true || 'marketA' != market\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                  <span v-bind:class=\"displayClass(temporary_order, rule)\" v-text=\"displayValue(temporary_order, rule)\"></span>\n                  <div v-if=\"rule.withMultiIcon && temporary_order.is_batch\" v-bind:class=\"{'icon-show': temporary_order.web_showChildren, 'icon-hide': !temporary_order.web_showChildren}\">\n                  </div>\n                </td>\n              </tr>\n              <tr v-for=\"row in activeGridList\" v-show=\"checkShow(row)\" v-bind:class=\"{'sub_order': row.is_sub, 'display_multi': row.web_showChildren}\">\n                <td>\n                  <input :disabled=\"checkDisabled(row)\" type=\"checkbox\" v-model=\"row.web_checked\" v-on:change=\"chgSelect(row)\" />\n                </td>\n                <td v-on:click=\"changeShow(row)\" v-if=\"rule.hide_flag != true\" v-show=\"rule.doHideWhenMarketA != true || 'marketA' != market\" v-for=\"rule in curQueryInfo.display_rules\" v-bind:class=\"rule.class\">\n                  <span v-bind:class=\"displayClass(row, rule)\" v-text=\"displayValue(row, rule)\"></span>\n                  <div v-if=\"rule.withMultiIcon && row.is_batch\" v-bind:class=\"{'icon-show': row.web_showChildren, 'icon-hide': !row.web_showChildren}\" ></div>\n                  <span v-if=\"rule.withStockType && (3 == checkStockType(row[rule.id]) || 4 == checkStockType(row[rule.id]))\" v-bind:class=\"displayStockClass(row, rule)\">\n                    @{{ displayStockType(row[rule.id]) }}\n                  </span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </section>\n    `,\n    mounted: function(){\n      // 可撤单获取数据\n      this.loadOrderList();\n    },\n    data(){\n      return {\n        // doShow: false,\n        me_can_trade: true,\n        gridData: [],\n        curActive: 'revert',\n        market: 'marketA',\n\n        selectAll: false,\n        selectList: new Map(),\n\n        orginfo_theme: orginfo_theme,\n        temporary_order: {},\n\n        hideRevert: false,\n        hideDeal: false,\n        hideIssue: false,\n\n        revertGrid: {},\n        revertGrid_midGridList: [],\n        query_arr: query_arr,\n        orderNum: 0,\n        // last_loading_timestamp: '',\n        loadingNum: 0\n      }\n    },\n    watch: {\n    },\n    computed: {\n      activeGridList: function(){\n        if ('revert' == this.curActive) {\n          this.selectAll = this.revertGridList.every(function(e){\n            return e.web_checked == true;\n          });\n          return this.revertGridList;\n        }\n      },\n      curQueryInfo: function(){\n        var _this = this;\n        var rtn = {};\n        this.query_arr.forEach(function(e){\n          if (e.id == _this.curActive) {\n            rtn = e;\n          }\n        });\n        return rtn;\n      },\n      revertGridList: function(){\n        var str = 'revertGrid';\n        var rtn = this[str + '_midGridList'];\n        var show_batchs = [];\n\n        rtn.forEach(function(e){\n          if (e.is_batch) {\n            show_batchs.push(e);\n          }\n        });\n\n        // 处理决定是否勾选的数据\n        show_batchs.forEach(function(e){\n          if (e.orders.every(function(el){\n            return el.web_checked == true;\n          }) == true) {\n            e.web_checked = true;\n          }else{\n            e.web_checked = false;\n          }\n        })\n\n        // 处理决定是否显示的数据\n        rtn.forEach(function(el){\n          el.do_hide = false;\n        });\n        show_batchs.forEach(function(e){\n          if (!e.web_showChildren) {\n            rtn.forEach(function(el){\n              if (el.batch_no == '' || true == el.is_batch || e.batch_no != el.batch_no) {\n                // el.do_hide = false; //不能设置为false，因为有些本来设置为true的又被修改为false\n              }else{\n                el.do_hide = true;\n              }\n            })\n          }\n        })\n        return rtn;\n      }\n    },\n    methods: {\n      hideStockType: function(val){\n        return val.split(/\\./)[0];\n      },\n      checkStockType: function(value){\n        if (/\\.sh/.test(value.toLowerCase())) {\n          return 1;\n        }\n        if (/\\.sz/.test(value.toLowerCase())) {\n          return 2;\n        }\n        if (/\\.hksh/.test(value.toLowerCase())) {\n          return 3;\n        }\n        if (/\\.hksz/.test(value.toLowerCase())) {\n          return 4;\n        }\n      },\n      displayStockClass: function(row, rule){\n        var value = row[rule.id];\n        var type = this.checkStockType(value);\n        if (3 == type) {\n          return 'stock-type-hksh';\n        }\n        if (4 == type) {\n          return 'stock-type-hksz'\n        }\n      },\n      displayStockType: function(value){\n        var type = this.checkStockType(value);\n        if (3 == type) {\n          return '沪港通'\n        }\n        if (4 == type) {\n          return '深港通'\n        }\n      },\n      changeShow: function(row){\n        if (row.is_batch) {\n          row.web_showChildren = !row.web_showChildren;\n        }\n      },\n      checkDisabled: function(row){\n        return (this.statusClass(row) !== 'red' || 6 == row.status || 8 == row.status || 105 == row.status || 108 == row.status) ? true : false\n      },\n      checkShow: function(row){\n        if (row.do_hide) {\n          return false;\n        }\n        if (row.status == 7 && this.hideRevert) {\n          return false;\n        }\n        // if ((row.status == 5 || row.status == 105) && this.hideDeal) {\n        //   return false;\n        // }\n        if ((this.isFinish(row) && row.status != 7 && row.status != 8) && this.hideDeal) {\n          return false;\n        }\n        if (row.status == 8 && this.hideIssue) {\n          return false;\n        }\n\n        return true;\n      },\n      doRevert: function(){\n        var _this = this;\n        var doRevertArr = [];\n        var htmlArr = [];\n        this.activeGridList.forEach(function(e){\n          if (e.is_batch != true && e.web_checked && !(+e.cancel_status) && [1,2,4].some(function(el){\n            return el == e.status\n          })) {\n            doRevertArr.push(e);\n\n            htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left\">' + e.product_name + '</td>' +\n              '<td class=\"cell-left\">' + e.stock_id + ' ' + e.stock_name + '</td>' +\n              '<td class=\"cell-left\">' + e.bs_symbol_text + '</td>' +\n              '<td class=\"cell-left\">' + e.quote_type_text + '</td>'+\n              '<td class=\"cell-right\">' + e.entrust_price + '</td>' +\n              '<td class=\"cell-right\">' + e.entrust_amount + '</td></tr>');\n\n          }\n        });\n\n        if (doRevertArr.length == 0) {\n          $.omsAlert('请选择需要撤单的订单');\n          return;\n        }\n\n        var html = htmlArr.join('');\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\"><tr><th class=\"cell-left\">策略</th>'+\n          '<th class=\"cell-left\">证券</th>'+\n          '<th class=\"cell-left\">买卖标志</th>'+\n          '<th class=\"cell-left\">报价方式</th>'+\n          '<th class=\"cell-right\">委托价格</th>'+\n          '<th class=\"cell-right\">委托数量(股)</th></tr>'+html+'</tbody></table>';\n\n        $.confirm({\n          title: '撤单确认',\n          content: confirmHtml,\n          closeIcon: true,\n          confirmButton: '确定',\n          cancelButton: false,\n          confirm: function(){\n            var results = [];\n\n            $.startLoading('正在批量撤单...');\n            doRevertArr.forEach(function(order){\n              order.cancel_res = null;\n              results.push(order);\n              setTimeout(function(){\n                var url = (window.REQUEST_PREFIX||'')+'/oms/workflow/'+order.product_id+'/'+order.id +'/do_cancel?workflow_id=' + order.id;\n\n                if (3 != _this.orginfo_theme) {\n                  url = (window.REQUEST_PREFIX||'')+'/oms/workflow/' + order.product_id + '/direct_cancel?entrust_id=' + order.entrust_id + '&stock_id=' + order.stock_code;\n                  if ('marketA' == market) {\n                    url += '&market=1';\n                  }else if('marketHSH' == market){\n                    url += '&market=2';\n                  }else if('marketHSZ' == market){\n                    url += '&market=3';\n                  }\n                }\n\n                $.post(url).done(function(res){\n                  order.cancel_res = res;\n                }).fail(function(){\n                  order.cancel_res = {code:110,msg:'网络错误！'};\n                }).always(function(){\n                  _this.checkResults(results);\n                });\n              },Math.random()*500);\n            });\n\n          }\n        });\n      },\n      checkResults: function(results){\n        var _this = this;\n        var waiting_num = results.filter(function(order){\n            return !order.cancel_res;\n        }).length;\n        if(waiting_num){return;}\n\n        var filter_res = {success:[],fail:[]};\n        results.forEach(function(order){\n            filter_res[$.pullValue(order,'cancel_res.code',NaN) == 0 ? 'success' : 'fail'].push(order);\n        });\n\n        $(window).trigger({\n          type: 'multi_products:create_order:finish'\n        });\n\n        var htmlArr = [];\n        filter_res.fail.forEach(function(e){\n          htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left max-width-120\" title=\"'+ e.product_name +'\">' + e.product_name + '</td>' +\n            '<td class=\"cell-left\">' + e.stock_id + ' ' + e.stock_name + '</td>' +\n            '<td class=\"cell-left\">' + _this.entrustTypeCH(e.entrust_type) + '</td>' +\n            '<td class=\"cell-right\">' + e.entrust_price + '</td>' +\n            '<td class=\"cell-right\">' + e.entrust_amount + '</td>' +\n            '<td>' + e.cancel_res.msg + '</td>' +\n            '</tr>');\n        });\n\n        var html = htmlArr.join('');\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\">'+\n          '<tr>'+\n          '<th class=\"min-width-40 max-width-120 cell-left\">策略</th>'+\n          '<th class=\"min-width-40 cell-left\">证券</th>'+\n          '<th class=\"min-width-40 cell-left\">买卖标志</th>'+\n          '<th class=\"min-width-40 cell-right\">委托价格</th>'+\n          '<th class=\"min-width-40 cell-right\">委托数量(股)</th>'+\n          '<th class=\"min-width-40 cell-right\">备注</th>' +\n          '</tr>'+html+'</tbody></table>';\n\n        $.clearLoading();\n\n        if (filter_res.fail.length == 0) {\n          $.omsAlert('撤单请求提交成功');\n          instructionExecutePage.$refs['instruction-execute'].loadManageList();\n          instructionExecutePage.$refs['order-list'].loadOrderList();\n          setTimeout(function(){\n            instructionExecutePage.$refs['order-list'].loadOrderList();\n          }, 2000);\n        }else{\n          $.confirm({\n            title: '失败提示',\n            content: confirmHtml,\n            closeIcon: true,\n            confirmButton: '确定',\n            cancelButton: false\n          });\n        }\n\n        setTimeout(function(){\n          _this.loadOrderList();\n        });\n        setTimeout(function(){\n            _this.loadOrderList();\n        }, 2000);\n      },\n      chgSelect: function(row){\n        var _this = this;\n        if (row.is_batch) {\n          // 修改批量的选中框之后，修改其子项的选中框\n          row.orders.forEach(function(e){\n            e.web_checked = row.web_checked;\n          })\n        }\n      },\n      chgSelectAll: function(){\n        var _this = this;\n        // this.selectAll = !this.selectAll;\n        this.activeGridList.forEach(function(e){\n          e.web_checked = _this.selectAll;\n        })\n      },\n      getGridList: function(str){\n        let _this = this;\n        var rtn = [];\n\n        this.temporary_order = {};\n\n        this[str].list.forEach(function(e){\n          var obj = {};\n          obj.web_checked = false;\n          if (_this.selectList.get(e.entrust_id)) {\n            obj.web_checked = true;\n          }\n          // 批量处理序号\n          obj.batch_no = e.entrust.batch_no;\n          // 证券代码\n          // obj.stock_id = e.stock_info ? e.stock_info.stock_id : '';\n          obj.stock_id = ('' == e.stock.code) ? (e.stock_info ? e.stock_info.stock_id : '') : e.stock.code;\n          // 机构版撤单id，仅revert表格使用\n          obj.entrust_id = e.entrust_id;\n          // 机构版股票代码，仅revert表格使用\n          obj.stock_code = e.stock ? e.stock.code : '';\n          // 证券名称\n          obj.stock_name = ('' == e.stock.name) ? (e.stock_info ? e.stock_info.stock_name : '') : e.stock.name;\n          // 买卖标志\n          obj.entrust_type = e.entrust.type;\n          // 策略\n          obj.product_name = e.product ? e.product.name : '';\n          // 委托价格\n          obj.entrust_price = e.entrust.price;\n          // 委托数量\n          obj.entrust_amount = e.entrust.amount;\n          // 成交价格\n          obj.deal_price = e.deal.price;\n          // 成交数量\n          obj.deal_amount = e.deal.amount;\n          // 已撤数量\n          // 原有接口找不到该字段，暂时不加\n          // 订单状态\n          obj.status = e.status;\n          // 报价方式\n          obj.entrust_model = e.entrust.model;\n          // 委托时间\n          obj.created_at = e.created_at;\n          // 更新时间 //在已成交的订单中，这就是成交时间\n          obj.updated_at = e.updated_at;\n\n          obj.cancel_status = e.cancel_status;\n          obj.id = e.id;\n          obj.product_id = e.product_id;\n\n          // 汇率\n          obj.exchange_rate = e.entrust.exchange_rate;\n          // 买卖方向\n          obj.bs_symbol_text = e.entrust.bs_symbol_text;\n          // 报价方式\n          obj.quote_type_text = e.entrust.quote_type_text;\n          // 订单状态\n          obj.vendor_status_text = e.entrust.vendor_status_text;\n\n          rtn.push(obj);\n        });\n\n        var batch_orders = {};\n        rtn.forEach(function(e){\n          if (e.batch_no) {\n            e.sub_order = e.batch_no;\n            (batch_orders[e.batch_no] = batch_orders[e.batch_no] || []).push(e);\n          }\n        });\n\n        rtn = rtn.sort(function(a, b){\n          // return a.batch_no < b.batch_no ? 1 : -1;\n          return a.created_at < b.created_at ? 1 : -1;\n        })\n\n        var show_batchs = [];\n        for(var batch_no in batch_orders){\n          if (batch_orders[batch_no].length>1) {\n\n          }\n          // 得到批量的显示内容\n          var first_order = batch_orders[batch_no].sort(function(o1,o2){\n            return o1.updated_at>o2.updated_at ? 1 : -1;\n          })[0];\n\n          // todo 这里的参数格式要变一下\n          var batch = {\n            is_batch: true,\n\n            web_checked: false,\n            web_showChildren: false,\n\n            batch_no: first_order.batch_no,\n            updated_at: first_order.updated_at,\n            created_at: first_order.created_at,\n\n            orders: batch_orders[batch_no],\n\n            // 证券代码\n            stock_id : first_order.stock_id,\n            // 证券名称\n            stock_name : first_order.stock_name,\n            // 买卖标志\n            entrust_type : first_order.entrust_type,\n            // 策略\n            product_name : '多策略',//first_order.product_name,\n            // 委托价格\n            entrust_price : first_order.entrust_price,\n            // 委托数量\n            entrust_amount : 0, // first_order.entrust_amount,\n            // 成交价格\n            deal_price : 0, //first_order.deal_price,\n            deal_value : 0, //first_order.deal_value,\n            // 成交数量\n            deal_amount : 0, //first_order.deal_amount,\n            // 已撤数量\n            // 原有接口找不到该字段，暂时不加\n            // 订单状态\n            status : 0, //first_order.status,\n            // 报价方式\n            entrust_model : first_order.entrust_model,\n            // 委托时间\n            created_at : first_order.created_at,\n            // 更新时间 //在已成交的订单中，这就是成交时间\n            updated_at : first_order.updated_at,\n\n            product: {\n                name: '多策略',\n                length: batch_orders[batch_no].length\n            },\n\n            all_status: [],\n\n            cancel_status: \"\",\n            all_cancel_status: [],\n            can_cancel: false,\n\n            all_finish_status: []//,\n\n            // me_can_trade: first_order.me_can_trade\n          };\n\n          batch_orders[batch_no].forEach(function(order){\n            var deal_price = +$.pullValue(order,'deal_price')||0;\n            var deal_amount = +$.pullValue(order,'deal_amount')||0;\n            var deal_value = deal_price*deal_amount;\n\n            // $.pushValue(order,'deal_value',deal_value);\n            batch.deal_value += deal_value;\n            batch.deal_amount += deal_amount;\n            batch.deal_price = batch.deal_amount ? batch.deal_value/batch.deal_amount : 0;\n\n            var entrust_amount = +$.pullValue(order,'entrust_amount')||0;\n            batch.entrust_amount += entrust_amount;\n\n            batch.all_status.push(+order.status||0);\n            batch.all_cancel_status.push(+order.cancel_status||0);\n\n            order.can_cancel = /1|2|4/.test( order.status ) && !/1|2/.test( order.cancel_status );\n\n            order.is_finish = _this.isFinish(order);\n            batch.all_finish_status.push(order.is_finish?1:0);\n\n            //########## 断定是否可以撤单\n            batch.can_cancel = batch.can_cancel || order.can_cancel;\n          });\n\n          //########### Batch 状态处理\n          // 这里for循环最终执行的条件似乎是：all_status是全为一个数字元素的数组。比如说：[1,1,1,1,1,1,1]\n          [1,2,3,4,5,6,7,8,9].forEach(function(status_no){\n            batch.all_status.filter(function(status){return status==status_no}).length == batch.all_status.length && (batch.status = status_no);\n          });\n          // 这里for循环最终执行的条件似乎是：all_cancel_status是全为一个数字元素的数组。\n          [1,2].forEach(function(cancel_status_no){\n            batch.all_cancel_status.filter(function(cancel_status){\n              return cancel_status==cancel_status_no\n            }).length == batch.all_cancel_status.length && (batch.cancel_status = cancel_status_no);\n          });\n\n          // 多策略状态展示逻辑遵守单策略订单状态显示逻辑\n          // 以已完成、已完成（有废单）、未完成描述策略订单状态。\n          // 1、当策略订单中有待完成的订单时：委托、部分成交、等待撤单等，显示未完成。\n          // 2、当策略订单中所有订单操作时：全部成交、全部撤单显示已完成；\n          // 3、当策略中有废单，其余订单全部完成时，显示：已完成（有废单）\n\n          // 这里的枚举实在是不清楚什么含义\n          if(!batch.status){\n            batch.status = /0/.test( batch.all_finish_status.join('') ) ? 101 : (\n              /8/.test( batch.all_status.join('') ) ? 108 : 105\n            );\n          }\n\n          show_batchs.push(batch);\n        }\n\n        // 这里实际上也包含了只有一个元素的带有batch_no的数据列，在随后的插入数据操作中注意过滤\n        show_batchs = show_batchs.filter(function(e){\n          return e.orders.length > 1;\n        });\n\n        show_batchs.forEach(function(e){\n          var batch_no = e.batch_no;\n          var index = rtn.findIndex(function(el){\n            return el.batch_no == batch_no;\n          });\n          e.orders.forEach(function(el){\n            el.is_sub = true;\n          });\n          rtn.splice(index, 0, e);\n        });\n\n        // this[str + '_midGridList'] = [];\n        this[str + '_midGridList'] = rtn;\n      },\n      // 判断是否已经结束\n      isFinish: function(order){\n          if( order.status == 3 ){ return true; }\n          if( order.status == 5 ){ return true; }\n          if( order.status == 7 ){ return true; }\n          if( order.status == 8 ){ return true; }\n          if( order.status == 9 ){ return true; }\n          if( order.status == 105 ){ return true; }\n          if( order.status == 108 ){ return true; }\n          if( order.order_status == 4 ){ return true; }\n          if( order.cancel_status == 2 ){ return true; }\n          return false;\n      },\n      entrustTypeCH: function(v){\n        switch(v.toString()){\n          case '1': return '买入';\n          case '2': return '卖出';\n          case '101': return '融券';\n        }\n      },\n      entrustTypeClass: function(v){\n        switch(v.toString()){\n          case '1': return 'red';\n          case '2': return 'blue';\n          case '101': return '';\n        }\n      },\n      statusCH: function(v){\n        switch(v.toString()){\n          case '1': return '等待执行';\n          case '2': return '已委托';\n          case '3': return '已退回';\n          case '4': return '部分成交';\n          case '5': return '全部成交';\n          case '6': return '等待撤单';\n          case '7': return '已撤单';\n          case '8': return '废单';\n          case '9': return '已删除';\n\n          //多策略订单合并状态\n          case '101': return '未完成';\n          case '105': return '已完成';\n          case '108': return '已完成（有废单）';\n\n          //刚刚添加的订单\n          case '0': return '提交中..';\n\n          default: return '- -';\n        }\n      },\n      statusClass: function(v){\n        if (this.isFinish(v) == false && v.status != 0) {\n          return 'red';\n        }else{\n          return '';\n        }\n      },\n      entrustModelType: function(v){\n        switch(v.toString()){\n          case '1': return '限价';\n          case '2': return '市价';\n          case '3': return '市价(对手方最优价格)';\n          case '4': return '市价(本方最优价格)';\n          case '5': return '市价(即时成交剩余撤单)';\n          case '6': return '市价(最优五档即时成交剩余撤单)';\n          case '7': return '市价(全额成交或撤单)';\n          case '8': return '市价(最优五档即时成交剩余转限)';\n        }\n      },\n      unixTime: function(unixTimeStamp){\n        if (undefined == unixTimeStamp) {\n          return '--';\n        }\n\n        var momentor = /\\-/.test(unixTimeStamp) ? moment : moment.unix;// if hyphen is tested, it's sqlTimeStr and use moment, else use moment.unix\n        return  moment().format('YYYY-MM-DD') === momentor(unixTimeStamp).format('YYYY-MM-DD')\n            ? momentor(unixTimeStamp).format('HH:mm:ss')\n            : momentor(unixTimeStamp).format('M月D日 HH:mm:ss');\n      },\n      numeralNumber: function(arg, num){\n        if ('--' == arg || '' === arg || undefined == arg) {\n          return '--'\n        }\n        if (undefined != num) {\n          var str = '0.'\n          for (let i = num - 1; i >= 0; i--) {\n            str += '0';\n          }\n          if(0 == num){\n            str = '0';\n          }\n          return numeral(arg).format( '0,' + str );\n        }\n        return numeral(arg).format( '0,0.00' );\n      },\n      numeralPercent: function(arg){\n        return numeral(arg).format( '0.00%' );\n      },\n      displayValue: function(sub_value, rule){\n        var value = sub_value[rule.id];\n        if ((rule.format != '') && (rule.format instanceof Array) && (this[rule.format[0]] instanceof Function)) {\n          // value = this[rule.format].call(this, value, )\n          var args = [value].concat(rule.format.slice(1))\n          value = this[rule.format[0]].apply(this, args);\n\n        }\n        if (rule.unit) {\n          return value + rule.unit;\n        }else{\n          return value;\n        }\n      },\n      displayClass: function(sub_value, rule){\n        // 注意这里是把sub_value整个传给了函数处理\n        var value = sub_value;\n        var rtn = '';\n        if ((rule.classFormat != '') && (rule.classFormat instanceof Array) && (this[rule.classFormat[0]] instanceof Function)) {\n          // value = this[rule.classFormat].call(this, value, )\n          var args = [value].concat(rule.classFormat.slice(1))\n          rtn = this[rule.classFormat[0]].apply(this, args);\n        }\n        return rtn;\n      },\n      // 读取三个接口的数据\n      loadOrderList: function(){\n        // // 机构版才获取数据\n        // if (3 == this.orginfo_theme) {\n        //   return\n        // }\n\n        let _this = this;\n        // this.last_loading_timestamp = new Date().valueOf();\n\n        this.query_arr.forEach(function(e){\n          var last_loading_timestamp = new Date().valueOf();\n          _this[e.gridDataStr].last_loading_timestamp = last_loading_timestamp;\n\n          _this[e.gridDataStr].loadingStatus = 'loading';\n          _this.loadingNum += 1;\n          var url = e.uri;\n          // if ('marketA' == market) {\n          //   url += '&market=1';\n          // }else if('marketB' == market){\n          //   url += '&market=2';\n          // }\n\n          var marketType = 1;\n          if ('marketA' == market) {\n            marketType = 1;\n          }else if('marketHSH' == market){\n            marketType = 2;\n          }else if('marketHSZ' == market){\n            marketType = 3;\n          }\n\n          $.getJSON(url, {product_id: product_ids, market: marketType}).done(function(res){\n            if( _this[e.gridDataStr].last_loading_timestamp != last_loading_timestamp ){return;}\n\n            if (0 == res.code) {\n              var orders = res.data.list || [];\n              // 额外，更新当天所有委托信息\n              if (e.gridDataStr == 'entrustGrid') {\n                window.entrust_info = orders;\n              }\n              mergeOrderStocksInfo(orders).then(function(){\n                mergeProductsBriefInfo(orders).then(function(){\n                  _this[e.gridDataStr]['list'] = orders;\n                  // _this[e.gridDataStr+ '_listNum'] = orders.length;\n                  _this[e.gridDataStr]['last_updated_timestamp'] = res.timestamp;\n\n                  // 判断已有this[str].list是否有web_checked //之前这段代码在ajax调用之前，但是会有一个问题，两段代码之间的时刻，如果用户修改了web_checked，会导致记录下来的与实际不对。\n                  if (_this.activeGridList) {\n                    _this.activeGridList.forEach(function(e){\n                      if (e.web_checked) {\n                        _this.selectList.set(e.entrust_id, true);\n                      }else{\n                        _this.selectList.set(e.entrust_id, false);\n                      }\n                    });\n                  }\n\n                  _this.getGridList(e.gridDataStr);\n\n                  if ('revertGrid' == e.gridDataStr) {\n                    $(window).trigger({\n                      type:'revertGrid_listNum',\n                      num: orders.length\n                    });\n                  }\n                })\n              })\n            }else{\n              if (e.gridDataStr == 'entrustGrid') {\n                window.entrust_info = [];\n              }\n            }\n          }).always(function(){\n            _this.loadingNum -= 1;\n            _this[e.gridDataStr].loadingStatus = '';\n          });\n        });\n      }\n    }\n  })\n\n  // 菜单底部显示行情组件\n  Vue.component('vue-trade-foot', {\n    mixins: [numberMixin],\n    props: ['whole_width'],\n    template: `\n    <div class=\"foot\" :style=\"'width:' + whole_width + 'px;'\">\n      <span class=\"indexs\">\n        <span class=\"index\">\n          上证指数\n          <span v-bind:class=\"rgColor(code_000001, 'change')\">\n            <span>{{numeralNumber(code_000001.last_price, 2)}}</span>\n            <span>{{numeralNumber(code_000001.change, 2)}}</span>\n            <span>{{numeralPercent(code_000001.change_ratio)}}</span>\n          </span>\n        </span>\n        <span class=\"index\">\n          深证指数\n          <span v-bind:class=\"rgColor(code_399001, 'change')\">\n            <span>{{numeralNumber(code_399001.last_price, 2)}}</span>\n            <span>{{numeralNumber(code_399001.change, 2)}}</span>\n            <span>{{numeralPercent(code_399001.change_ratio)}}</span>\n          </span>\n        </span>\n        <span class=\"index\">\n          创业板指\n          <span v-bind:class=\"rgColor(code_399006, 'change')\">\n            <span>{{numeralNumber(code_399006.last_price, 2)}}</span>\n            <span>{{numeralNumber(code_399006.change, 2)}}</span>\n            <span>{{numeralPercent(code_399006.change_ratio)}}</span>\n          </span>\n        </span>\n      </span>\n      <span class=\"time\">{{time}}</span>\n    </div>\n    `,\n    data: function(){\n      return {\n        time: '',\n        code_000001: {},\n        code_399001: {},\n        code_399006: {}\n      }\n    },\n    methods: {\n      // row是行数据，name是比较的那个属性名，middle是比较的标尺数据，默认为0\n      rgColor: function(row, name, middle){\n        var num = row[name];\n        return num<(middle||0) ? 'green' : 'red';\n      },\n      loadData: function(){\n        let _this = this;\n        var indexs = [\n          '000001.SH', // 上证指数\n          '399001.SZ', // 深证指数\n          '399006.SZ'  // 创业板指\n        ];\n        var url = (window.REQUEST_PREFIX||'')+\"/oms/helper/stock_brief?stock_id=\"+indexs.join(',');\n        var loadStockIndexs = function(){\n          commonAjax(url).then(function({code, msg, data}){\n            if (0 == code) {\n              var res_data = data || [];\n              res_data.forEach && res_data.forEach(function(index_stock){\n                  _this['code_' + index_stock.stock_code] = index_stock\n              });\n              _this.time = moment().format('YYYY/MM/DD HH:mm:ss');\n            }else{\n              $.omsAlert(msg);\n            }\n          }).catch(function(err){\n            $.omsAlert(err);\n          });\n        };\n\n        $(loadStockIndexs);\n        setInterval(function(){\n          _this.time = moment().format('YYYY/MM/DD HH:mm:ss');\n        });\n        setInterval(loadStockIndexs,6000);\n      }\n    }\n  });\n\n  // 菜单预览显示组件\n  Vue.component('vue-trade-preview', {\n    mixins: [numberMixin],\n    props: ['cur_active'],\n    template: `\n      <div v-if=\"showOrHide()\" class=\"vue-trade-preview\">\n        <div class=\"vue-trade-preview__content\">\n          <table class=\"oms-preview-table loading-loading nothing-nothing\" style=\"width: 100%;height: 100%;\">\n            <thead>\n              <tr class=\"hd\">\n                <th  class=\"oms-preview-table__content--left oms-preview-table__max-width-130\" style=\"flex:2\">\n                  <input type=\"checkbox\" v-model=\"gridHead_web_checked\" @change=\"chgAll()\"  style=\"width: inherit;height:inherit;\"/>\n                  {{3 == orginfo_theme ? '产品名称' : '交易单元'}}\n                </th>\n                <th class=\"oms-preview-table__content--left\">预期进度</th>\n                <th class=\"oms-preview-table__content--right\">挂单数量</th>\n                <th class=\"oms-preview-table__content--right\">缺口数量</th>\n                <th class=\"oms-preview-table__content--right\">本次委买</th>\n              </tr>\n            </thead>\n            <tbody class=\"loading-hide\" style=\"line-height: 30px;height: 100%;\">\n              <tr v-for=\"row in display_arr\" style=\"border-bottom: 1px solid #E2E2E2;\" v-bind:class=\"[{'error-line': row.riskRtn && row.riskRtn.code != 0}]\">\n                <td class=\"oms-preview-table__content--left oms-preview-table__max-width-130\"  style=\"flex:2\">\n                  <input type=\"checkbox\" v-model=\"row.web_checked\" @change=\"chgSingle(row)\" style=\"width: inherit;height:inherit;\"/>\n                  <span>{{row.product_name}}</span>\n                </td>\n                <td class=\"oms-preview-table__content--left\">\n                  {{numeralPercent(row.predict_progress)}}\n                </td>\n                <td class=\"oms-preview-table__content--right\">\n                  <span>{{row.pending_order_number}}</span>\n                </td>\n                <td class=\"oms-preview-table__content--right\">\n                  <span>{{row.gap_number}}</span>\n                </td>\n                <td class=\"oms-preview-table__content--right\">\n                  <span>{{row.trade_num}}</span>\n                  <prompt-language v-if=\"row.riskRtn && 0 != row.riskRtn.code\" :language_val=\"row.riskRtn && row.riskRtn.msg\"></prompt-language>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class=\"vue-trade-preview__controller\" style=\"height: 24px;line-height: 24px;font-size: 12px;\">\n          <div style=\"width: 35%;padding-left: 20px;\">汇总</div>\n          <div style=\"width: 20%;\"></div>\n          <div style=\"width: 15%;text-align: right;padding-right: 10px;\">{{totalInfo.pending_order_number}}</div>\n          <div style=\"width: 15%;text-align: right;padding-right: 10px;\">{{totalInfo.gap_number}}</div>\n          <div style=\"width: 15%;text-align: right;padding-right: 10px;\">{{totalInfo.trade_num}}</div>\n        </div>\n      </div>\n    `,\n    data: function(){\n      return {\n        trading_unit: '100',\n        orginfo_theme: orginfo_theme,\n        // 产品列表预算后通过事件传过来的数据。\n        detail_arr: [],\n        trade_number_method: '',\n        buy_or_sell: '',\n        // visibility: true,\n        display_arr: [],\n        totalInfo: {\n          pending_order_number: 0,\n          gap_number: 0,\n          trade_num: 0,\n        },\n        gridHead_web_checked: true,\n\n        // 选中的产品信息\n        checkedProductList: [],\n        select_ins: {},\n        trade_direction: 1,  // 1买入 2卖出\n        // 股票id，示例：“601288.SH”\n        stock_id: '',\n        // 五档行情\n        stock_detail: {},\n        // form_data: {},\n        // 交易模式 市价: 2; 限价: 1\n        trade_mode: '',\n        // 交易价格\n        trade_price: '',\n        // 交易数量\n        trade_num: '',\n        // // 交易方式，仅展示用\n        // trade_user_type: 1,\n\n        // 批量交易数量\n        multi_num: '',\n\n        // 按同等目标仓位的输入值\n        allDstPosition: '',\n        // 按同等调仓比例的输入值\n        allChgPosition: '',\n      }\n    },\n    watch: {\n      cur_active: function(){\n        if ('single-buy' == this.cur_active) {\n          this.trade_direction = 1;\n        }else if('single-sell' == this.cur_active){\n          this.trade_direction = 2;\n        }\n      },\n    },\n    methods: {\n      checkSubmitDisabled: function(){\n        let flag = false;\n        let _this = this;\n\n        if (this.display_arr.every(e => true != e.web_checked)) {\n          flag = true;\n        }\n        this.display_arr.forEach(e => {\n          if (e.web_checked) {\n            if (undefined == e.trade_num || '' == e.trade_num || 0 == e.trade_num) {\n              flag = true;\n            }\n            if (1 == _this.trade_mode && (undefined == _this.trade_price || '' == _this.trade_price || 0 == _this.trade_price)) {\n              flag = true;\n            }\n            if (!e.riskRtn) {\n              flag = true;\n            }else if (0 != e.riskRtn.code) {\n              flag = true;\n            }\n          }\n        });\n\n        if (this.display_arr.every(e => false == e.web_checked)) {\n          return true;\n        }\n\n        return flag;\n      },\n      chgAll: function(){\n        let value = this.gridHead_web_checked;\n        this.display_arr.forEach(function(e){\n          e.web_checked = value;\n        });\n\n        this.checkRow();\n        this.refreshDisplay();\n      },\n      chgSingle: function(){\n        if (this.display_arr.every(e => true === e.web_checked)) {\n          this.gridHead_web_checked = true;\n        }else{\n          this.gridHead_web_checked = false;\n        }\n        this.display_arr = this.display_arr.filter(function(){\n          return true;\n        });\n\n        this.checkRow();\n        this.refreshDisplay();\n      },\n      // 决定该组件是否显示\n      showOrHide: function(){\n        // 选中产品为空，则隐藏\n        if (0 == this.display_arr.length) {\n          return false;\n        }\n\n        return true;\n      },\n      multiProductsSubmit: function(){\n        let _this = this;\n        let htmlArr = [];\n        let typeStr1 = '';\n        let typeStr2 = '';\n        let ins_price = 0;\n        if (1 == this.trade_direction) {\n          typeStr1 = '<span style=\"color:#F44336;\">买入</span>';\n          ins_price = this.stock_detail.stop_top;\n        }else{\n          typeStr1 = '<span style=\"color:#2196F3\">卖出</span>';\n          ins_price = this.stock_detail.stop_down;\n        }\n        if (1 == this.trade_mode) {\n          // typeStr2 = '限价';\n          typeStr2 = this.trade_price;\n          ins_price = this.trade_price;\n        }else{\n          typeStr2 = '市价';\n        }\n\n        let totalAmount = 0;\n        let totalMoney = 0;\n        this.display_arr.forEach(function(e){\n          if (e.web_checked) {\n            htmlArr.push('<tr style=\"border-bottom: 1px solid #E2E2E2;\"><td class=\"cell-left\">'+ e.product_name + '</td>'+\n              '<td class=\"cell-left\">'+ typeStr1 +'</td>'+\n              '<td class=\"cell-right\">'+ typeStr2 +'</td>'+\n              // '<td class=\"cell-right\" style=\"max-width:190px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\" title=\"'+ priceStr +'\">'+ priceStr +'</td>'+\n              '<td class=\"cell-right\">'+ e.trade_num +'</td>'+\n              '<td class=\"cell-right\">'+ Number((e.trade_num * ins_price).toFixed(2)) +'</td></tr>');\n            totalAmount += e.trade_num;\n            totalMoney += e.trade_num * ins_price;\n          }\n        });\n        totalMoney = Number(totalMoney.toFixed(2));\n\n        var html = htmlArr.join('');\n        var confirmHtml = '<table class=\"custom_confirm\"><tbody style=\"width:100%;display: inline-table;\"><tr><th class=\"cell-left\">'+ (3 == orginfo_theme ? '产品单元' : '交易单元') +'</th>'+\n          '<th class=\"cell-left\">买卖标志</th>'+\n          // '<th class=\"cell-left\">报价方式</th>'+\n          '<th class=\"cell-right\">委托价格</th>'+\n          '<th class=\"cell-right\">交易数量(股)</th>'+\n          '<th class=\"cell-right\">交易金额(元)</th></tr>'+html+'</tbody></table>'+\n          '<div class=\"custom_total\"><span style=\"color:#999999;font-size:13px;\">总计</span><span>'+totalAmount+'</span><span>'+totalMoney+'</span></div>';\n        if (0 == window.is_trade_day) {//0是休市时间，也就是非交易日或者是交易日的15点之后 1为非休市时间\n            confirmHtml += '<div style=\"color:#F44336;font-size: 14px;padding-bottom: 3px;\">*当前为休市时间，指令将提交至下一交易日</div>'\n        }\n        if (location.search.includes(\"permission=special\")) {\n            confirmHtml += '<label><input class=\"is_auto_order\" style=\"margin-right: 10px;\" type=\"checkbox\" />自动审核</label>'\n        }\n\n        $.confirm({\n          title: '指令确认 <span style=\"margin-left:10px;font-size: 14px;font-weight: normal;\">股票：'+ this.stock_id + ' ' + this.stock_detail.stock_name +'</span>',\n          content: confirmHtml,\n          keyboardEnabled: true,\n          closeIcon: true,\n          confirmButton: '确定',\n          cancelButton: false,\n          confirm: function(){\n            if($.isLoading()){return;}\n            $.startLoading('正在提交订单...');\n\n            var results = [];\n            _this.display_arr.forEach(function(e){\n              if (e.web_checked) {\n                results.push(e);\n                e.add_hand_order_res = undefined;\n                setTimeout(function(){\n                  $.post((window.REQUEST_PREFIX||'')+'/oms/workflow/'+e.product_id+'/add_hand_order',{\n                    ins_id: _this.select_ins.id,\n                    trade_mode: _this.trade_mode,\n                    trade_direction: _this.trade_direction,\n                    trade_market: 1,\n                    price: ins_price,\n                    trade_number_method: 'volume',\n                    volume: e.trade_num,\n                    stock_code: _this.stock_id,\n                    // batch_no:\n                    is_manual_order: 0,\n                    market:1\n                  }).done(function(res){\n                      e.add_hand_order_res = res;\n                      // 原流程是从后端返回的数据中获取委托数量，现在改为从请求中读取\n                      e.add_hand_order_res.data.entrust_amount = e.trade_num;\n                  }).fail(function(){\n                      e.add_hand_order_res = {code:110,msg:'网络错误！'};\n                  }).always(function(){\n\n                    checkResults(results);\n                  });\n                },Math.random()*200);\n              }\n            });\n\n\n          }\n        });\n        function checkResults(results){\n\n          var waiting_num = results.filter(function(product){\n              return !product.add_hand_order_res;\n          }).length;\n          if(waiting_num){return;}\n\n\n          for (let i = 0; i < results.length; i++) {\n            results[i].trade_num_copy = results[i].trade_num;\n            let row = results[i];\n            row.stock_id = _this.stock_detail.stock_id;\n            //row.add_hand_order_res;\n            //服务端返回数据对应理解\n            let res = row.add_hand_order_res;\n            //模拟数据\n            // res ={\"code\":0,\n            //         \"msg\":\"\",\n            //         \"data\":{\n            //          \"000001.SZ\":{\n            //             \"code\": 5022111,\n            //             \"msg\": \"hello,workd\",\n            //             \"data\": {\n            //                 \"msg\": [\n            //                     \"已触发风控:0329股票池禁止买入\",\n            //                     \"已触发风控(公司):0329股票池禁止买入\"\n            //                 ],\n            //                 \"limit_action\": 1\n            //             }\n            //         }}\n            //     }\n            //是否显示继续购买按钮\n            if (res.code == 0) {\n                //购买成功\n                row.btnType = false;\n                row.msg = [\"委托成功\"];\n                row.entrustStatus = \"pass\";\n                row.style = {}\n            } else if(res.code == 5022111){//风控专用错误码 不可更改 不能挪为它用\n                if (res.data[_this.stock_detail.stock_id]) {\n                  let temp = res.data[_this.stock_detail.stock_id];\n                  if (temp.code == 5022111) {\n                    //提示性风控\n                    if(temp.msg==\"\"){\n                        if(temp.data.limit_action == 0){\n                            //alert\n                            row.btnType =  true;\n                            row.msg = temp.data.msg;\n                            row.entrustStatus = \"alert\";\n                            row.style = {\n                            color:\"#FAA11F\"\n                            }\n                        }else{\n                            //购买失败\n                            row.btnType = false;\n                            row.entrustStatus = \"fail\";\n                            row.style = {\n                                color:\"red\"\n                            }\n                            if(temp.msg ==\"\"){\n                                row.msg = temp.data.msg;\n                            }else{\n                                row.msg = [temp.msg];\n                            }\n                            row.msg.unshift(\"委托失败\");\n                        }\n\n                    }else{\n                        //购买失败\n                        row.btnType = false;\n                        row.entrustStatus = \"fail\";\n                        row.style = {\n                            color:\"red\"\n                        }\n                        if(temp.msg ==\"\"){\n                            row.msg = []\n                        }else{\n                            row.msg = [temp.msg];\n                        }\n                        row.msg.unshift(\"委托失败\");\n                    }\n\n                  } else if(temp.code == 5022110){\n                    //禁止性风控\n                    row.btnType = false;\n                    row.msg = [temp.msg];\n                    row.msg.unshift(\"委托失败\");\n                    row.entrustStatus = \"fail\";\n                    row.style = {\n                      color: \"＃F44336\"\n                    }\n                  }else {\n                    //禁止性风控\n                    row.btnType = false;\n                    row.msg = temp.data.msg;\n                    row.msg.unshift(\"委托失败\");\n                    row.entrustStatus = \"fail\";\n                    row.style = {\n                      color: \"＃F44336\"\n                    }\n                  }\n                } else {\n                  row.btnType = false;\n                  row.entrustStatus = \"pass\";\n                  row.msg = [\"委托成功\"];\n                  row.style = {\n\n                  }\n                }\n\n            } else{\n              //购买失败\n              row.btnType = false;\n              row.entrustStatus = \"fail\";\n              row.style = {\n                color: \"red\"\n              }\n              if (res.msg == \"\") {\n                row.msg = [];\n              } else {\n                row.msg = [res.msg];\n              }\n              row.msg.unshift(\"委托失败\");\n            }\n          }\n          let contentChild = Vue.extend({\n            data() {\n              let ins_price;\n              if (1 == _this.trade_direction) {\n                ins_price = _this.stock_detail.stop_top;\n              }else{\n                ins_price = _this.stock_detail.stop_down;\n              }\n              if (1 == _this.trade_mode) {\n                ins_price = _this.trade_price;\n              }\n              let temp = Object.assign({},results);\n              //清空数量\n              this.$nextTick(function(){\n                tradeControllor.$refs['trade-form'].trade_num = '';\n                tradeControllor.$refs['trade-form'].chgTradeNum();\n                //刷新对应的列表数据\n                instructionExecutePage.$refs['instruction-execute'].loadManageList();\n                instructionExecutePage.$refs['order-list'].loadOrderList();\n                tradeControllor.$refs['trade-revert'].loadOrderList();\n                tradeFlow.chgSelectIns();\n\n                setTimeout(function(){\n                  instructionExecutePage.$refs['order-list'].loadOrderList();\n                  tradeControllor.$refs['trade-revert'].loadOrderList();\n                }, 2000)\n              })\n\n              return {\n                orginfo_theme: orginfo_theme,\n                tableData: temp,\n                form_data: _this.stock_detail,\n                ins_price:ins_price,\n                isLoading:false,\n              }\n            },\n            template: `\n            <div style=\"position:relative\">\n            <span style=\"position: absolute;top: -36px;left: 91px;font-size:12px;\">股票：{{form_data.stock_code}}&nbsp;&nbsp;{{form_data.stock_name}}&nbsp;&nbsp;价格：{{ins_price}}</span>\n            <div class=\"vue-form-confirmation\">\n                <table style=\"width:500px;\">\n                    <thead>\n                        <tr style=\"border-bottom: 1px solid rgba(0,0,0,0.05);\">\n                            <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">{{3 == orginfo_theme ? '产品账户' : '交易单元'}}</th>\n                            <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">数量</th>\n                            <th class=\"vue-form-confirmation__text-align-left\" style=\"color:rgba(74,74,74,0.5);\">备注</th>\n\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr  v-for=\"row in tableData\" style=\"border-bottom: 1px solid rgba(0,0,0,0.05);\">\n                            <td class=\"vue-form-confirmation__text-align-left\">{{row.product_name}}</td>\n                            <td class=\"vue-form-confirmation__text-align-left\">{{row.trade_num_copy}}</td>\n                            <td class=\"vue-form-confirmation__text-align-left vue-form-confirmation__span-center\" >\n                                <div>\n                                    <span :style=row.style>\n                                        <template v-for=\"msg in row.msg\">\n                                            {{msg}}</br>\n                                        </template>\n                                    </span>\n                                    <button type=\"\" v-if=\"row.btnType\" @click=btn_submit(row)>继续委托</button>\n                                </div>\n\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n              </div>\n              </div>\n            `,\n            methods: {\n              btn_submit(row) {\n                //忽略提示性风控 继续购买\n                if(this.isLoading){\n                  return\n                }\n                this.isLoading = true;\n                var self = this;\n                var ins_volume_arr = [];\n                var policy_amount_arr = [];\n                var batch_no = $.randomNo(LOGIN_INFO.user_id, 30);\n                var is_manual_order = 1; //忽略提示性风控\n\n                $.post((window.REQUEST_PREFIX || '') + '/oms/workflow/' + row.product_id + '/add_hand_order', {\n                  ignore_tips:1,\n                  ins_id: _this.select_ins.id,\n                  trade_mode: _this.trade_mode,\n                  trade_direction: _this.trade_direction,\n                  trade_market: 1,\n                  price: self.ins_price,\n                  trade_number_method: 'volume',\n                  volume: row.trade_num_copy,\n                  stock_code: row.stock_id,\n                  is_manual_order: 0,\n                  market:1\n                }).done(function(res) {\n                  console.log(res);\n                  if (res.code == 0) {\n                    row.btnType = false;\n                    row.entrustStatus = \"pass\";\n                    row.msg.unshift('委托成功');\n                    row.msg.length = 1;\n                    row.style = {\n\n                    }\n                  } else {\n                    row.btnType = false;\n                    row.msg = [];\n                    row.msg.unshift(res.msg);\n                    row.msg.unshift('委托失败');\n                    row.entrustStatus = \"fail\";\n                    row.style = {\n                      color: \"red\"\n                    }\n                  }\n                  self.tableData = Object.assign({}, self.tableData);\n                  self.isLoading = false;\n\n                  instructionExecutePage.$refs['instruction-execute'].loadManageList();\n                  instructionExecutePage.$refs['order-list'].loadOrderList();\n                  tradeControllor.$refs['trade-revert'].loadOrderList();\n                  tradeFlow.chgSelectIns();\n\n                  setTimeout(function(){\n                    instructionExecutePage.$refs['order-list'].loadOrderList();\n                    tradeControllor.$refs['trade-revert'].loadOrderList();\n                  }, 2000);\n                }).fail(function() {\n                  row.btnType = false;\n                  row.entrustStatus = \"fail\";\n                  row.msg = [\"委托失败\"];\n                  row.style = {\n\n                  }\n                  self.tableData = Object.assign({}, self.tableData);\n                  self.isLoading = false;\n                })\n\n              },\n            },\n            mounted() {\n              $.clearLoading();\n            }\n          });\n\n          Vue.prototype.$confirm({\n            title: '委托结果',\n            content: contentChild,\n            closeIcon: true,\n          });\n\n        }\n      },\n      // 强制刷新页面\n      refreshDisplay: function(){\n        let _this = this;\n        if ('' == this.trade_num || ('' == this.trade_price && 2 != this.trade_mode)) {\n          // 新增了一个流程，在风控处理之后，将是否需要禁用的标志传给trade-form组件，\n          this.$nextTick(() => {\n            let flag = this.checkSubmitDisabled();\n            tradeControllor.$refs['trade-form'].setCheckSubmitDisabled(flag);\n          })\n          return;\n        }\n        // 过风控\n        this.display_arr.forEach(function(e){\n          let total_amount = 0;\n          let market_value = 0;\n          let all_market_value = 0;\n\n          var stock_position_num = 0; //该产品已持仓该股票数量\n          var stock_entrust_num = 0; //该产品已委托该股票数量\n          var stock_total_share = _this.stock_detail.total_share_capital; //该股票总股票数量，即总股本\n          var stock_all_position_num = 0; //所有的持仓汇总该股票数量\n          var stock_all_entrust_num = 0; //所有的委托汇总该股票数量\n          var stock_entrust_buy_num = 0; //该产品已委托买入数量\n          var stock_entrust_sell_num = 0; //该产品已委托卖出数量\n          var stock_all_entrust_buy_num = 0; //所有的产品已委托买入数量\n          var stock_all_entrust_sell_num = 0; //所有的产品已委托卖出数量\n\n          window.risk_position[e.product_id].data.forEach(function(el){\n            if (el.stock_id == _this.stock_id) {\n              total_amount = el.total_amount;\n              market_value = el.market_value;\n            }\n            all_market_value += el.market_value - 0;//强制转数字\n          });\n\n          var enable_sell_volume = 0;\n          // window.position_realtime[e.product_id].data.forEach(function(el){\n          //   if (el.stock_id === _this.stock_id && el.product_id == e.product_id) {\n          //     enable_sell_volume = e.enable_sell_volume;\n          //   }\n          // });\n          window.position_realtime.forEach(function(el){\n            if ( el.stock_id === _this.stock_id && el.product_id == e.product_id) {\n              enable_sell_volume = e.enable_sell_volume;\n\n              stock_position_num += Number(e.total_amount); // 得到该产品已持仓该股票数量\n\n              // 联合风控需要遍历所有的组合\n              if (e.stock_id === _this.stock_id) {\n                  stock_all_position_num += Number(e.total_amount);\n              }\n            }\n          });\n\n          window.entrust_info.forEach(function(el){\n            if (el.stock.code == _this.stock_id && el.product_id == e.product_id &&\n                (![4, 5, 7, 8, 9].some(function(ele){\n                    return el.status == ele;\n                }) || (el.status == 4 && !/1|2/.test( el.cancel_status )))\n            ) {\n                if (1 == el.entrust.type) {\n                    stock_entrust_num += el.entrust.amount - el.deal.amount; // 得到该产品已委托该股票数量\n                    stock_entrust_buy_num = el.entrust.amount - el.deal.amount; // 得到该产品已委托买入数量\n                }else if (2 == el.entrust.type){\n                    stock_entrust_sell_num = el.entrust.amount - el.deal.amount; // 得到该产品已委托卖出数量\n                }\n            }\n\n            // 联合风控需要遍历所有的组合\n            if (el.stock.code == _this.stock_id &&\n                (![4, 5, 7, 8, 9].some(function(ele){\n                    return el.status == ele;\n                }) || (el.status == 4 && !/1|2/.test( el.cancel_status )))\n            ) {\n                if (1 == el.entrust.type) {\n                    stock_all_entrust_num += el.entrust.amount - el.deal.amount; // 得到所有产品已委托该股票数量\n\n                    stock_all_entrust_buy_num += el.entrust.amount - el.deal.amount; // 所有的产品已委托买入数量\n                }else if(2 == el.entrust.type){\n                    stock_all_entrust_sell_num += el.entrust.amount - el.deal.amount; // 所有的产品已委托卖出数量\n                }\n            }\n          })\n\n          var obj = riskCheck.checkRules({\n            trading_unit: _this.stock_detail.trading_unit,\n            product_id: e.product_id,                           // 产品id， id\n            // 交易数据 form_data\n            trade_direction: _this.trade_direction,             // 交易方向，1买入 2卖出 trade_direction\n            trade_mode: _this.trade_mode,                       // 1限价／2市价  trade_mode\n            volume: e.trade_num,                               // 交易数量\n            price: +_this.trade_price||0,                       // 限价金额\n            surged_limit: _this.stock_detail.stop_top,          // 涨停价\n            decline_limit: _this.stock_detail.stop_down,        // 跌停价\n            stock_code: _this.stock_id,                         // 股票code，包含“.SZ”,比较的时候最好都进行小写转换\n            stock_name: _this.stock_detail.stock_name,          // 股票名称，用于判断st股票\n            // 产品的数据 product\n            total_assets: e.runtime.total_assets,               // 资产总值 runtime.total_assets\n            enable_cash: e.runtime.enable_cash,                 // 可用资金 runtime.enable_cash\n            security: all_market_value,                         // 持仓市值 runtime.security 改为 all_market_value\n            net_value: e.runtime.net_value,                     // 当日净值 runtime.net_value\n            // 持仓数据\n            market_value: market_value,                         // 本股票持仓市值 //window.position_realtime里面有\n            total_amount: total_amount,                         // 该股票当前持仓数\n            enable_sell_volume: enable_sell_volume,              // 该股票能卖的数量\n\n            // 举牌\n            stock_position_num: stock_position_num, //该产品已持仓该股票数量\n            stock_entrust_num: stock_entrust_num, //该产品已委托该股票数量\n            stock_total_share: stock_total_share, //该股票总股票数量，即总股本\n\n            // 联合风控：举牌\n            stock_all_position_num: stock_all_position_num, //所有的持仓汇总该股票数量\n            stock_all_entrust_num: stock_all_entrust_num, //所有的委托汇总该股票数量\n\n            // 对敲\n            stock_entrust_buy_num: stock_entrust_buy_num, //该产品已委托买入数量\n            stock_entrust_sell_num: stock_entrust_sell_num, //该产品已委托卖出数量\n\n            // 联合风控：对敲\n            stock_all_entrust_buy_num: stock_all_entrust_buy_num, //所有的产品已委托买入数量\n            stock_all_entrust_sell_num: stock_all_entrust_sell_num, //所有的产品已委托卖出数量\n          });\n          e.riskRtn = obj;\n        });\n\n        // 强制刷新\n        this.display_arr = this.display_arr.filter(function(e){\n          return true;\n        });\n\n        // 新增了一个流程，在风控处理之后，将是否需要禁用的标志传给trade-form组件，\n        this.$nextTick(() => {\n          let flag = this.checkSubmitDisabled();\n          tradeControllor.$refs['trade-form'].setCheckSubmitDisabled(flag);\n        })\n      },\n      display_title: function(){\n        if ('single-sell' == this.cur_active) {\n          return '卖出';\n        }else if('single-buy' == this.cur_active){\n          return '买入';\n        }\n      },\n      setSubmitData: function(obj){\n        var _this = this;\n        // this.checkedProductList = obj.checkedProductList;\n        // 判断是否是同一个指令，如果不是，则清空数据，如果是，则只是修改（因为web_select不能动）\n        if (this.select_ins.id == obj.select_ins.id) {\n          // this.select_ins = obj.select_ins;\n          this.stock_id = obj.stock_id;\n          this.stock_detail = obj.stock_detail;\n          this.trade_mode = obj.trade_mode;\n          this.trade_price = obj.trade_price;\n          this.trade_num = obj.trade_num;\n          this.add_ins_method = obj.add_ins_method;\n\n          // obj.select_ins && obj.select_ins.sub_list && obj.select_ins.sub_list.forEach(function(e){\n          //   e.web_checked = true;\n          // });\n          //当清空指令的时候this.select_ins是空的所以return掉\n          if(this.select_ins.sub_list == undefined){\n            return;\n          }\n\n          let tmpSelectArr = [];\n          this.select_ins.sub_list.forEach(e => {\n            if (e.web_checked) {\n              tmpSelectArr.push(e.product_id);\n            }\n          });\n          this.select_ins = obj.select_ins;\n          this.select_ins && this.select_ins.sub_list && this.select_ins.sub_list.forEach(e => {\n            if (tmpSelectArr.some(el => el == e.product_id)) {\n              e.web_checked = true;\n            }\n          })\n\n          this.display_arr = obj.select_ins.sub_list || [];\n\n          this.checkRow();\n\n          this.refreshDisplay();\n        }else{\n          this.select_ins = obj.select_ins;\n          this.stock_id = obj.stock_id;\n          this.stock_detail = obj.stock_detail;\n          this.trade_mode = obj.trade_mode;\n          this.trade_price = obj.trade_price;\n          this.trade_num = obj.trade_num;\n          this.add_ins_method = obj.add_ins_method;\n\n          obj.select_ins && obj.select_ins.sub_list && obj.select_ins.sub_list.forEach(function(e){\n            e.web_checked = true;\n          });\n\n          this.display_arr = obj.select_ins.sub_list || [];\n\n          this.checkRow();\n\n          this.refreshDisplay();\n        }\n      },\n      checkRow: function(){\n        let _this = this;\n\n        let totalGapNumber = 0;\n        this.display_arr.forEach(function(e){\n          //合并数据\n          e.runtime = e.runtime || {};\n          $.extend(e.runtime, $.pullValue(window.runtime, e.product_id + '.data'));\n\n          // 3.11版本修改，机构版将net_assets赋值到total_assets,为了解决含义变化的问题\n          if (3 != orginfo_theme) {\n              e.runtime.total_assets = e.runtime.net_assets;\n          }\n\n          // if (e.runtime.estimate) {\n          //   e.runtime.net_value = e.runtime.estimate.net_value;\n          //   e.runtime.position = e.runtime.estimate.position;\n          //   e.runtime.total_assets = e.runtime.estimate.total_assets;\n          // }\n          // e.runtime = window.runtime[e.product_id].data;\n          // product_list.forEach(function(product){\n          //   product.runtime = product.runtime || {};\n          //   //采用合并老数据的方式，防止没有数据导致整行空白的问题\n          //   $.extend(product.runtime, $.pullValue(res,'data.'+product.id+'.data'));\n          // });\n\n          // 计算缺口数量\n          // e.gap_number = Math.abs(e.ins_volume - e.current_volume - e.pending_order_number);\n          e.gap_number = e.diff_number; //直接由后端接口提供\n          // 计算总的缺口额的时候，也只要计算选中的产品的汇总\n          if (e.web_checked) {\n            totalGapNumber += e.gap_number;\n          }\n        });\n\n        _this.totalInfo.pending_order_number = 0;\n        _this.totalInfo.gap_number = 0;\n        _this.totalInfo.trade_num = 0;\n\n        this.display_arr.forEach((e) => {\n          if (e.web_checked) {\n            if (0 == totalGapNumber) {\n              e.trade_num = 0;\n            }else{\n              e.trade_num = Math.min(Math.floor(e.gap_number / totalGapNumber * _this.trade_num / 100) * 100, e.gap_number);\n            }\n\n            // 计算总的缺口额的时候，也只要计算选中的产品的汇总\n            _this.totalInfo.pending_order_number += e.pending_order_number;\n            _this.totalInfo.gap_number += e.gap_number;\n            _this.totalInfo.trade_num += e.trade_num;\n          }else{\n            e.trade_num = 0;\n          }\n\n          // 计算预期进度 （委买 + 指令数量 - 缺口数量） ／ 指令数量\n          if (0 == e.ins_volume) {\n            e.predict_progress = 0;\n          }else{\n            e.predict_progress = (Number(e.trade_num) + Number(e.ins_volume) - Number(e.diff_number)) / e.ins_volume;\n          }\n        });\n        this.$root.$refs['trade-form'].setTotalInfo({\n          showOrHide: this.showOrHide(),\n          trade_num: this.totalInfo.trade_num\n        });\n\n        if (this.display_arr.every(e => true === e.web_checked)) {\n          this.gridHead_web_checked = true;\n        }else{\n          this.gridHead_web_checked = false;\n        }\n      },\n      setDealPrice(val){\n        //  设置交易价格\n        this.stock_detail.deal_price = val;\n\n      },\n    }\n  });\n\n  /**\n   * 交易流程使用的vue，其不参与页面显示，但他是整个交易流程。//附，使用中发现一个问题，root组件内部不能使用tradeFlow，只有Vue.component定义的组件能够使用\n   * 他的数据来自于各个组件的关键数据，他的数据决定了目前处于交易的哪一个步骤，\n   *\n   */\n  var tradeFlow = new Vue({\n    data: {\n      curActive: '', // single-buy; single-sell\n      // // 选中的产品信息\n      // checkedProductList: [],\n      // 选中的指令信息\n      select_ins: [],\n      // 股票id，示例：“601288.SH”\n      stock_id: '',\n      stock_name: '',\n      stock_detail: {},\n      // form_data: {},\n      trade_mode: 1,\n      trade_price: '',\n      trade_num: '',\n      add_ins_method: 3,\n    },\n    watch: {\n    },\n    methods: {\n      // Begin: 外部调用，获取提交时需要的数据\n      chgCurActive: function(val){\n        this.curActive = val;\n      },\n      // chgCheckedProduct: function(arr){\n      //   this.checkedProductList = arr;\n      //   this.setSubmitData();\n      // },\n\n      // 修改选中的指令\n      chgSelectIns: function(val){\n        // 提交后，清空数据\n        if (undefined == val) {\n          this.select_ins = [];\n          this.stock_id = '';\n          this.stock_name = '';\n          this.trade_mode = 1;\n          this.trade_price = '';\n          this.trade_num = '';\n          \n          this.$nextTick(() => {\n            this.setSubmitData();\n            this.setFormData();\n          })\n          return;\n        }\n\n        if (1 == val.deal_direction) {\n          tradeControllor.$refs['trade-menu'].chgActive('single-buy');\n        }else{\n          tradeControllor.$refs['trade-menu'].chgActive('single-sell');\n        }\n        this.select_ins = val;\n        this.stock_id = this.select_ins.stock_id;\n        this.stock_name = this.select_ins.stock_name;\n\n        // 重置其他\n        this.trade_mode = 1;\n        this.trade_price = '';\n        this.trade_num = '';\n\n        this.$nextTick(() => {\n          this.setSubmitData();\n          this.setFormData();\n          tradeControllor.$refs['trade-form'].setCheckSubmitDisabled(true);\n        })\n        //\n      },\n      // chgStockId: function(id){\n      //   this.stock_id = id;\n      //   this.setSubmitData();\n      // },\n      shgStockDetail: function(val){\n        this.stock_detail = val;\n        this.setSubmitData();\n      },\n      chgTradeMode: function(val){\n        this.trade_mode = val;\n        this.setSubmitData();\n      },\n      chgTradePrice: function(val){\n        this.trade_price = val;\n        this.setSubmitData();\n      },\n      chgInsMethod: function(val){\n        this.add_ins_method = val;\n        this.setSubmitData();\n      },\n      chgTradeNum: function(val){\n        this.trade_num = val;\n        this.setSubmitData();\n      },\n      // End: 外部调用，获取提交时需要的数据\n      // Begin: 内部处理\n      // 检查数据是否ok，ok则全部交给\n      setSubmitData: function(){\n        // 将数据提交给预览模块\n        tradeControllor.$refs['trade-preview'] && tradeControllor.$refs['trade-preview'].setSubmitData({\n          // checkedProductList: [this.select_ins],\n          select_ins: this.select_ins,\n          stock_id: this.stock_id,\n          stock_detail: this.stock_detail,\n          // form_data: this.form_data,\n          trade_mode: this.trade_mode,\n          trade_price: this.trade_price,\n          trade_num: this.trade_num,\n          add_ins_method: this.add_ins_method,\n        })\n      },\n      setFormData: function(){\n        tradeControllor.$refs['trade-form'].setFormData({\n          stock_id: this.stock_id,\n          stock_name: this.stock_name,\n          trade_mode: this.trade_mode,\n          trade_price: this.trade_price,\n          trade_num: this.trade_num,\n        })\n      },\n      // End: 内部处理\n    }\n  });\n\n  // 交易控制部分\n  tradeControllor = new Vue({\n    el: '#trade-controllor',\n    data: {\n      // 市场类型\n      curMarket: 'marketA',\n      // 页签类型\n      curActive: 'single-buy',   //'single-buy','single-sell','multi-buy','multi-sell','revert'\n      // 是否隐藏\n      showBoard: true,\n      leftWidth: 0,\n      wholeWidth: 0,\n      stock_id: '',\n    },\n    // watch: {\n    //   stock_id: {\n    //     handle: function(){\n    //       tradeFLow.chgStockId(this.stock_id);\n    //     },\n    //     deep: true\n    //   }\n    // },\n    methods: {\n      chgStockId: function(event){\n        this.stock_id = event;\n      },\n      chgMenu: function(event){\n        this.curMarket = event.curMarket;\n        this.curActive = event.curActive;\n        this.showBoard = event.showBoard;\n      },\n      setWidth: function(leftWidth, wholeWidth){\n        this.leftWidth = leftWidth;\n        this.wholeWidth = wholeWidth;\n      }\n    }\n  });\n\n  var intervalMap = new Map();\n  // 获取风控规则\n  var loadRiskRulesInfo = new Promise(function(resolve, reject){\n    riskCheck.getRulesData(product_ids, function(){\n      resolve();\n    });\n    setInterval(function(){\n      riskCheck.getRulesData(product_ids, function(){\n        ;\n      });\n    }, 6000 + parseInt(Math.random() * 1000));\n  });\n  // 获取股票池\n  var loadStockPoolInfo = new Promise(function(resolve, reject){\n    riskCheck.getStockPoolData(function(){\n      resolve();\n    });\n    setInterval(function(){\n      riskCheck.getStockPoolData(function(){\n        ;\n      });\n    }, 6000 + parseInt(Math.random() * 1000));\n  });\n  // 获取费用规则\n  var loadFeeRulesInfo = new Promise(function(resolve, reject){\n    riskCheck.getFeeData(product_ids, function(){\n      resolve();\n    });\n    setInterval(function(){\n      riskCheck.getFeeData(product_ids, function(){\n        ;\n      });\n    }, 6000 + parseInt(Math.random() * 1000));\n  });\n  // 风控持仓\n  var loadRiskPositionFn = function(resolve){\n    if (true == intervalMap.get('loadRiskPositionFn')) {\n      return;\n    }\n    intervalMap.set('loadRiskPositionFn', true);\n    $.get((window.REQUEST_PREFIX||'')+'/oms/helper/risk_position',{product_id:product_ids}, function(res){\n      if (0 == res.code) {\n        window.risk_position = res.data;\n        if ('[object Function]' == Object.prototype.toString.call(resolve)) {\n          resolve();\n        }\n      }\n      intervalMap.set('loadRiskPositionFn', false);\n    });\n  }\n  var loadRIskPositionInfo = new Promise(function(resolve, reject){\n    loadRiskPositionFn(resolve)\n    // setInterval(function(){\n    //   loadRiskPositionFn()\n    // }, 5000);\n  });\n\n  // 持仓数据\n  var loadPositionRealtimeFn = function(resolve){\n    if (true == intervalMap.get('loadPositionRealtimeFn')) {\n      return;\n    }\n    intervalMap.set('loadPositionRealtimeFn', true);\n    $.get((window.REQUEST_PREFIX||'')+'/oms/api/multi_position_realtime',{product_id:product_ids}, function(res){\n      if (0 == res.code) {\n        position_last_updated_timestamp = res.timestamp;\n        var position_realtime = [];\n        product_list.forEach(function(product){\n          var id = product.id;\n          var positions = $.pullValue(res,'data.'+id+'.data',[]);\n\n          // product.position_realtime = positions;\n          positions.forEach(function(position){\n              position.product = product;\n          });\n\n          // id是组合id，positions是实时持仓数据 在此计算出“今日盈亏”和“今日盈亏率”修改到window.PRODUCTS 的对应组合的runtime中\n          // product.today_earning;\n          var profit_of_today = 0;\n          positions.forEach(function(position){\n              profit_of_today += position.today_earning;\n          });\n          window.PRODUCTS.forEach(function(e){\n            if (e.id == id) {\n              if (e.runtime && Object.keys(e.runtime).length > 0) {\n                var profit_of_today_v2 = profit_of_today - e.runtime.redeem_fee - e.runtime.manage_fee - e.runtime.other_fee;\n                e.runtime.profit_of_today_v2 = profit_of_today_v2;\n                if (0 == e.runtime.total_assets) {\n                  e.runtime.profit_rate_of_day_v2 = 0;\n                }else{\n                  e.runtime.profit_rate_of_day_v2 = profit_of_today_v2 / e.runtime.total_assets;\n                }\n              }\n            }\n          });\n\n          position_realtime.push.apply(position_realtime,positions);\n        });\n\n        window.position_realtime = position_realtime;\n\n        intervalMap.set('loadPositionRealtimeFn', false);\n\n        if ('[object Function]' == Object.prototype.toString.call(resolve)) {\n          resolve();\n        }\n      }\n    });\n  }\n  var loadPositionRealtimeInfo = new Promise(function(resolve, reject){\n    loadPositionRealtimeFn(resolve);\n    // setInterval(function(){\n    //   loadPositionRealtimeFn();\n    // }, 5000);\n  });\n\n  // 获取指令数据\n  var loadInsInfo = new Promise(function(resolve, reject){\n    resolve();\n    setInterval(function(){\n      if(!product_ids.length){return;}\n      instructionExecutePage.$refs['instruction-execute'].loadManageList();\n    }, 6000 + parseInt(Math.random() * 1000));\n  });\n\n  // 获取运行时数据\n  var loadRuntimeFn = function(resolve){\n    var url = (window.REQUEST_PREFIX||'')+'/oms/api/get_multi_settlement_info';\n\n    if (true == intervalMap.get('loadRuntimeFn')) {\n      return;\n    }\n    intervalMap.set('loadRuntimeFn', true);\n\n    $.get(url,{\n      product_id: product_ids,\n      unuse_cache: 1,\n    }).done(function(res){\n      if(res.code==0){\n        window.runtime = res.data;\n\n        // //合并数据\n        // product_list.forEach(function(product){\n        //   product.runtime = product.runtime || {};\n        //   //采用合并老数据的方式，防止没有数据导致整行空白的问题\n        //   $.extend(product.runtime, $.pullValue(res,'data.'+product.id+'.data'));\n        // });\n\n        intervalMap.set('loadRuntimeFn', false);\n\n        if ('[object Function]' == Object.prototype.toString.call(resolve)) {\n          resolve();\n        }\n      }else{\n        $.omsAlert(res.msg);\n      }\n    }).fail($.failNotice.bind(null,url,'网络异常')).always(function(){\n    });\n  };\n  var loadRuntimeInfo = new Promise(function(resolve, reject){\n    loadRuntimeFn(resolve);\n    setInterval(function(){\n      if(!product_ids.length){return;}\n      loadRuntimeFn();\n    }, 6000 + parseInt(Math.random() * 1000));\n  });\n\n  // // 获取指令数据\n  // var loadInsInfo = new Promise(function(resolve, reject){\n  //   $.ajax({\n  //     url: window.REQUEST_PREFIX + '/sync/instruction/search_list',\n  //     data: {\n  //       count: 9999,\n  //       type: 'execute',\n  //       ins_status_arr: [-1, 2, 3, 4]\n  //     },\n  //     success: function(res){\n  //       if (0 == res.code) {\n  //         window.instructionList = res.data.list || [];\n  //         resolve();\n  //       }else{\n  //         reject(res.msg);\n  //       }\n  //     },\n  //     error: function(){\n  //       reject('网络异常');\n  //     }\n  //   })\n  // });\n  Promise.all([loadRiskRulesInfo, loadStockPoolInfo, loadFeeRulesInfo, loadRIskPositionInfo, loadPositionRealtimeInfo, loadRuntimeInfo, loadInsInfo]).then(function(){\n    // console.log('此时才获取了交易所需要的基本数据。');\n    // 此时获取了交易所需要的基本数据之后，根据product_list来绘制组件\n    instructionExecutePage.loadList(product_list);\n  }).catch(function(err){\n    $.omsAlert(err);\n  });\n\n  tradeControllor.$refs['trade-foot'].loadData();\n\n  instructionExecutePage.$refs['order-list'].loadOrderList();\n\n  /** Begin: 委托／指令创建部分布局照抄以前的方式 代码来自于multi/product/main.blade.php */\n  var me = $(this);\n  $('html').css('background','#fff');\n  $(function(){\n    var section_height = 271;\n    var section = $('html').find('section.create-order').first();\n\n    if(/mobile/i.test(navigator.userAgent)){return section.find('>.head').hide();}\n\n    $('html').addClass('black-turnoff');//全局使用 黑色主题\n    $('section.create-order').first().addClass('fixed transition');\n\n    var container = me.closest('.main-container');\n    var side_nav = $('html').find('.side-nav').first();\n    var scroll_reable_transition;\n\n    strategy_scrollbar_full();\n\n    function strategy_scrollbar_full(){\n      var ghost_section = $('<div>').appendTo(container);\n      $(window).on('table:rendered order_create:nav:change side_nav_status:changed resize scroll',resize);\n\n      resize({type:null});\n      function resize(event){\n        if(event.type=='scroll'){\n          clearTimeout(scroll_reable_transition);\n          section.removeClass('transition');\n          scroll_reable_transition = setTimeout(function(){\n              event.type == 'scroll' && section.addClass('transition');\n          });\n        }\n\n        var side_nav_status = side_nav.is('.open') ? 'open' : 'close';\n        var left = side_nav_status=='close' ? 60 : (side_nav.width()||255);\n        var side_nav_width = side_nav_status=='close' ? 60 : (side_nav.width()||255);\n        // var left = 60;\n        left -= window.scrollX;\n        var tmpWidth = container.outerWidth();\n        section.css({\n          'left': left\n        });\n        ghost_section.height(section.height());\n\n        // 修改底部宽度\n        let leftWidth = Math.max($('.container-fluid').outerWidth() + window.scrollX - side_nav_width, 1080);\n        tradeControllor.setWidth(leftWidth, $('.main-container').outerWidth());\n      }\n    }\n  });\n  /** End: 委托／指令创建部分布局照抄以前的方式 */\n\n  // 订单下单成功后触发该事件。\n  $(window).on('multi_products:create_order:finish', function(e){\n    tradeControllor.$refs['trade-revert'].loadOrderList();\n    // doRevert.loadOrderList();\n    setTimeout(function(){\n      tradeControllor.$refs['trade-revert'].loadOrderList();\n      // doRevert.loadOrderList();\n    },5000);\n  });\n\n  // last_update接口触发刷新事件\n  // 单纯搜索自定义事件名称是搜不出来东西的。\n  // 因为以前的人用的是字符串拼接的方式。只有在维护了这种代码之后，才能够发现这种处理方式实在是极其难以维护\n  // 拼接字符串的代码在 standard.blade.php 文件中\n  $(window).on('entrust_update_updated',function(event){\n    var flag = false;\n    tradeControllor.$refs['trade-revert'] && tradeControllor.$refs['trade-revert'].query_arr && tradeControllor.$refs['trade-revert'].query_arr.forEach(function(e){\n      if (tradeControllor.$refs['trade-revert'][e.gridDataStr].last_updated_timestamp < event.updated_timestamp) {\n        flag = true;\n      }\n    });\n\n    if( flag ){\n      tradeControllor.$refs['trade-revert'].loadOrderList();\n      instructionExecutePage.$refs['order-list'].loadOrderList();\n      // doRevert.loadOrderList();\n\n      // // setTimeout(function(){\n      // //   doRevert.loadOrderList();\n      // // },5000);\n    }\n\n  });\n\n\n  $(window).on('position_update_updated', function(event){\n    if (position_last_updated_timestamp < event.updated_timestamp) {\n      loadPositionRealtimeFn();\n      loadRiskPositionFn();\n    }\n  });\n\n})\n"]}